<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Energy in the U.S. - Deep Learning for Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./deeplearning.html">Deep Learning for TS</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Energy in the U.S.</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aboutme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Me</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arma_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARIMAX/SARIMAX/VAR Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deeplearning.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Deep Learning for TS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab0</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#co2-emissions" id="toc-co2-emissions" class="nav-link active" data-scroll-target="#co2-emissions">CO2 Emissions</a>
  <ul class="collapse">
  <li><a href="#coal" id="toc-coal" class="nav-link" data-scroll-target="#coal">Coal</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data" id="toc-split-data-into-training-and-testing-data" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape" id="toc-reformat-data-into-required-shape" class="nav-link" data-scroll-target="#reformat-data-into-required-shape">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn" id="toc-model-1-rnn" class="nav-link" data-scroll-target="#model-1-rnn">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru" id="toc-model-2---gru" class="nav-link" data-scroll-target="#model-2---gru">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm" id="toc-model-3---lstm" class="nav-link" data-scroll-target="#model-3---lstm">Model 3 - LSTM</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul></li>
  <li><a href="#hydro" id="toc-hydro" class="nav-link" data-scroll-target="#hydro">Hydro</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-1" id="toc-split-data-into-training-and-testing-data-1" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-1">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-1" id="toc-reformat-data-into-required-shape-1" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-1">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-1" id="toc-model-1-rnn-1" class="nav-link" data-scroll-target="#model-1-rnn-1">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-1" id="toc-model-2---gru-1" class="nav-link" data-scroll-target="#model-2---gru-1">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-1" id="toc-model-3---lstm-1" class="nav-link" data-scroll-target="#model-3---lstm-1">Model 3 - LSTM</a></li>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  </ul></li>
  <li><a href="#natural-gas" id="toc-natural-gas" class="nav-link" data-scroll-target="#natural-gas">Natural Gas</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-2" id="toc-split-data-into-training-and-testing-data-2" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-2">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-2" id="toc-reformat-data-into-required-shape-2" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-2">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-2" id="toc-model-1-rnn-2" class="nav-link" data-scroll-target="#model-1-rnn-2">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-2" id="toc-model-2---gru-2" class="nav-link" data-scroll-target="#model-2---gru-2">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-2" id="toc-model-3---lstm-2" class="nav-link" data-scroll-target="#model-3---lstm-2">Model 3 - LSTM</a></li>
  <li><a href="#discussion-2" id="toc-discussion-2" class="nav-link" data-scroll-target="#discussion-2">Discussion</a></li>
  </ul></li>
  <li><a href="#petroleum" id="toc-petroleum" class="nav-link" data-scroll-target="#petroleum">Petroleum</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-3" id="toc-split-data-into-training-and-testing-data-3" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-3">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-3" id="toc-reformat-data-into-required-shape-3" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-3">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-3" id="toc-model-1-rnn-3" class="nav-link" data-scroll-target="#model-1-rnn-3">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-3" id="toc-model-2---gru-3" class="nav-link" data-scroll-target="#model-2---gru-3">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-3" id="toc-model-3---lstm-3" class="nav-link" data-scroll-target="#model-3---lstm-3">Model 3 - LSTM</a></li>
  <li><a href="#discussion-3" id="toc-discussion-3" class="nav-link" data-scroll-target="#discussion-3">Discussion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparison-of-deep-learning-to-traditional-ts-models" id="toc-comparison-of-deep-learning-to-traditional-ts-models" class="nav-link" data-scroll-target="#comparison-of-deep-learning-to-traditional-ts-models">Comparison of Deep Learning to Traditional TS Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Deep Learning for Time Series</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="energy_header.png" class="img-fluid" style="width:100.0%"></p>
<p>Using univariate time series, I here use deep learning to extract insights about energy in the United States. I use a Recurrent Neural Network (RNN), a Gated Recurrent Unit (GRU) network, and a Long-Short Term Memory Network (LSTM) to make future predictions related to CO2 Emissions. This analysis is in Python.</p>
<p><strong>NOTE:</strong> NN analysis on CO2 emissions data only due to sample size limitations. Because all the other datasets are on a yearly frequency we have a maximum of 50 datapoints per energy source - not enough to build a model with.</p>
<p><strong>Packages used:</strong> pandas, numpy, plotly, matplotlib, tensorflow, keras, sklearn</p>
<section id="co2-emissions" class="level1">
<h1>CO2 Emissions</h1>
<p>Broken down by emissions by Coal, Hydro, Natural Gas, Petroleum, and Total source.</p>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Coal observations:  (649, 1)
Hydro observations:  (649, 1)
Natural Gas observations:  (649, 1)
Petroleum observations:  (649, 1)</code></pre>
</div>
</div>
<section id="coal" class="level2">
<h2 class="anchored" data-anchor-id="coal">Coal</h2>
<section id="split-data-into-training-and-testing-data" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="47c6940c-9afa-48d1-ba45-91d71be73337" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("47c6940c-9afa-48d1-ba45-91d71be73337")) {                    Plotly.newPlot(                        "47c6940c-9afa-48d1-ba45-91d71be73337",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.20995867252349854,0.18275845050811768,0.18182122707366943,0.16993534564971924,0.17348599433898926,0.1829054355621338,0.1971607208251953,0.2028195858001709,0.18436527252197266,0.19166994094848633,0.19274020195007324,0.21107017993927002,0.8467828035354614,0.20714902877807617,0.18062496185302734,0.18459630012512207,0.1709212064743042,0.17977750301361084,0.175268292427063,0.19844567775726318,0.1990797519683838,0.17396998405456543,0.18643462657928467,0.1767488718032837,0.19263195991516113,0.8421190977096558,0.20526337623596191,0.1831376552581787,0.1902681589126587,0.17020738124847412,0.1656728982925415,0.17553210258483887,0.18994057178497314,0.19784057140350342,0.16990447044372559,0.17510318756103516,0.18150997161865234,0.20858049392700195,0.8411809206008911,0.21808147430419922,0.18619203567504883,0.19624018669128418,0.18420839309692383,0.1858065128326416,0.19501566886901855,0.21182310581207275,0.2140333652496338,0.19148898124694824,0.20189642906188965,0.21336066722869873,0.23449671268463135,0.859567403793335,0.2322371006011963,0.2011195421218872,0.20302999019622803,0.18183469772338867,0.1974489688873291,0.21048128604888916,0.23087942600250244,0.2248976230621338,0.2055577039718628,0.20350003242492676,0.20517492294311523,0.2213534116744995,0.8665963411331177,0.21761095523834229,0.17035317420959473,0.15870130062103271,0.17972612380981445,0.2007303237915039,0.21313190460205078,0.23049592971801758,0.2383817434310913,0.22436845302581787,0.21609342098236084,0.21611475944519043,0.23870837688446045,0.8662874698638916,0.2512766122817993,0.2203885316848755,0.22272861003875732,0.20755088329315186,0.2209465503692627,0.22945880889892578,0.24834871292114258,0.24998044967651367,0.22064566612243652,0.22670531272888184,0.22694969177246094,0.2509031295776367,0.888128399848938,0.259920597076416,0.24255776405334473,0.23853528499603271,0.20920276641845703,0.20975589752197266,0.22478139400482178,0.2548670768737793,0.25361084938049316,0.22971832752227783,0.2227400541305542,0.22857940196990967,0.2574986219406128,0.8929575681686401,0.2724018096923828,0.24000072479248047,0.24121379852294922,0.21650302410125732,0.21792006492614746,0.23787009716033936,0.27138710021972656,0.26562225818634033,0.2396625280380249,0.23693335056304932,0.2356128692626953,0.26123046875,0.9017386436462402,0.27709805965423584,0.24040484428405762,0.233373761177063,0.21020448207855225,0.2170013189315796,0.22156572341918945,0.2558457851409912,0.2550114393234253,0.22491133213043213,0.21747982501983643,0.22588694095611572,0.24114513397216797,0.8921005725860596,0.2524104118347168,0.21538102626800537,0.2186349630355835,0.20637786388397217,0.21362709999084473,0.2313913106918335,0.2778208255767822,0.29072701930999756,0.2537806034088135,0.24207353591918945,0.24625325202941895,0.28225743770599365,0.9020661115646362,0.28774237632751465,0.25334715843200684,0.26094233989715576,0.23611557483673096,0.24108529090881348,0.26686549186706543,0.2814364433288574,0.2925746440887451,0.25722646713256836,0.2584836483001709,0.2586100101470947,0.27327990531921387,0.9209167957305908,0.2956275939941406,0.26197004318237305,0.2580920457839966,0.24589359760284424,0.2573293447494507,0.2656515836715698,0.2925323247909546,0.2888448238372803,0.2645144462585449,0.25828075408935547,0.25738370418548584,0.29658472537994385,0.9272034168243408,0.3009589910507202,0.26359689235687256,0.2585197687149048,0.2351245880126953,0.245682954788208,0.27243220806121826,0.3026331663131714,0.27981626987457275,0.26055634021759033,0.2520056962966919,0.2535189390182495,0.27834057807922363,0.9241061210632324,0.28940582275390625,0.2528536319732666,0.25512123107910156,0.24666273593902588,0.26469099521636963,0.2880474328994751,0.31656336784362793,0.3148716688156128,0.2771952152252197,0.27057182788848877,0.26823246479034424,0.2965952157974243,0.9357558488845825,0.3101714849472046,0.28633034229278564,0.2781878709793091,0.256364107131958,0.2644360065460205,0.2969094514846802,0.32042622566223145,0.3299058675765991,0.2835655212402344,0.27998828887939453,0.27834248542785645,0.30769646167755127,0.9483156204223633,0.30749642848968506,0.29173922538757324,0.29017579555511475,0.26702094078063965,0.2745743989944458,0.2921316623687744,0.3133760690689087,0.31480681896209717,0.2880798578262329,0.28299009799957275,0.2850759029388428,0.32490992546081543,0.9513071775436401,0.3047553300857544,0.27343153953552246,0.284709095954895,0.2703282833099365,0.2754114866256714,0.2969249486923218,0.31846654415130615,0.32313108444213867,0.30253636837005615,0.29722845554351807,0.2854311466217041,0.3118114471435547,0.9523074626922607,0.32024049758911133,0.2730748653411865,0.27674055099487305,0.2566007375717163,0.2790710926055908,0.295282244682312,0.3185514211654663,0.3175487518310547,0.29332852363586426,0.28672730922698975,0.29511451721191406,0.3055121898651123,0.9502558708190918,0.3094445466995239,0.27976250648498535,0.29017579555511475,0.2721160650253296,0.27797365188598633,0.29060447216033936,0.3248302936553955,0.31422579288482666,0.29781007766723633,0.28915584087371826,0.28858888149261475,0.3135538101196289,0.9525768756866455,0.3116292953491211,0.291080117225647,0.3031657934188843,0.2746121883392334,0.27538323402404785,0.3046222925186157,0.3374905586242676,0.3359564542770386,0.2974501848220825,0.2966386079788208,0.2985835075378418,0.32115209102630615,0.9611079692840576,0.3348062038421631,0.2976301908493042,0.30091798305511475,0.27601873874664307,0.28741347789764404,0.32084810733795166,0.3320622444152832,0.3294506072998047,0.2990227937698364,0.2938871383666992,0.285097599029541,0.3087502717971802,0.9625844955444336,0.3177589178085327,0.2915002107620239,0.29151082038879395,0.271295428276062,0.2852827310562134,0.30703771114349365,0.340610146522522,0.3529766798019409,0.30783796310424805,0.29966235160827637,0.3044823408126831,0.3257652521133423,0.9653506278991699,0.3346978425979614,0.30891942977905273,0.30964457988739014,0.28310883045196533,0.3005845546722412,0.32036590576171875,0.34187746047973633,0.34386181831359863,0.3153057098388672,0.31582796573638916,0.3232097625732422,0.3368290662765503,0.9764940738677979,0.34611940383911133,0.3037445545196533,0.3089940547943115,0.2964128255844116,0.30141639709472656,0.319355845451355,0.353912353515625,0.34818077087402344,0.3277440071105957,0.32979869842529297,0.3215649127960205,0.345058798789978,0.9822995662689209,0.34179115295410156,0.3069040775299072,0.31657302379608154,0.2980813980102539,0.31919169425964355,0.3380746841430664,0.36130261421203613,0.36142635345458984,0.3342539072036743,0.32179081439971924,0.3079793453216553,0.33281445503234863,0.9854912757873535,0.3427191972732544,0.304435133934021,0.31725823879241943,0.3049236536026001,0.31504833698272705,0.3332880735397339,0.36574387550354004,0.3581608533859253,0.32983696460723877,0.32017993927001953,0.3128230571746826,0.3331732749938965,0.9852337837219238,0.35906195640563965,0.3341108560562134,0.3290131092071533,0.3032318353652954,0.32588493824005127,0.3465007543563843,0.3573974370956421,0.3666660785675049,0.3368798494338989,0.3344571590423584,0.33240222930908203,0.35381174087524414,0.9969038963317871,0.3563826084136963,0.31829380989074707,0.32700037956237793,0.30157148838043213,0.32103800773620605,0.3369408845901489,0.36171698570251465,0.36719584465026855,0.32669687271118164,0.3177173137664795,0.3091083765029907,0.3322066068649292,0.9884979724884033,0.33518922328948975,0.30353832244873047,0.3168160915374756,0.2998718023300171,0.3168755769729614,0.3372732400894165,0.36405789852142334,0.3612767457962036,0.34038209915161133,0.3320636749267578,0.328360915184021,0.349082350730896,0.989208459854126,0.35880541801452637,0.32726967334747314,0.32305896282196045,0.30142319202423096,0.31549501419067383,0.3356870412826538,0.3628751039505005,0.3660886287689209,0.3385225534439087,0.3296699523925781,0.3311554193496704,0.3565307855606079,0.9943387508392334,0.3602808713912964,0.33475494384765625,0.32276642322540283,0.30517613887786865,0.33214271068573,0.3441941738128662,0.36306285858154297,0.35921812057495117,0.33937788009643555,0.330804705619812,0.33255529403686523,0.36028361320495605,0.9973475933074951,0.35975897312164307,0.3276205062866211,0.33696627616882324,0.30545341968536377,0.32208120822906494,0.35036230087280273,0.3691432476043701,0.37072765827178955,0.3476516008377075,0.33613455295562744,0.3293955326080322,0.3593606948852539,1.0,0.34431159496307373,0.32631373405456543,0.3317674398422241,0.2987886667251587,0.32409560680389404,0.3439445495605469,0.36956143379211426,0.3720051050186157,0.3368663787841797,0.3366708755493164,0.3297419548034668,0.35064423084259033,0.9958310127258301,0.3555225133895874,0.33366429805755615,0.3279045820236206,0.3084530830383301,0.32547879219055176,0.3500630855560303,0.36650609970092773,0.3733295202255249,0.3442986011505127,0.33321094512939453,0.3296194076538086,0.35467052459716797,0.9989254474639893,0.3601115942001343,0.33846044540405273,0.3302241563796997,0.3100956678390503,0.32243430614471436,0.34671926498413086,0.368772029876709,0.362237811088562,0.3341047763824463,0.3196934461593628,0.3199273347854614,0.341985821723938,0.9949288368225098,0.3430180549621582,0.2946285009384155,0.2869921922683716,0.2658662796020508,0.27754461765289307,0.30582261085510254,0.32180511951446533,0.32922208309173584,0.2896127700805664,0.29370105266571045,0.28905045986175537,0.3355656862258911,0.9601913690567017,0.3441448211669922,0.31552886962890625,0.3043811321258545,0.27141761779785156,0.3014216423034668,0.33542776107788086,0.3558487892150879,0.3556002378463745,0.3129993677139282,0.28418707847595215,0.29058659076690674,0.33903348445892334,0.9753537178039551,0.3408203125,0.29092586040496826,0.2887946367263794,0.2664083242416382,0.2896592617034912,0.3222278356552124,0.34940671920776367,0.345302939414978,0.2998802661895752,0.27619504928588867,0.2668752670288086,0.2907198667526245,0.9602534770965576,0.27926409244537354,0.250665545463562,0.23032867908477783,0.20426487922668457,0.24915647506713867,0.2797255516052246,0.32624542713165283,0.31575512886047363,0.2719101905822754,0.2620631456375122,0.27487635612487793,0.2870751619338989],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9276576042175293,0.2926522493362427,0.2650904655456543,0.2766019105911255,0.24021363258361816,0.2557260990142822,0.2906097173690796,0.3159877061843872,0.31272971630096436,0.28366780281066895,0.26258933544158936,0.26069176197052,0.2993978261947632,0.937044620513916,0.31972837448120117,0.29662132263183594,0.2842599153518677,0.23025715351104736,0.253709077835083,0.2901473045349121,0.3130711317062378,0.3115243911743164,0.2721998691558838,0.24355971813201904,0.2575267553329468,0.2692919969558716,0.9363551139831543,0.2797921895980835,0.26351428031921387,0.23014330863952637,0.18319368362426758,0.2227400541305542,0.26870977878570557,0.2947458028793335,0.28515756130218506,0.2526588439941406,0.2076091766357422,0.18505501747131348,0.19176554679870605,0.8980154991149902,0.24162912368774414,0.19276583194732666,0.13733422756195068,0.1296464204788208,0.16329562664031982,0.24535417556762695,0.2845417261123657,0.282909631729126,0.24120962619781494,0.2089366912841797,0.178300142288208,0.2523385286331177,0.874406099319458,0.2442340850830078,0.17658209800720215,0.18127620220184326,0.15695953369140625,0.1903979778289795,0.22471749782562256,0.26759541034698486,0.25271403789520264,0.20762860774993896,0.1858673095703125,0.19058489799499512,0.22442102432250977,0.8670438528060913,0.2480231523513794,0.1635141372680664,0.15756595134735107,0.1349811553955078,0.17196738719940186,0.21218204498291016,0.24412178993225098,0.24386966228485107,0.20329487323760986,0.17803645133972168,0.19365990161895752,0.2117992639541626,0.8557004928588867,0.2114804983139038,0.15926861763000488,0.15507853031158447,0.08728659152984619,0.13080406188964844,0.15428483486175537,0.20989108085632324,0.1943899393081665,0.16872334480285645,0.11491966247558594,0.14061498641967773,0.13311052322387695,0.8138372898101807,0.11018502712249756,0.0779029130935669,0.054148077964782715,0.0,0.027698159217834473,0.10342586040496826,0.1769702434539795,0.180700421333313,0.11591291427612305,0.0868910551071167,0.08991289138793945,0.14753377437591553,0.7592010498046875,0.15835559368133545,0.17116427421569824,0.09573602676391602,0.05984032154083252,0.10055184364318848,0.17072820663452148,0.21122872829437256,0.21013927459716797,0.15153765678405762,0.10163688659667969,0.08114266395568848,0.09291946887969971,0.7947807312011719,0.17461299896240234,0.1266721487045288,0.09086084365844727,0.0637274980545044,0.09237051010131836,0.13614439964294434,0.1773989200592041,0.1715019941329956,0.10817575454711914,0.06997382640838623,0.07615208625793457,0.13539397716522217],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Coal since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('47c6940c-9afa-48d1-ba45-91d71be73337');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">

<div>                            <div id="58a2a683-eb71-45bd-9059-7a433ed4d2df" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("58a2a683-eb71-45bd-9059-7a433ed4d2df")) {                    Plotly.newPlot(                        "58a2a683-eb71-45bd-9059-7a433ed4d2df",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.18275845050811768,0.18182122707366943,0.16993534564971924,0.17348599433898926,0.1829054355621338,0.1971607208251953,0.2028195858001709,0.18436527252197266,0.19166994094848633],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.19274020195007324],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.21107017993927002,0.8467828035354614,0.20714902877807617,0.18062496185302734,0.18459630012512207,0.1709212064743042,0.17977750301361084,0.175268292427063,0.19844567775726318],"type":"scatter"},{"x":[19],"y":[0.1990797519683838],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.17396998405456543,0.18643462657928467,0.1767488718032837,0.19263195991516113,0.8421190977096558,0.20526337623596191,0.1831376552581787,0.1902681589126587,0.17020738124847412],"type":"scatter"},{"x":[29],"y":[0.1656728982925415],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.17553210258483887,0.18994057178497314,0.19784057140350342,0.16990447044372559,0.17510318756103516,0.18150997161865234,0.20858049392700195,0.8411809206008911,0.21808147430419922],"type":"scatter"},{"x":[39],"y":[0.18619203567504883],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.19624018669128418,0.18420839309692383,0.1858065128326416,0.19501566886901855,0.21182310581207275,0.2140333652496338,0.19148898124694824,0.20189642906188965,0.21336066722869873],"type":"scatter"},{"x":[49],"y":[0.23449671268463135],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.859567403793335,0.2322371006011963,0.2011195421218872,0.20302999019622803,0.18183469772338867,0.1974489688873291,0.21048128604888916,0.23087942600250244,0.2248976230621338],"type":"scatter"},{"x":[59],"y":[0.2055577039718628],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.20350003242492676,0.20517492294311523,0.2213534116744995,0.8665963411331177,0.21761095523834229,0.17035317420959473,0.15870130062103271,0.17972612380981445,0.2007303237915039],"type":"scatter"},{"x":[69],"y":[0.21313190460205078],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.23049592971801758,0.2383817434310913,0.22436845302581787,0.21609342098236084,0.21611475944519043,0.23870837688446045,0.8662874698638916,0.2512766122817993,0.2203885316848755],"type":"scatter"},{"x":[79],"y":[0.22272861003875732],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.20755088329315186,0.2209465503692627,0.22945880889892578,0.24834871292114258,0.24998044967651367,0.22064566612243652,0.22670531272888184,0.22694969177246094,0.2509031295776367],"type":"scatter"},{"x":[89],"y":[0.888128399848938],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.259920597076416,0.24255776405334473,0.23853528499603271,0.20920276641845703,0.20975589752197266,0.22478139400482178,0.2548670768737793,0.25361084938049316,0.22971832752227783],"type":"scatter"},{"x":[99],"y":[0.2227400541305542],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.22857940196990967,0.2574986219406128,0.8929575681686401,0.2724018096923828,0.24000072479248047,0.24121379852294922,0.21650302410125732,0.21792006492614746,0.23787009716033936],"type":"scatter"},{"x":[109],"y":[0.27138710021972656],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.26562225818634033,0.2396625280380249,0.23693335056304932,0.2356128692626953,0.26123046875,0.9017386436462402,0.27709805965423584,0.24040484428405762,0.233373761177063],"type":"scatter"},{"x":[119],"y":[0.21020448207855225],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.2170013189315796,0.22156572341918945,0.2558457851409912,0.2550114393234253,0.22491133213043213,0.21747982501983643,0.22588694095611572,0.24114513397216797,0.8921005725860596],"type":"scatter"},{"x":[129],"y":[0.2524104118347168],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.21538102626800537,0.2186349630355835,0.20637786388397217,0.21362709999084473,0.2313913106918335,0.2778208255767822,0.29072701930999756,0.2537806034088135,0.24207353591918945],"type":"scatter"},{"x":[139],"y":[0.24625325202941895],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.28225743770599365,0.9020661115646362,0.28774237632751465,0.25334715843200684,0.26094233989715576,0.23611557483673096,0.24108529090881348,0.26686549186706543,0.2814364433288574],"type":"scatter"},{"x":[149],"y":[0.2925746440887451],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.25722646713256836,0.2584836483001709,0.2586100101470947,0.27327990531921387,0.9209167957305908,0.2956275939941406,0.26197004318237305,0.2580920457839966,0.24589359760284424],"type":"scatter"},{"x":[159],"y":[0.2573293447494507],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.2656515836715698,0.2925323247909546,0.2888448238372803,0.2645144462585449,0.25828075408935547,0.25738370418548584,0.29658472537994385,0.9272034168243408,0.3009589910507202],"type":"scatter"},{"x":[169],"y":[0.26359689235687256],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.2585197687149048,0.2351245880126953,0.245682954788208,0.27243220806121826,0.3026331663131714,0.27981626987457275,0.26055634021759033,0.2520056962966919,0.2535189390182495],"type":"scatter"},{"x":[179],"y":[0.27834057807922363],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.9241061210632324,0.28940582275390625,0.2528536319732666,0.25512123107910156,0.24666273593902588,0.26469099521636963,0.2880474328994751,0.31656336784362793,0.3148716688156128],"type":"scatter"},{"x":[189],"y":[0.2771952152252197],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.27057182788848877,0.26823246479034424,0.2965952157974243,0.9357558488845825,0.3101714849472046,0.28633034229278564,0.2781878709793091,0.256364107131958,0.2644360065460205],"type":"scatter"},{"x":[199],"y":[0.2969094514846802],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.32042622566223145,0.3299058675765991,0.2835655212402344,0.27998828887939453,0.27834248542785645,0.30769646167755127,0.9483156204223633,0.30749642848968506,0.29173922538757324],"type":"scatter"},{"x":[209],"y":[0.29017579555511475],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.26702094078063965,0.2745743989944458,0.2921316623687744,0.3133760690689087,0.31480681896209717,0.2880798578262329,0.28299009799957275,0.2850759029388428,0.32490992546081543],"type":"scatter"},{"x":[219],"y":[0.9513071775436401],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.3047553300857544,0.27343153953552246,0.284709095954895,0.2703282833099365,0.2754114866256714,0.2969249486923218,0.31846654415130615,0.32313108444213867,0.30253636837005615],"type":"scatter"},{"x":[229],"y":[0.29722845554351807],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.2854311466217041,0.3118114471435547,0.9523074626922607,0.32024049758911133,0.2730748653411865,0.27674055099487305,0.2566007375717163,0.2790710926055908,0.295282244682312],"type":"scatter"},{"x":[239],"y":[0.3185514211654663],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.3175487518310547,0.29332852363586426,0.28672730922698975,0.29511451721191406,0.3055121898651123,0.9502558708190918,0.3094445466995239,0.27976250648498535,0.29017579555511475],"type":"scatter"},{"x":[249],"y":[0.2721160650253296],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.27797365188598633,0.29060447216033936,0.3248302936553955,0.31422579288482666,0.29781007766723633,0.28915584087371826,0.28858888149261475,0.3135538101196289,0.9525768756866455],"type":"scatter"},{"x":[259],"y":[0.3116292953491211],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.291080117225647,0.3031657934188843,0.2746121883392334,0.27538323402404785,0.3046222925186157,0.3374905586242676,0.3359564542770386,0.2974501848220825,0.2966386079788208],"type":"scatter"},{"x":[269],"y":[0.2985835075378418],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.32115209102630615,0.9611079692840576,0.3348062038421631,0.2976301908493042,0.30091798305511475,0.27601873874664307,0.28741347789764404,0.32084810733795166,0.3320622444152832],"type":"scatter"},{"x":[279],"y":[0.3294506072998047],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.2990227937698364,0.2938871383666992,0.285097599029541,0.3087502717971802,0.9625844955444336,0.3177589178085327,0.2915002107620239,0.29151082038879395,0.271295428276062],"type":"scatter"},{"x":[289],"y":[0.2852827310562134],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.30703771114349365,0.340610146522522,0.3529766798019409,0.30783796310424805,0.29966235160827637,0.3044823408126831,0.3257652521133423,0.9653506278991699,0.3346978425979614],"type":"scatter"},{"x":[299],"y":[0.30891942977905273],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.30964457988739014,0.28310883045196533,0.3005845546722412,0.32036590576171875,0.34187746047973633,0.34386181831359863,0.3153057098388672,0.31582796573638916,0.3232097625732422],"type":"scatter"},{"x":[309],"y":[0.3368290662765503],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9764940738677979,0.34611940383911133,0.3037445545196533,0.3089940547943115,0.2964128255844116,0.30141639709472656,0.319355845451355,0.353912353515625,0.34818077087402344],"type":"scatter"},{"x":[319],"y":[0.3277440071105957],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.32979869842529297,0.3215649127960205,0.345058798789978,0.9822995662689209,0.34179115295410156,0.3069040775299072,0.31657302379608154,0.2980813980102539,0.31919169425964355],"type":"scatter"},{"x":[329],"y":[0.3380746841430664],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.36130261421203613,0.36142635345458984,0.3342539072036743,0.32179081439971924,0.3079793453216553,0.33281445503234863,0.9854912757873535,0.3427191972732544,0.304435133934021],"type":"scatter"},{"x":[339],"y":[0.31725823879241943],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.3049236536026001,0.31504833698272705,0.3332880735397339,0.36574387550354004,0.3581608533859253,0.32983696460723877,0.32017993927001953,0.3128230571746826,0.3331732749938965],"type":"scatter"},{"x":[349],"y":[0.9852337837219238],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.35906195640563965,0.3341108560562134,0.3290131092071533,0.3032318353652954,0.32588493824005127,0.3465007543563843,0.3573974370956421,0.3666660785675049,0.3368798494338989],"type":"scatter"},{"x":[359],"y":[0.3344571590423584],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.33240222930908203,0.35381174087524414,0.9969038963317871,0.3563826084136963,0.31829380989074707,0.32700037956237793,0.30157148838043213,0.32103800773620605,0.3369408845901489],"type":"scatter"},{"x":[369],"y":[0.36171698570251465],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.36719584465026855,0.32669687271118164,0.3177173137664795,0.3091083765029907,0.3322066068649292,0.9884979724884033,0.33518922328948975,0.30353832244873047,0.3168160915374756],"type":"scatter"},{"x":[379],"y":[0.2998718023300171],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.3168755769729614,0.3372732400894165,0.36405789852142334,0.3612767457962036,0.34038209915161133,0.3320636749267578,0.328360915184021,0.349082350730896,0.989208459854126],"type":"scatter"},{"x":[389],"y":[0.35880541801452637],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.32726967334747314,0.32305896282196045,0.30142319202423096,0.31549501419067383,0.3356870412826538,0.3628751039505005,0.3660886287689209,0.3385225534439087,0.3296699523925781],"type":"scatter"},{"x":[399],"y":[0.3311554193496704],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.3565307855606079,0.9943387508392334,0.3602808713912964,0.33475494384765625,0.32276642322540283,0.30517613887786865,0.33214271068573,0.3441941738128662,0.36306285858154297],"type":"scatter"},{"x":[409],"y":[0.35921812057495117],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.33937788009643555,0.330804705619812,0.33255529403686523,0.36028361320495605,0.9973475933074951,0.35975897312164307,0.3276205062866211,0.33696627616882324,0.30545341968536377],"type":"scatter"},{"x":[419],"y":[0.32208120822906494],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.35036230087280273,0.3691432476043701,0.37072765827178955,0.3476516008377075,0.33613455295562744,0.3293955326080322,0.3593606948852539,1.0,0.34431159496307373],"type":"scatter"},{"x":[429],"y":[0.32631373405456543],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.3317674398422241,0.2987886667251587,0.32409560680389404,0.3439445495605469,0.36956143379211426,0.3720051050186157,0.3368663787841797,0.3366708755493164,0.3297419548034668],"type":"scatter"},{"x":[439],"y":[0.35064423084259033],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9958310127258301,0.3555225133895874,0.33366429805755615,0.3279045820236206,0.3084530830383301,0.32547879219055176,0.3500630855560303,0.36650609970092773,0.3733295202255249],"type":"scatter"},{"x":[449],"y":[0.3442986011505127],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.33321094512939453,0.3296194076538086,0.35467052459716797,0.9989254474639893,0.3601115942001343,0.33846044540405273,0.3302241563796997,0.3100956678390503,0.32243430614471436],"type":"scatter"},{"x":[459],"y":[0.34671926498413086],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.368772029876709,0.362237811088562,0.3341047763824463,0.3196934461593628,0.3199273347854614,0.341985821723938,0.9949288368225098,0.3430180549621582,0.2946285009384155],"type":"scatter"},{"x":[469],"y":[0.2869921922683716],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.2658662796020508,0.27754461765289307,0.30582261085510254,0.32180511951446533,0.32922208309173584,0.2896127700805664,0.29370105266571045,0.28905045986175537,0.3355656862258911],"type":"scatter"},{"x":[479],"y":[0.9601913690567017],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3441448211669922,0.31552886962890625,0.3043811321258545,0.27141761779785156,0.3014216423034668,0.33542776107788086,0.3558487892150879,0.3556002378463745,0.3129993677139282],"type":"scatter"},{"x":[489],"y":[0.28418707847595215],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.29058659076690674,0.33903348445892334,0.9753537178039551,0.3408203125,0.29092586040496826,0.2887946367263794,0.2664083242416382,0.2896592617034912,0.3222278356552124],"type":"scatter"},{"x":[499],"y":[0.34940671920776367],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.345302939414978,0.2998802661895752,0.27619504928588867,0.2668752670288086,0.2907198667526245,0.9602534770965576,0.27926409244537354,0.250665545463562,0.23032867908477783],"type":"scatter"},{"x":[509],"y":[0.20426487922668457],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Coal since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('58a2a683-eb71-45bd-9059-7a433ed4d2df');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn">Model 1 = RNN</h3>
<section id="model-architecture" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture">Model architecture</h4>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn (SimpleRNN)      (None, 3)                 15        
                                                                 
 dense (Dense)               (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-04-30 23:33:02.096265: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.03547626
0.014106057
Train MSE = 0.03548 RMSE = 0.18835
Test MSE = 0.01411 RMSE = 0.11877</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="a52dde89-94d7-405b-bf59-66a0312df0ad" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a52dde89-94d7-405b-bf59-66a0312df0ad")) {                    Plotly.newPlot(                        "a52dde89-94d7-405b-bf59-66a0312df0ad",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.07337750494480133,0.07196149975061417,0.07112761586904526,0.07062189280986786,0.07019969075918198,0.06958431005477905,0.0692242830991745,0.068844273686409,0.06829071044921875,0.06788716465234756,0.06739187240600586,0.06716868281364441,0.06682227551937103,0.06621889024972916,0.06623773276805878,0.06558981537818909,0.0651206448674202,0.06492532789707184,0.0643555298447609,0.06421732157468796,0.06384844332933426,0.06348449736833572,0.06309241056442261,0.06299256533384323,0.06229452043771744,0.06193498522043228,0.061687540262937546,0.06138954311609268,0.06130418926477432,0.06072624772787094,0.06035534664988518,0.06043817475438118,0.059710681438446045,0.059338681399822235,0.059141505509614944,0.058744095265865326,0.05849310755729675,0.05814133211970329,0.05773767828941345,0.057586610317230225,0.057164739817380905,0.05723050981760025,0.05661085993051529,0.0563623420894146,0.05657128617167473,0.056181956082582474,0.05541585758328438,0.0554032102227211,0.05495404079556465,0.054716646671295166,0.0543622151017189,0.05433959886431694,0.05382731556892395,0.05358366295695305,0.053576864302158356,0.05303093045949936,0.05279146507382393,0.05262000486254692,0.05235481262207031,0.05203627422451973,0.051876794546842575,0.05151547119021416,0.05138244479894638,0.051210541278123856,0.05070144683122635,0.050456978380680084,0.05023527890443802,0.05014755204319954,0.05005106329917908,0.04965335875749588,0.049395713955163956,0.049274347722530365,0.04886048287153244,0.048738058656454086,0.048488326370716095,0.048433829098939896,0.048220228403806686,0.04803450033068657,0.047589261084795,0.047380231320858,0.0473102331161499,0.047241903841495514,0.04698306322097778,0.046715181320905685,0.04662509262561798,0.04624605178833008,0.04603665694594383,0.04600970819592476,0.04570458084344864,0.04569769278168678,0.04545169696211815,0.04517535865306854,0.04508797451853752,0.04491268843412399,0.04457932710647583,0.04449035972356796,0.04438714310526848,0.04430094361305237,0.04390712082386017,0.043888263404369354,0.04366198182106018,0.043492987751960754,0.0433773510158062,0.04327825456857681,0.04301128163933754,0.04303973913192749,0.04285939782857895,0.04250434413552284,0.04279473423957825,0.042602427303791046,0.04214443266391754,0.04200931638479233,0.04190602898597717,0.041761405766010284,0.041744522750377655,0.04150128364562988,0.041487790644168854,0.041276682168245316,0.041170790791511536,0.04109647125005722,0.04093322157859802,0.040933288633823395,0.04069969058036804,0.040547989308834076,0.04040008783340454,0.04055457562208176,0.04017898440361023,0.040148887783288956,0.04024306684732437,0.03984349966049194,0.03993787616491318,0.03967559337615967,0.0398283489048481,0.03964398428797722,0.03941277787089348,0.03939507156610489,0.03922935575246811,0.03939008340239525,0.03916356712579727,0.03907829150557518,0.038898956030607224,0.038884736597537994,0.03897351771593094,0.038618218153715134,0.038604773581027985,0.0385969839990139,0.038575220853090286,0.038398515433073044,0.03835386410355568,0.03822588175535202,0.03826161473989487,0.03815995901823044,0.0381765142083168,0.038120873272418976,0.038081757724285126,0.03797361999750137,0.03786086291074753,0.03798631578683853,0.03808198496699333,0.03777780383825302,0.03769395127892494,0.03772272914648056,0.03763563185930252,0.03750201687216759,0.037690721452236176,0.03738772124052048,0.037624843418598175,0.03737669065594673,0.037431858479976654,0.03724748268723488,0.03738574683666229,0.037162698805332184,0.03751944750547409,0.03710930421948433,0.03708256036043167,0.03710559383034706,0.037174779921770096,0.036928750574588776,0.03701397776603699,0.037221718579530716,0.03681604191660881,0.036798715591430664,0.03689689189195633,0.036856018006801605,0.03675965964794159,0.03680639714002609,0.03668256103992462,0.0368637852370739,0.03656288981437683,0.03676905483007431,0.036515653133392334,0.03651711717247963,0.036632269620895386,0.03657618910074234,0.03650479391217232,0.03639065474271774,0.036413293331861496,0.036309003829956055,0.036314867436885834,0.03654365986585617],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.07573778927326202,0.07468180358409882,0.07380616664886475,0.0732809379696846,0.07269831746816635,0.0721338540315628,0.07161033898591995,0.07120474427938461,0.07076145708560944,0.07030314207077026,0.06991810351610184,0.06957128643989563,0.06918136030435562,0.06871407479047775,0.06834013015031815,0.06793738156557083,0.06757423281669617,0.06716316193342209,0.06684640794992447,0.06652352213859558,0.06626449525356293,0.06598125398159027,0.06561204791069031,0.06530500203371048,0.06500694900751114,0.06462123990058899,0.06430167704820633,0.06394732743501663,0.06362830102443695,0.06332878768444061,0.06305932998657227,0.06285696476697922,0.0625641793012619,0.06223437562584877,0.06192784011363983,0.061646103858947754,0.061268970370292664,0.06091900169849396,0.06064664199948311,0.06044640764594078,0.06017293035984039,0.0599248893558979,0.059606049209833145,0.05934871733188629,0.05918966606259346,0.05893448740243912,0.0586169995367527,0.05834474787116051,0.0580429881811142,0.05776301398873329,0.05754735693335533,0.05728071555495262,0.056967709213495255,0.05670326575636864,0.05638240650296211,0.056160472333431244,0.055994417518377304,0.055732205510139465,0.05542450025677681,0.0552295483648777,0.05497848615050316,0.054653894156217575,0.05448177829384804,0.05432683601975441,0.05410195514559746,0.05391165241599083,0.05372258275747299,0.05346011742949486,0.053304389119148254,0.05307060852646828,0.052802685648202896,0.052638374269008636,0.05241120234131813,0.05216077342629433,0.051928531378507614,0.05174475908279419,0.05151932314038277,0.051332294940948486,0.0510830320417881,0.050893139094114304,0.050662580877542496,0.05054863914847374,0.05035397782921791,0.05017828941345215,0.05005580559372902,0.049849070608615875,0.04963447153568268,0.049448903650045395,0.04934312030673027,0.04917844384908676,0.04903750494122505,0.048883698880672455,0.048725392669439316,0.04849189892411232,0.04828856140375137,0.04806467518210411,0.0479440838098526,0.04782669618725777,0.04769789054989815,0.047528211027383804,0.04738985374569893,0.04721430689096451,0.04712836816906929,0.04704028367996216,0.0468633770942688,0.046786125749349594,0.04666867479681969,0.04655548185110092,0.04650126397609711,0.04640977084636688,0.04623013734817505,0.04608481749892235,0.04593038931488991,0.04586595296859741,0.0457044392824173,0.045609209686517715,0.04546745866537094,0.04536133632063866,0.04526267573237419,0.04512501135468483,0.04504616558551788,0.044913943856954575,0.04482816159725189,0.044661495834589005,0.044487737119197845,0.04442356899380684,0.04436005279421806,0.044263605028390884,0.044192392379045486,0.044042035937309265,0.04402711242437363,0.043918900191783905,0.043838344514369965,0.04376452788710594,0.043611351400613785,0.04361585155129433,0.043565135449171066,0.043495140969753265,0.0434194914996624,0.043305639177560806,0.04314201697707176,0.0430179126560688,0.042984142899513245,0.04290636628866196,0.042767032980918884,0.042715296149253845,0.042682211846113205,0.04262325167655945,0.04260553419589996,0.0425872728228569,0.042490698397159576,0.04244561493396759,0.04239765927195549,0.042343899607658386,0.042383842170238495,0.04225516319274902,0.04219810292124748,0.04219946265220642,0.04222394526004791,0.04222206771373749,0.042158592492341995,0.042110294103622437,0.042076483368873596,0.04203200712800026,0.041984643787145615,0.04192724451422691,0.041893038898706436,0.04189544916152954,0.04191247746348381,0.041913505643606186,0.041841164231300354,0.04182830825448036,0.04184986650943756,0.04175015911459923,0.04163932800292969,0.04164137318730354,0.041567113250494,0.04152853414416313,0.04149220883846283,0.04153202101588249,0.04152296856045723,0.04151088371872902,0.04150369390845299,0.04148929938673973,0.04136580228805542,0.04133807122707367,0.04128749296069145,0.04131299629807472,0.041321977972984314,0.041349396109580994,0.041306022554636,0.04130643233656883,0.04125261679291725,0.04122646525502205,0.041178081184625626,0.04110445827245712,0.04107387363910675,0.041006457060575485,0.04092244803905487,0.040927086025476456],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a52dde89-94d7-405b-bf59-66a0312df0ad');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru">Model 2 - GRU</h3>
<section id="model-architecture-1" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-1">Model Architecture</h4>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 3)                 54        
                                                                 
 dense_1 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss">Plot training and validation loss</h4>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 6ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03444274
0.035602108
Train MSE = 0.03444 RMSE = 0.18559
Test MSE = 0.03560 RMSE = 0.18869</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="d5b3fa01-85c9-4fea-a695-e4f28c2e165a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d5b3fa01-85c9-4fea-a695-e4f28c2e165a")) {                    Plotly.newPlot(                        "d5b3fa01-85c9-4fea-a695-e4f28c2e165a",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.26585036516189575,0.22659870982170105,0.20185630023479462,0.18190424144268036,0.16460461914539337,0.14919845759868622,0.13519591093063354,0.12236086279153824,0.11066268384456635,0.10039345920085907,0.09111127257347107,0.08278477191925049,0.07607292383909225,0.07030711323022842,0.06602158397436142,0.06255818903446198,0.06025207042694092,0.05824790522456169,0.057001274079084396,0.056346990168094635,0.05602617934346199,0.05536095052957535,0.0548822395503521,0.05437500402331352,0.05395545810461044,0.05389212444424629,0.053263939917087555,0.05259329080581665,0.05253768712282181,0.05208877846598625,0.05208265781402588,0.05143236368894577,0.05146799236536026,0.05085816979408264,0.050119441002607346,0.049778006970882416,0.0496421679854393,0.04984438419342041,0.049199290573596954,0.04880228638648987,0.048194438219070435,0.0480547770857811,0.0479864627122879,0.04743826389312744,0.04752448573708534,0.04695899412035942,0.04702817648649216,0.046651337295770645,0.04599694162607193,0.045655351132154465,0.04541606828570366,0.045261867344379425,0.04520418122410774,0.04507903754711151,0.04463399574160576,0.04416941851377487,0.04431780055165291,0.04387645050883293,0.04399552568793297,0.0435735322535038,0.04317903891205788,0.04284699633717537,0.04277283698320389,0.042782336473464966,0.042365364730358124,0.0423269122838974,0.042281150817871094,0.0416862815618515,0.041524358093738556,0.04197729378938675,0.04114574193954468,0.041600652039051056,0.04089628532528877,0.04068624973297119,0.04096755385398865,0.040579117834568024,0.040185097604990005,0.040553443133831024,0.040424395352602005,0.04002995416522026,0.039740752428770065,0.0395469069480896,0.03970886766910553,0.039231978356838226,0.039394132792949677,0.03925509750843048,0.03931219130754471,0.038803987205028534,0.039154987782239914,0.03873620182275772,0.03847397118806839,0.03879203647375107,0.03843285143375397,0.03832890838384628,0.03821517899632454,0.0383731983602047,0.03821475803852081,0.03806207701563835,0.0380617193877697,0.03766625374555588,0.037963978946208954,0.037439484149217606,0.03755564242601395,0.037359610199928284,0.03732816129922867,0.03720061853528023,0.0373368114233017,0.03741472586989403,0.03733399510383606,0.03720807656645775,0.03700080141425133,0.03709574043750763,0.03677546977996826,0.03663741052150726,0.03681681677699089,0.036833617836236954,0.03651508688926697,0.037330590188503265,0.03683587163686752,0.03650134056806564,0.03637169301509857,0.036476366221904755,0.036523766815662384,0.03638165071606636,0.036261580884456635,0.03646877035498619,0.036069486290216446,0.03615371510386467,0.03615906462073326,0.03601421043276787,0.036296479403972626,0.03610672056674957,0.035644255578517914,0.0357130691409111,0.03596987575292587,0.03567183017730713,0.03569313883781433,0.035892385989427567,0.035676151514053345,0.03546180576086044,0.035891540348529816,0.03534042090177536,0.035711489617824554,0.035622335970401764,0.03526877611875534,0.03535076230764389,0.03531292453408241,0.03521385416388512,0.03560132533311844,0.035659871995449066,0.0350540354847908,0.035424090921878815,0.03533606603741646,0.035393547266721725,0.03533301502466202,0.0351540707051754,0.03503803163766861,0.03526163101196289,0.03493346646428108,0.03520549461245537,0.03483158349990845,0.03526332229375839,0.03495368734002113,0.034887928515672684,0.03497133031487465,0.03545217216014862,0.03476652875542641,0.03477327153086662,0.034911613911390305,0.03475744277238846,0.0353173203766346,0.03505263477563858,0.03510015457868576,0.03480430692434311,0.03460826724767685,0.03495771810412407,0.03458160161972046,0.03478901460766792,0.034807510673999786,0.034608714282512665,0.03447287157177925,0.034821540117263794,0.034563399851322174,0.034714825451374054,0.03461537882685661,0.03453568369150162,0.03457504138350487,0.03472467511892319,0.0344417579472065,0.03475892171263695,0.034334488213062286,0.03434349223971367,0.03432110697031021,0.03437759727239609,0.034313756972551346,0.03430483862757683,0.03425939753651619,0.03429403156042099,0.034328851848840714,0.03436347842216492],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.2935555875301361,0.2606172263622284,0.23583580553531647,0.21382813155651093,0.19486093521118164,0.17721721529960632,0.1609860360622406,0.14566273987293243,0.1321282833814621,0.11975908279418945,0.10810665786266327,0.09789042919874191,0.08912856131792068,0.082395538687706,0.07619411498308182,0.07181638479232788,0.06808125227689743,0.06513675302267075,0.06327703595161438,0.06196583807468414,0.06089415401220322,0.059719886630773544,0.059521373361349106,0.05847135931253433,0.05814987048506737,0.058191362768411636,0.057747483253479004,0.0572543628513813,0.057071756571531296,0.0560399554669857,0.05562721565365791,0.055264104157686234,0.055037688463926315,0.05463813245296478,0.05436747893691063,0.054079413414001465,0.054036691784858704,0.05355435237288475,0.05352354422211647,0.05294698476791382,0.052527282387018204,0.051871202886104584,0.05192497745156288,0.05140545219182968,0.051129985600709915,0.05109574645757675,0.05073099955916405,0.05074801295995712,0.05037224665284157,0.05009785667061806,0.05020725354552269,0.04951680079102516,0.049138329923152924,0.04893827065825462,0.04922987148165703,0.04877264425158501,0.048025283962488174,0.047935906797647476,0.047726571559906006,0.048097286373376846,0.047809336334466934,0.04748837649822235,0.04727110639214516,0.047285452485084534,0.04695864021778107,0.04711732640862465,0.046611666679382324,0.046670034527778625,0.04617617279291153,0.046232711523771286,0.0457727275788784,0.04550031200051308,0.045447155833244324,0.04524439945816994,0.04526742547750473,0.04532962664961815,0.044910069555044174,0.04512981325387955,0.04476633667945862,0.044901613146066666,0.04480476677417755,0.04439540207386017,0.04442557319998741,0.044208183884620667,0.04445461183786392,0.0437813326716423,0.04353070259094238,0.04332510381937027,0.043315209448337555,0.043302033096551895,0.04320451617240906,0.043253324925899506,0.04334859177470207,0.04310506209731102,0.04265068471431732,0.04264560341835022,0.042864251881837845,0.0426286943256855,0.042643070220947266,0.042443666607141495,0.0427539236843586,0.04231405630707741,0.04242076724767685,0.04250246286392212,0.042246174067258835,0.04234163835644722,0.04261450469493866,0.04226021468639374,0.042141661047935486,0.042084310203790665,0.042123619467020035,0.04208586364984512,0.04203946888446808,0.04163813963532448,0.0416380874812603,0.04161876067519188,0.04139282926917076,0.041394904255867004,0.04147719591856003,0.04154258593916893,0.041368067264556885,0.04145750403404236,0.041337136179208755,0.04103267565369606,0.04085177555680275,0.04077332839369774,0.04099123179912567,0.04077444598078728,0.04086294770240784,0.04075859859585762,0.04094068706035614,0.04110436514019966,0.04088421165943146,0.04059566557407379,0.04038536921143532,0.04050731286406517,0.04068213328719139,0.04048864170908928,0.04063458740711212,0.040688809007406235,0.04065929353237152,0.04042806848883629,0.040633801370859146,0.040546078234910965,0.040602825582027435,0.040316659957170486,0.04013080522418022,0.0403580479323864,0.040342334657907486,0.040532149374485016,0.040201395750045776,0.040246617048978806,0.04025864601135254,0.040108539164066315,0.0403740257024765,0.0399862639605999,0.040132954716682434,0.03991187736392021,0.03984590247273445,0.039779726415872574,0.03989757224917412,0.0397665835916996,0.039969585835933685,0.0399186946451664,0.04008384421467781,0.04020104184746742,0.04001197963953018,0.03975466266274452,0.040103163570165634,0.04018358886241913,0.040209248661994934,0.04003942385315895,0.03994511440396309,0.039856500923633575,0.039852324873209,0.039542265236377716,0.03970605880022049,0.039393749088048935,0.0394999198615551,0.039461031556129456,0.039389774203300476,0.03921070322394371,0.03915375843644142,0.03934348002076149,0.03940457105636597,0.03954286873340607,0.03954184427857399,0.039483845233917236,0.03925475478172302,0.03935835510492325,0.03926254063844681,0.03928162157535553,0.03939395770430565,0.03902934491634369,0.03948872908949852,0.03977775573730469,0.03948124870657921,0.03917303308844566,0.03950069099664688,0.039691004902124405],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d5b3fa01-85c9-4fea-a695-e4f28c2e165a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-1" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-1">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 24ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm">Model 3 - LSTM</h3>
<section id="model-architecture-2" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-2">Model Architecture</h4>
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 3)                 60        
                                                                 
 dense_2 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-1">Plot training and validation loss</h4>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.034340642
0.029136106
Train MSE = 0.03434 RMSE = 0.18531
Test MSE = 0.02914 RMSE = 0.17069</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="3b5c10c4-6ca5-401a-b298-fdad5256d8d0" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3b5c10c4-6ca5-401a-b298-fdad5256d8d0")) {                    Plotly.newPlot(                        "3b5c10c4-6ca5-401a-b298-fdad5256d8d0",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.17394216358661652,0.16143226623535156,0.15276804566383362,0.14540430903434753,0.13878881931304932,0.13265717029571533,0.12692734599113464,0.12141455709934235,0.11619885265827179,0.1111443042755127,0.10634352266788483,0.10180629789829254,0.09743736684322357,0.09326978772878647,0.08946909755468369,0.08568217605352402,0.08205969631671906,0.0786624327301979,0.07551708072423935,0.07262811809778214,0.0698792114853859,0.06734933704137802,0.06503991037607193,0.06283263117074966,0.06080136448144913,0.059034042060375214,0.05746408551931381,0.055923424661159515,0.054719340056180954,0.05350463464856148,0.05250096321105957,0.05157806724309921,0.050882965326309204,0.05011985823512077,0.04952581971883774,0.04915054887533188,0.04893658682703972,0.048221539705991745,0.047830529510974884,0.04749061539769173,0.04712482914328575,0.0469546914100647,0.04682142660021782,0.046192266047000885,0.045906540006399155,0.045745182782411575,0.045370928943157196,0.045094434171915054,0.0447918176651001,0.04455553740262985,0.04436716064810753,0.04400993511080742,0.04371818155050278,0.043724723160266876,0.04346989840269089,0.04305948317050934,0.042985059320926666,0.04270965978503227,0.0424165204167366,0.04214060306549072,0.042059414088726044,0.041867945343256,0.041665393859148026,0.04136284068226814,0.04114476963877678,0.04093145206570625,0.04097830131649971,0.040565624833106995,0.040689196437597275,0.0402083583176136,0.04007808119058609,0.039898984134197235,0.03983933478593826,0.0395907461643219,0.0397062823176384,0.03935020789504051,0.0390595868229866,0.0390041247010231,0.03885774686932564,0.03874871879816055,0.03861517459154129,0.038456790149211884,0.03823474049568176,0.03813217952847481,0.03795243054628372,0.037839192897081375,0.037716809660196304,0.03783969208598137,0.03743842989206314,0.03733929246664047,0.03725346922874451,0.03711630031466484,0.037152934819459915,0.037036534398794174,0.037163831293582916,0.03674473613500595,0.03664027899503708,0.036479949951171875,0.03642873838543892,0.036519866436719894,0.03623431921005249,0.03626623749732971,0.03615409880876541,0.03605448082089424,0.035917602479457855,0.03585567697882652,0.03574889898300171,0.03573934733867645,0.03561233729124069,0.035492900758981705,0.035538408905267715,0.03546086326241493,0.03521671146154404,0.03521247208118439,0.0351933091878891,0.03524240851402283,0.03505244106054306,0.03515145555138588,0.034990422427654266,0.03492790833115578,0.03483835607767105,0.034846436232328415,0.03471573442220688,0.03471503034234047,0.03463902696967125,0.03460553660988808,0.034578196704387665,0.0344160720705986,0.034358538687229156,0.03446667641401291,0.034285083413124084,0.034245043992996216,0.03426037356257439,0.034368209540843964,0.03417158126831055,0.03424368053674698,0.03415057808160782,0.033977705985307693,0.034001559019088745,0.0343322828412056,0.03405926376581192,0.033933375030756,0.03396109491586685,0.0339539460837841,0.03391093760728836,0.03376806899905205,0.03373128920793533,0.03388800472021103,0.03385398909449577,0.03382446989417076,0.033731795847415924,0.03375367075204849,0.03369184583425522,0.0337955579161644,0.03352738171815872,0.033661484718322754,0.03357294946908951,0.03352569043636322,0.033501092344522476,0.03360166400671005,0.033596932888031006,0.033511728048324585,0.033530984073877335,0.03350171446800232,0.03339959681034088,0.03352661803364754,0.0333675742149353,0.03333904221653938,0.033492013812065125,0.03333938866853714,0.03347376734018326,0.03345325589179993,0.033261340111494064,0.03329746052622795,0.033477362245321274,0.033372946083545685,0.033487752079963684,0.033220916986465454,0.03340156748890877,0.03334157541394234,0.03340502828359604,0.033205293118953705,0.033349573612213135,0.03319261595606804,0.03342626243829727,0.033288098871707916,0.033389605581760406,0.03325886279344559,0.03324120491743088,0.03342210128903389,0.03325232118368149,0.03316470980644226,0.03316411003470421,0.0334126353263855,0.033309318125247955,0.03318808227777481,0.03316216915845871,0.03319733589887619,0.03319123387336731,0.03337240219116211],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.20166951417922974,0.1905777007341385,0.18140175938606262,0.17327487468719482,0.16567327082157135,0.1587694138288498,0.15200874209403992,0.14565575122833252,0.13948747515678406,0.1334599107503891,0.12788788974285126,0.12249390780925751,0.11730680614709854,0.11230788379907608,0.10773560404777527,0.10314012318849564,0.09877338260412216,0.09456348419189453,0.09077727049589157,0.08723200112581253,0.08379112929105759,0.08062952011823654,0.0776555985212326,0.07478697597980499,0.07222665101289749,0.06996865570545197,0.06775863468647003,0.06574998050928116,0.06404293328523636,0.062389589846134186,0.0609142892062664,0.05958801135420799,0.058458223938941956,0.05744236707687378,0.05644986778497696,0.05570093169808388,0.05524618551135063,0.054675959050655365,0.0540885366499424,0.05358022078871727,0.053177252411842346,0.052729710936546326,0.05247536674141884,0.05207193270325661,0.05173122510313988,0.05149468034505844,0.051188480108976364,0.05081004276871681,0.050447043031454086,0.05010044947266579,0.049830056726932526,0.049551405012607574,0.04934969171881676,0.04915616661310196,0.04893238842487335,0.04865307733416557,0.048475123941898346,0.04828600585460663,0.04811743274331093,0.04782986640930176,0.04768097773194313,0.047500550746917725,0.04725930839776993,0.04699065536260605,0.04675072059035301,0.0465463288128376,0.046403463929891586,0.04614610597491264,0.0460260733962059,0.04585761949419975,0.045709334313869476,0.045508064329624176,0.04536662623286247,0.04518001899123192,0.045091982930898666,0.04494629055261612,0.044716134667396545,0.04455335810780525,0.04447551816701889,0.044301245361566544,0.04418521001935005,0.04406549781560898,0.04391414299607277,0.0438346229493618,0.04367896169424057,0.043522536754608154,0.04336002841591835,0.04326252639293671,0.043108660727739334,0.04302753880620003,0.04289596900343895,0.04282214120030403,0.042677607387304306,0.04258330538868904,0.04258017614483833,0.0424000583589077,0.04233383759856224,0.04224075749516487,0.04209015890955925,0.04198078811168671,0.041935380548238754,0.041822969913482666,0.04169990122318268,0.04167885705828667,0.041640035808086395,0.041543107479810715,0.0414610356092453,0.041398435831069946,0.04135756567120552,0.04120343551039696,0.04114748537540436,0.04105829820036888,0.040963806211948395,0.04083049297332764,0.040776900947093964,0.04075745493173599,0.04064120724797249,0.04062133654952049,0.04055177792906761,0.04053977504372597,0.04048517718911171,0.04040883481502533,0.04028299078345299,0.04031091928482056,0.04022408276796341,0.04016263782978058,0.040138278156518936,0.04006854444742203,0.040013838559389114,0.040053535252809525,0.040038276463747025,0.03990555927157402,0.039875950664281845,0.03989303857088089,0.03979651629924774,0.03975094109773636,0.03976483643054962,0.039714690297842026,0.0396239198744297,0.039738066494464874,0.03972535580396652,0.03964896500110626,0.039570700377225876,0.039573412388563156,0.03957262262701988,0.03948301449418068,0.039385195821523666,0.03937336429953575,0.0393051914870739,0.03927309811115265,0.03929176554083824,0.03927963227033615,0.03924605995416641,0.039265554398298264,0.039202943444252014,0.0392223559319973,0.03928004205226898,0.039175912737846375,0.0392029732465744,0.03914349898695946,0.039150405675172806,0.039124008268117905,0.039065465331077576,0.03911840543150902,0.03905738517642021,0.03909076005220413,0.039085324853658676,0.03899398073554039,0.03899359330534935,0.039004646241664886,0.03902193158864975,0.03906705603003502,0.039064351469278336,0.039073482155799866,0.039067331701517105,0.03902411460876465,0.03902551531791687,0.0389833003282547,0.038976989686489105,0.0389539934694767,0.03890988603234291,0.03892434760928154,0.03895115479826927,0.038893070071935654,0.03893358260393143,0.03891123831272125,0.038900259882211685,0.03890489414334297,0.03895162418484688,0.03900726139545441,0.039002999663352966,0.03893597796559334,0.038891054689884186,0.03890877589583397,0.038915399461984634,0.038880471140146255,0.03882898762822151,0.038747239857912064,0.038816727697849274,0.03889474645256996],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3b5c10c4-6ca5-401a-b298-fdad5256d8d0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-2" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-2">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion">Discussion</h3>
<p>For predicting CO2 emissions from coal, the training RMSE are: <br> 1) RNN - 0.18039<br> 2) GRU - 0.18312<br> 3) LSTM - 0.18691<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.12964<br> 2) GRU - 0.19448<br> 3) LSTM - 0.14685<br></p>
<p>Thus, the RNN minimized RMSE for both training and validation predictions, while the GRU model overfit the data. Regularization is a technique used in ANNs to prevent overfitting and improve generalization performance. L2 regularization was used here, which adds a penalty term to the loss function that is proportional to the sum of the squares of the weights in the network. It was decently important here - without L2 regularization the test RMSE for RNN, GRU, and LSTM models were all over 0.2 which is much higher than their regularized RMSE above.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 3-4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,1)(0,1,2) forecast shared the same seasonality, but exhibited a downwards trend. The ANN models also exhibit a slight downward trend, but are far more consistent over time. The RNSE from the ARIMA model was 0.0433, significantly smaller than the ANN RMSE. With more model tuning the ANN could likely outperform the ARIMA model.</p>
</section>
</section>
<section id="hydro" class="level2">
<h2 class="anchored" data-anchor-id="hydro">Hydro</h2>
<section id="split-data-into-training-and-testing-data-1" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-1">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="8b0aca4d-bd52-4502-85f9-4d984758a8b0" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8b0aca4d-bd52-4502-85f9-4d984758a8b0")) {                    Plotly.newPlot(                        "8b0aca4d-bd52-4502-85f9-4d984758a8b0",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.29885026812553406,0.2489730417728424,0.16556856036186218,0.12283661961555481,0.10678568482398987,0.04782286286354065,0.04201275110244751,0.09250667691230774,0.09808856248855591,0.1636926233768463,0.21838590502738953,0.22443869709968567,0.9024785757064819,0.2506839334964752,0.18938997387886047,0.1598140299320221,0.1178608238697052,0.08518919348716736,0.06703010201454163,0.06937691569328308,0.08319929242134094,0.11958065629005432,0.16875723004341125,0.19355294108390808,0.23748359084129333,0.8911441564559937,0.24347230792045593,0.1764110028743744,0.1766255795955658,0.11801758408546448,0.023940861225128174,0.0,0.06503942608833313,0.08384457230567932,0.09752950072288513,0.13899245858192444,0.15380707383155823,0.24988004565238953,0.8763030767440796,0.27802249789237976,0.16880133748054504,0.1308991014957428,0.07858330011367798,0.05163422226905823,0.02947857975959778,0.04032200574874878,0.06777319312095642,0.06986865401268005,0.17186853289604187,0.22607818245887756,0.2764621675014496,0.8851343393325806,0.29293063282966614,0.24012932181358337,0.13521990180015564,0.06278383731842041,0.047756731510162354,0.05416986346244812,0.030391603708267212,0.05365148186683655,0.05917719006538391,0.13551560044288635,0.1731301248073578,0.24071797728538513,0.8799793720245361,0.26271381974220276,0.22440215945243835,0.1573067605495453,0.04815340042114258,0.0464307963848114,0.0258694589138031,0.02358230948448181,0.0258694589138031,0.07648852467536926,0.14729782938957214,0.16013166308403015,0.2171529233455658,0.8694477081298828,0.2789365351200104,0.24535128474235535,0.18194052577018738,0.1344793736934662,0.09708142280578613,0.07989251613616943,0.08137327432632446,0.11607840657234192,0.12994709610939026,0.1804618537425995,0.21486029028892517,0.23197802901268005,0.9110386371612549,0.28102824091911316,0.21632817387580872,0.19156035780906677,0.0771484375,0.11885222792625427,0.08278796076774597,0.04086410999298096,0.07564643025398254,0.11486658453941345,0.17278262972831726,0.15990480780601501,0.24721840023994446,0.8967489004135132,0.2673359215259552,0.20394757390022278,0.19286319613456726,0.10334828495979309,0.10263398289680481,0.08739763498306274,0.07804602384567261,0.07443934679031372,0.11796531081199646,0.18881401419639587,0.16521218419075012,0.2217596471309662,0.8963632583618164,0.2491748034954071,0.16645774245262146,0.18041953444480896,0.15297213196754456,0.11152169108390808,0.086760014295578,0.13219699263572693,0.10591647028923035,0.14677664637565613,0.16902145743370056,0.1915195882320404,0.2109486162662506,0.9015299081802368,0.23936590552330017,0.17399701476097107,0.12778118252754211,0.08548074960708618,0.06038424372673035,0.022071778774261475,0.07005280256271362,0.07864293456077576,0.13865146040916443,0.1446346938610077,0.16800746321678162,0.26657578349113464,0.8793326616287231,0.26492223143577576,0.18450012803077698,0.1770114004611969,0.11071977019309998,0.11676117777824402,0.09301844239234924,0.1112011969089508,0.14777091145515442,0.131448894739151,0.19111117720603943,0.19057950377464294,0.20241722464561462,0.9036329984664917,0.2620706260204315,0.19785836338996887,0.16972479224205017,0.08878397941589355,0.11952868103981018,0.11581537127494812,0.12483450770378113,0.11018392443656921,0.14729782938957214,0.21745231747627258,0.17923113703727722,0.26132920384407043,0.911162257194519,0.24501052498817444,0.18395647406578064,0.16409561038017273,0.09313204884529114,0.07395511865615845,0.04241713881492615,0.07552593946456909,0.10241386294364929,0.1461118757724762,0.21894463896751404,0.23251184821128845,0.25241830945014954,0.9005218744277954,0.25772491097450256,0.19460490345954895,0.18016526103019714,0.1356140673160553,0.08716589212417603,0.08878397941589355,0.12994709610939026,0.10575321316719055,0.1511082947254181,0.19669762253761292,0.18959537148475647,0.23800763487815857,0.9072870016098022,0.2867427170276642,0.2315146028995514,0.19399848580360413,0.09062251448631287,0.09741753339767456,0.07834464311599731,0.10948589444160461,0.1268698275089264,0.16928544640541077,0.20257452130317688,0.21175029873847961,0.26010021567344666,0.9187326431274414,0.2501482665538788,0.22843053936958313,0.20472928881645203,0.1328437626361847,0.0929616391658783,0.08646973967552185,0.08290553092956543,0.10064700245857239,0.14658686518669128,0.1920088827610016,0.2037126123905182,0.2817824184894562,0.9138333797454834,0.19569334387779236,0.17007586359977722,0.17199930548667908,0.14890322089195251,0.11497214436531067,0.033461183309555054,0.06572520732879639,0.09836772084236145,0.11502495408058167,0.17408356070518494,0.17438623309135437,0.2209475338459015,0.884419322013855,0.2721986472606659,0.1927413046360016,0.17914608120918274,0.12201306223869324,0.09090876579284668,0.08208143711090088,0.13408371806144714,0.10700264573097229,0.14247724413871765,0.16310957074165344,0.20543107390403748,0.23322215676307678,0.9052728414535522,0.2503826916217804,0.22904273867607117,0.19298502802848816,0.14214017987251282,0.1207217276096344,0.12082526087760925,0.12278518080711365,0.12605735659599304,0.11364981532096863,0.2037126123905182,0.24336948990821838,0.2827150523662567,0.9244997501373291,0.2531490623950958,0.231621652841568,0.2278170883655548,0.14430013298988342,0.11602577567100525,0.10070231556892395,0.1256503164768219,0.12242516875267029,0.15551599860191345,0.208530455827713,0.2340722382068634,0.25513288378715515,0.9260842800140381,0.3146684467792511,0.24511274695396423,0.20849189162254333,0.14843198657035828,0.12909266352653503,0.10781469941139221,0.14885613322257996,0.14876195788383484,0.16216525435447693,0.22407308220863342,0.21946516633033752,0.26856693625450134,0.9395542144775391,0.27188727259635925,0.241822749376297,0.20229914784431458,0.16813990473747253,0.16422978043556213,0.12580302357673645,0.11833086609840393,0.13870015740394592,0.17679712176322937,0.2048073709011078,0.2367483675479889,0.2858821451663971,0.938971996307373,0.31097647547721863,0.26812562346458435,0.2470153272151947,0.19525036215782166,0.17068925499916077,0.13908973336219788,0.1530650556087494,0.16994425654411316,0.1731301248073578,0.23509624600410461,0.2659091055393219,0.27160677313804626,0.961105227470398,0.3019636571407318,0.24677816033363342,0.2087615430355072,0.19270065426826477,0.159541517496109,0.14025554060935974,0.14544567465782166,0.16414031386375427,0.1922532021999359,0.2187958061695099,0.2554951608181,0.30367621779441833,0.9553632736206055,0.2667026221752167,0.21136882901191711,0.24168488383293152,0.17003199458122253,0.11649873852729797,0.10509923100471497,0.11375579237937927,0.14088508486747742,0.12964579463005066,0.19905439019203186,0.21391561627388,0.25374558568000793,0.9249790906906128,0.3226015865802765,0.23304471373558044,0.2756020128726959,0.19893500208854675,0.16328904032707214,0.17221710085868835,0.17795255780220032,0.18437477946281433,0.21662834286689758,0.2506839334964752,0.24592962861061096,0.3277064263820648,0.9752629995346069,0.34680870175361633,0.2844521701335907,0.25621840357780457,0.21262595057487488,0.17846468091011047,0.18996486067771912,0.18328604102134705,0.19549205899238586,0.1975385844707489,0.2409254014492035,0.2669244110584259,0.3541993796825409,0.9878349304199219,0.3216806948184967,0.2578555643558502,0.2509180009365082,0.19403895735740662,0.1418992578983307,0.12929394841194153,0.15315786004066467,0.16445335745811462,0.1848759949207306,0.24078711867332458,0.22734716534614563,0.2856442630290985,0.9579561948776245,0.3076527416706085,0.2831052839756012,0.27157559990882874,0.17395368218421936,0.17269566655158997,0.13908973336219788,0.1573983132839203,0.16565760970115662,0.15817531943321228,0.23176422715187073,0.2534143030643463,0.2934815585613251,0.9628491401672363,0.33264896273612976,0.28166189789772034,0.23953953385353088,0.19893500208854675,0.131498783826828,0.09803271293640137,0.1425253450870514,0.15129521489143372,0.1720864474773407,0.1971384584903717,0.2315146028995514,0.31775495409965515,0.9562051296234131,0.3248001039028168,0.29330769181251526,0.23315122723579407,0.1938365399837494,0.14410874247550964,0.15166863799095154,0.1509680449962616,0.1572152078151703,0.15413114428520203,0.20930024981498718,0.236362487077713,0.29961737990379333,0.9586451053619385,0.3143174946308136,0.2671143710613251,0.26216718554496765,0.157077819108963,0.15143534541130066,0.11639371514320374,0.1266668736934662,0.1815188229084015,0.12051460146903992,0.16337880492210388,0.19476637244224548,0.3066011965274811,0.9446557760238647,0.23919209837913513,0.24343803524971008,0.23286721110343933,0.13044849038124084,0.12488558888435364,0.13576176762580872,0.1262606680393219,0.15505507588386536,0.12061813473701477,0.20099756121635437,0.22046658396720886,0.2522519528865814,0.9258766174316406,0.29472461342811584,0.29426267743110657,0.22238567471504211,0.1815188229084015,0.12549754977226257,0.12324753403663635,0.12803378701210022,0.11791303753852844,0.16099193692207336,0.16765394806861877,0.20281031727790833,0.27633944153785706,0.9379569292068481,0.3047659695148468,0.27247855067253113,0.24524906277656555,0.14568379521369934,0.14852628111839294,0.12778118252754211,0.13669541478157043,0.15227457880973816,0.06478965282440186,0.19147875905036926,0.20987626910209656,0.24877110123634338,0.9345148801803589,0.2637080252170563,0.22275331616401672,0.2138020098209381,0.14358189702033997,0.08652782440185547,0.07804602384567261,0.10169735550880432,0.13124904036521912,0.1270219385623932,0.20721712708473206,0.25493505597114563,0.29882171750068665,0.9257174730300903,0.3002127707004547,0.2509180009365082,0.21045121550559998,0.12180683016777039,0.1053173840045929,0.08460530638694763,0.09562063217163086,0.11210843920707703,0.11162850260734558,0.15546998381614685,0.20316371321678162,0.2888687551021576,0.9192320108413696,0.26268163323402405,0.23491999506950378,0.19673773646354675,0.11900851130485535,0.0947180986404419,0.059813112020492554,0.0547519326210022,0.09027862548828125,0.09182286262512207,0.15616008639335632,0.20036444067955017,0.24694755673408508,0.8989995718002319,0.24562355875968933,0.19653716683387756,0.1432461440563202,0.1117885410785675,0.09646427631378174,0.05032545328140259,0.07900050282478333,0.09233585000038147,0.07522451877593994,0.16472139954566956,0.1913154423236847,0.23318663239479065],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.8862274885177612,0.2681886851787567,0.2285747230052948,0.23590591549873352,0.16026762127876282,0.10635140538215637,0.09696933627128601,0.07929813861846924,0.09443551301956177,0.13605692982673645,0.1709516942501068,0.23555412888526917,0.27722808718681335,0.9217337369918823,0.30856284499168396,0.2440885603427887,0.2207256257534027,0.14218834042549133,0.07995185256004333,0.10003718733787537,0.07989251613616943,0.1173376739025116,0.13329073786735535,0.1809273660182953,0.24012932181358337,0.2672410309314728,0.9252705574035645,0.290306955575943,0.26530465483665466,0.23477885127067566,0.15767279267311096,0.12340149283409119,0.1209804117679596,0.12575212121009827,0.14165809750556946,0.09533888101577759,0.17829403281211853,0.1863328516483307,0.2453853189945221,0.9264816045761108,0.28804370760917664,0.22864672541618347,0.20441684126853943,0.14857342839241028,0.1243235170841217,0.08658590912818909,0.10683992505073547,0.09130904078483582,0.1207217276096344,0.1734771430492401,0.18466725945472717,0.26660749316215515,0.9154360294342041,0.2872757017612457,0.19484713673591614,0.23147889971733093,0.16396132111549377,0.13393518328666687,0.08895683288574219,0.12722453474998474,0.09640812873840332,0.11958065629005432,0.17671135067939758,0.22454825043678284,0.28229424357414246,0.9240648746490479,0.33264896273612976,0.2604241669178009,0.2615227997303009,0.2060924470424652,0.13373705744743347,0.11018392443656921,0.15514734387397766,0.16472139954566956,0.16858097910881042,0.21655330061912537,0.2793925106525421,0.30837002396583557,0.9639747142791748,0.3571377694606781,0.3071273863315582,0.28430280089378357,0.2031244933605194,0.1824878752231598,0.16476604342460632,0.19025185704231262,0.18483421206474304,0.20253518223762512,0.2470153272151947,0.29452261328697205,0.323859840631485,0.9914212226867676,0.3059629499912262,0.26736751198768616,0.27954432368278503,0.17304328083992004,0.1824878752231598,0.1502188742160797,0.16449806094169617,0.18316015601158142,0.20441684126853943,0.2605859339237213,0.29345253109931946,0.36279115080833435,0.982427716255188,0.36982235312461853,0.283914178609848,0.28045371174812317,0.22702136635780334,0.22304710745811462,0.20300671458244324,0.21140697598457336,0.219725102186203,0.21033629775047302,0.23667821288108826,0.27802249789237976,0.3281966745853424,1.0,0.35781535506248474,0.3202808201313019,0.28102824091911316,0.25181904435157776,0.19525036215782166,0.2048073709011078,0.21942803263664246,0.21315762400627136,0.2171529233455658,0.27572503685951233,0.288456529378891,0.32001593708992004],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Hydro Power since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8b0aca4d-bd52-4502-85f9-4d984758a8b0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-1" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-1">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-display">

<div>                            <div id="12a392d3-d52e-454b-9f6c-dbaf50b7d8b7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("12a392d3-d52e-454b-9f6c-dbaf50b7d8b7")) {                    Plotly.newPlot(                        "12a392d3-d52e-454b-9f6c-dbaf50b7d8b7",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.2489730417728424,0.16556856036186218,0.12283661961555481,0.10678568482398987,0.04782286286354065,0.04201275110244751,0.09250667691230774,0.09808856248855591,0.1636926233768463],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.21838590502738953],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.22443869709968567,0.9024785757064819,0.2506839334964752,0.18938997387886047,0.1598140299320221,0.1178608238697052,0.08518919348716736,0.06703010201454163,0.06937691569328308],"type":"scatter"},{"x":[19],"y":[0.08319929242134094],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.11958065629005432,0.16875723004341125,0.19355294108390808,0.23748359084129333,0.8911441564559937,0.24347230792045593,0.1764110028743744,0.1766255795955658,0.11801758408546448],"type":"scatter"},{"x":[29],"y":[0.023940861225128174],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.0,0.06503942608833313,0.08384457230567932,0.09752950072288513,0.13899245858192444,0.15380707383155823,0.24988004565238953,0.8763030767440796,0.27802249789237976],"type":"scatter"},{"x":[39],"y":[0.16880133748054504],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.1308991014957428,0.07858330011367798,0.05163422226905823,0.02947857975959778,0.04032200574874878,0.06777319312095642,0.06986865401268005,0.17186853289604187,0.22607818245887756],"type":"scatter"},{"x":[49],"y":[0.2764621675014496],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8851343393325806,0.29293063282966614,0.24012932181358337,0.13521990180015564,0.06278383731842041,0.047756731510162354,0.05416986346244812,0.030391603708267212,0.05365148186683655],"type":"scatter"},{"x":[59],"y":[0.05917719006538391],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.13551560044288635,0.1731301248073578,0.24071797728538513,0.8799793720245361,0.26271381974220276,0.22440215945243835,0.1573067605495453,0.04815340042114258,0.0464307963848114],"type":"scatter"},{"x":[69],"y":[0.0258694589138031],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.02358230948448181,0.0258694589138031,0.07648852467536926,0.14729782938957214,0.16013166308403015,0.2171529233455658,0.8694477081298828,0.2789365351200104,0.24535128474235535],"type":"scatter"},{"x":[79],"y":[0.18194052577018738],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.1344793736934662,0.09708142280578613,0.07989251613616943,0.08137327432632446,0.11607840657234192,0.12994709610939026,0.1804618537425995,0.21486029028892517,0.23197802901268005],"type":"scatter"},{"x":[89],"y":[0.9110386371612549],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.28102824091911316,0.21632817387580872,0.19156035780906677,0.0771484375,0.11885222792625427,0.08278796076774597,0.04086410999298096,0.07564643025398254,0.11486658453941345],"type":"scatter"},{"x":[99],"y":[0.17278262972831726],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.15990480780601501,0.24721840023994446,0.8967489004135132,0.2673359215259552,0.20394757390022278,0.19286319613456726,0.10334828495979309,0.10263398289680481,0.08739763498306274],"type":"scatter"},{"x":[109],"y":[0.07804602384567261],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.07443934679031372,0.11796531081199646,0.18881401419639587,0.16521218419075012,0.2217596471309662,0.8963632583618164,0.2491748034954071,0.16645774245262146,0.18041953444480896],"type":"scatter"},{"x":[119],"y":[0.15297213196754456],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.11152169108390808,0.086760014295578,0.13219699263572693,0.10591647028923035,0.14677664637565613,0.16902145743370056,0.1915195882320404,0.2109486162662506,0.9015299081802368],"type":"scatter"},{"x":[129],"y":[0.23936590552330017],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.17399701476097107,0.12778118252754211,0.08548074960708618,0.06038424372673035,0.022071778774261475,0.07005280256271362,0.07864293456077576,0.13865146040916443,0.1446346938610077],"type":"scatter"},{"x":[139],"y":[0.16800746321678162],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.26657578349113464,0.8793326616287231,0.26492223143577576,0.18450012803077698,0.1770114004611969,0.11071977019309998,0.11676117777824402,0.09301844239234924,0.1112011969089508],"type":"scatter"},{"x":[149],"y":[0.14777091145515442],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.131448894739151,0.19111117720603943,0.19057950377464294,0.20241722464561462,0.9036329984664917,0.2620706260204315,0.19785836338996887,0.16972479224205017,0.08878397941589355],"type":"scatter"},{"x":[159],"y":[0.11952868103981018],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.11581537127494812,0.12483450770378113,0.11018392443656921,0.14729782938957214,0.21745231747627258,0.17923113703727722,0.26132920384407043,0.911162257194519,0.24501052498817444],"type":"scatter"},{"x":[169],"y":[0.18395647406578064],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.16409561038017273,0.09313204884529114,0.07395511865615845,0.04241713881492615,0.07552593946456909,0.10241386294364929,0.1461118757724762,0.21894463896751404,0.23251184821128845],"type":"scatter"},{"x":[179],"y":[0.25241830945014954],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.9005218744277954,0.25772491097450256,0.19460490345954895,0.18016526103019714,0.1356140673160553,0.08716589212417603,0.08878397941589355,0.12994709610939026,0.10575321316719055],"type":"scatter"},{"x":[189],"y":[0.1511082947254181],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.19669762253761292,0.18959537148475647,0.23800763487815857,0.9072870016098022,0.2867427170276642,0.2315146028995514,0.19399848580360413,0.09062251448631287,0.09741753339767456],"type":"scatter"},{"x":[199],"y":[0.07834464311599731],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.10948589444160461,0.1268698275089264,0.16928544640541077,0.20257452130317688,0.21175029873847961,0.26010021567344666,0.9187326431274414,0.2501482665538788,0.22843053936958313],"type":"scatter"},{"x":[209],"y":[0.20472928881645203],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.1328437626361847,0.0929616391658783,0.08646973967552185,0.08290553092956543,0.10064700245857239,0.14658686518669128,0.1920088827610016,0.2037126123905182,0.2817824184894562],"type":"scatter"},{"x":[219],"y":[0.9138333797454834],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.19569334387779236,0.17007586359977722,0.17199930548667908,0.14890322089195251,0.11497214436531067,0.033461183309555054,0.06572520732879639,0.09836772084236145,0.11502495408058167],"type":"scatter"},{"x":[229],"y":[0.17408356070518494],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.17438623309135437,0.2209475338459015,0.884419322013855,0.2721986472606659,0.1927413046360016,0.17914608120918274,0.12201306223869324,0.09090876579284668,0.08208143711090088],"type":"scatter"},{"x":[239],"y":[0.13408371806144714],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.10700264573097229,0.14247724413871765,0.16310957074165344,0.20543107390403748,0.23322215676307678,0.9052728414535522,0.2503826916217804,0.22904273867607117,0.19298502802848816],"type":"scatter"},{"x":[249],"y":[0.14214017987251282],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.1207217276096344,0.12082526087760925,0.12278518080711365,0.12605735659599304,0.11364981532096863,0.2037126123905182,0.24336948990821838,0.2827150523662567,0.9244997501373291],"type":"scatter"},{"x":[259],"y":[0.2531490623950958],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.231621652841568,0.2278170883655548,0.14430013298988342,0.11602577567100525,0.10070231556892395,0.1256503164768219,0.12242516875267029,0.15551599860191345,0.208530455827713],"type":"scatter"},{"x":[269],"y":[0.2340722382068634],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.25513288378715515,0.9260842800140381,0.3146684467792511,0.24511274695396423,0.20849189162254333,0.14843198657035828,0.12909266352653503,0.10781469941139221,0.14885613322257996],"type":"scatter"},{"x":[279],"y":[0.14876195788383484],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.16216525435447693,0.22407308220863342,0.21946516633033752,0.26856693625450134,0.9395542144775391,0.27188727259635925,0.241822749376297,0.20229914784431458,0.16813990473747253],"type":"scatter"},{"x":[289],"y":[0.16422978043556213],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.12580302357673645,0.11833086609840393,0.13870015740394592,0.17679712176322937,0.2048073709011078,0.2367483675479889,0.2858821451663971,0.938971996307373,0.31097647547721863],"type":"scatter"},{"x":[299],"y":[0.26812562346458435],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.2470153272151947,0.19525036215782166,0.17068925499916077,0.13908973336219788,0.1530650556087494,0.16994425654411316,0.1731301248073578,0.23509624600410461,0.2659091055393219],"type":"scatter"},{"x":[309],"y":[0.27160677313804626],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.961105227470398,0.3019636571407318,0.24677816033363342,0.2087615430355072,0.19270065426826477,0.159541517496109,0.14025554060935974,0.14544567465782166,0.16414031386375427],"type":"scatter"},{"x":[319],"y":[0.1922532021999359],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.2187958061695099,0.2554951608181,0.30367621779441833,0.9553632736206055,0.2667026221752167,0.21136882901191711,0.24168488383293152,0.17003199458122253,0.11649873852729797],"type":"scatter"},{"x":[329],"y":[0.10509923100471497],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.11375579237937927,0.14088508486747742,0.12964579463005066,0.19905439019203186,0.21391561627388,0.25374558568000793,0.9249790906906128,0.3226015865802765,0.23304471373558044],"type":"scatter"},{"x":[339],"y":[0.2756020128726959],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.19893500208854675,0.16328904032707214,0.17221710085868835,0.17795255780220032,0.18437477946281433,0.21662834286689758,0.2506839334964752,0.24592962861061096,0.3277064263820648],"type":"scatter"},{"x":[349],"y":[0.9752629995346069],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.34680870175361633,0.2844521701335907,0.25621840357780457,0.21262595057487488,0.17846468091011047,0.18996486067771912,0.18328604102134705,0.19549205899238586,0.1975385844707489],"type":"scatter"},{"x":[359],"y":[0.2409254014492035],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.2669244110584259,0.3541993796825409,0.9878349304199219,0.3216806948184967,0.2578555643558502,0.2509180009365082,0.19403895735740662,0.1418992578983307,0.12929394841194153],"type":"scatter"},{"x":[369],"y":[0.15315786004066467],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.16445335745811462,0.1848759949207306,0.24078711867332458,0.22734716534614563,0.2856442630290985,0.9579561948776245,0.3076527416706085,0.2831052839756012,0.27157559990882874],"type":"scatter"},{"x":[379],"y":[0.17395368218421936],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.17269566655158997,0.13908973336219788,0.1573983132839203,0.16565760970115662,0.15817531943321228,0.23176422715187073,0.2534143030643463,0.2934815585613251,0.9628491401672363],"type":"scatter"},{"x":[389],"y":[0.33264896273612976],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.28166189789772034,0.23953953385353088,0.19893500208854675,0.131498783826828,0.09803271293640137,0.1425253450870514,0.15129521489143372,0.1720864474773407,0.1971384584903717],"type":"scatter"},{"x":[399],"y":[0.2315146028995514],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.31775495409965515,0.9562051296234131,0.3248001039028168,0.29330769181251526,0.23315122723579407,0.1938365399837494,0.14410874247550964,0.15166863799095154,0.1509680449962616],"type":"scatter"},{"x":[409],"y":[0.1572152078151703],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.15413114428520203,0.20930024981498718,0.236362487077713,0.29961737990379333,0.9586451053619385,0.3143174946308136,0.2671143710613251,0.26216718554496765,0.157077819108963],"type":"scatter"},{"x":[419],"y":[0.15143534541130066],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.11639371514320374,0.1266668736934662,0.1815188229084015,0.12051460146903992,0.16337880492210388,0.19476637244224548,0.3066011965274811,0.9446557760238647,0.23919209837913513],"type":"scatter"},{"x":[429],"y":[0.24343803524971008],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.23286721110343933,0.13044849038124084,0.12488558888435364,0.13576176762580872,0.1262606680393219,0.15505507588386536,0.12061813473701477,0.20099756121635437,0.22046658396720886],"type":"scatter"},{"x":[439],"y":[0.2522519528865814],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9258766174316406,0.29472461342811584,0.29426267743110657,0.22238567471504211,0.1815188229084015,0.12549754977226257,0.12324753403663635,0.12803378701210022,0.11791303753852844],"type":"scatter"},{"x":[449],"y":[0.16099193692207336],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.16765394806861877,0.20281031727790833,0.27633944153785706,0.9379569292068481,0.3047659695148468,0.27247855067253113,0.24524906277656555,0.14568379521369934,0.14852628111839294],"type":"scatter"},{"x":[459],"y":[0.12778118252754211],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.13669541478157043,0.15227457880973816,0.06478965282440186,0.19147875905036926,0.20987626910209656,0.24877110123634338,0.9345148801803589,0.2637080252170563,0.22275331616401672],"type":"scatter"},{"x":[469],"y":[0.2138020098209381],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.14358189702033997,0.08652782440185547,0.07804602384567261,0.10169735550880432,0.13124904036521912,0.1270219385623932,0.20721712708473206,0.25493505597114563,0.29882171750068665],"type":"scatter"},{"x":[479],"y":[0.9257174730300903],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3002127707004547,0.2509180009365082,0.21045121550559998,0.12180683016777039,0.1053173840045929,0.08460530638694763,0.09562063217163086,0.11210843920707703,0.11162850260734558],"type":"scatter"},{"x":[489],"y":[0.15546998381614685],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.20316371321678162,0.2888687551021576,0.9192320108413696,0.26268163323402405,0.23491999506950378,0.19673773646354675,0.11900851130485535,0.0947180986404419,0.059813112020492554],"type":"scatter"},{"x":[499],"y":[0.0547519326210022],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.09027862548828125,0.09182286262512207,0.15616008639335632,0.20036444067955017,0.24694755673408508,0.8989995718002319,0.24562355875968933,0.19653716683387756,0.1432461440563202],"type":"scatter"},{"x":[509],"y":[0.1117885410785675],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from HydroPower since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('12a392d3-d52e-454b-9f6c-dbaf50b7d8b7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-1">Model 1 = RNN</h3>
<section id="model-architecture-3" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-3">Model architecture</h4>
<div class="cell" data-execution_count="26">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_1 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_3 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-1">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="28">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 21ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.0420848
0.009427733
Train MSE = 0.04208 RMSE = 0.20515
Test MSE = 0.00943 RMSE = 0.09710</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="e6033566-13e3-4a15-801c-d50544076052" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e6033566-13e3-4a15-801c-d50544076052")) {                    Plotly.newPlot(                        "e6033566-13e3-4a15-801c-d50544076052",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.14766517281532288,0.14252886176109314,0.13853760063648224,0.1352854073047638,0.13232919573783875,0.12950702011585236,0.12749850749969482,0.12528850138187408,0.12301268428564072,0.12093037366867065,0.1190686970949173,0.1170470267534256,0.1154266968369484,0.11370120197534561,0.11240056902170181,0.11076593399047852,0.10950212180614471,0.10815978050231934,0.10684146732091904,0.10545293986797333,0.1041574478149414,0.10283110290765762,0.10148058086633682,0.10057570785284042,0.09902091324329376,0.09803126007318497,0.09665444493293762,0.09565757215023041,0.09454353898763657,0.09357653558254242,0.09245670586824417,0.09155382961034775,0.09063490480184555,0.08982740342617035,0.08882863819599152,0.08786646276712418,0.0873488038778305,0.08633218705654144,0.08546306937932968,0.08471636474132538,0.08406965434551239,0.08326417952775955,0.08246877044439316,0.08171173185110092,0.0809745043516159,0.08034203201532364,0.07973390817642212,0.07904116809368134,0.0785517767071724,0.0778254047036171,0.07740174978971481,0.07652680575847626,0.07594385743141174,0.07555153220891953,0.07485931366682053,0.07429449260234833,0.07382016628980637,0.07324932515621185,0.0728037878870964,0.07242066413164139,0.0719100832939148,0.071589395403862,0.07104773074388504,0.07094578444957733,0.0704011470079422,0.06987951695919037,0.06949791312217712,0.06926881521940231,0.06889300793409348,0.06838272511959076,0.06806491315364838,0.0678711086511612,0.06716860830783844,0.06685914844274521,0.0666479617357254,0.06620302051305771,0.06579077243804932,0.06545519828796387,0.06516046822071075,0.06472693383693695,0.06436566263437271,0.06416378170251846,0.06383831799030304,0.06331262737512589,0.06309370696544647,0.06270737946033478,0.06246801093220711,0.06206561252474785,0.0617070198059082,0.06170047074556351,0.06119298189878464,0.06096630170941353,0.06058036535978317,0.06032062694430351,0.06007806211709976,0.05967070907354355,0.059385545551776886,0.05903968960046768,0.05888786166906357,0.05864417552947998,0.0581522099673748,0.05791248008608818,0.05787692219018936,0.05746178701519966,0.05712861940264702,0.056796468794345856,0.056701648980379105,0.05624287575483322,0.05623733997344971,0.055718906223773956,0.055725596845149994,0.055251192301511765,0.054970383644104004,0.05483890697360039,0.05444962903857231,0.05425826460123062,0.05411888286471367,0.05367470905184746,0.0534602515399456,0.053555864840745926,0.05301535129547119,0.052815139293670654,0.05257134512066841,0.05234634876251221,0.05210190266370773,0.05203879624605179,0.05179125815629959,0.05176655203104019,0.051293063908815384,0.05139228701591492,0.05093323066830635,0.05079758167266846,0.050678156316280365,0.05071376636624336,0.05023137480020523,0.05014414340257645,0.04999614879488945,0.04986095428466797,0.04961070418357849,0.04955202341079712,0.04923318699002266,0.049244001507759094,0.049028024077415466,0.048913467675447464,0.04871654510498047,0.04847927764058113,0.048320185393095016,0.04820965975522995,0.04797873646020889,0.04791239649057388,0.04774898290634155,0.04770929366350174,0.047420673072338104,0.04726257175207138,0.047115154564380646,0.047322098165750504,0.04700262099504471,0.04678134620189667,0.04670270159840584,0.04656711220741272,0.04654981568455696,0.04631873220205307,0.04621341452002525,0.04602861404418945,0.04605838283896446,0.04582751542329788,0.04584302753210068,0.04568205773830414,0.045475833117961884,0.04547204077243805,0.04529319331049919,0.04537484794855118,0.04516378417611122,0.04498850926756859,0.04489309713244438,0.04480845853686333,0.04473159834742546,0.04462379962205887,0.04461809992790222,0.044470660388469696,0.04452486336231232,0.04420091584324837,0.0441385842859745,0.04431843012571335,0.04402434453368187,0.043913744390010834,0.043941739946603775,0.04376927763223648,0.04374007508158684,0.043724678456783295,0.043530531227588654,0.043472934514284134,0.04347703605890274,0.043267495930194855,0.04352032020688057,0.04329223185777664,0.043182872235774994,0.04309120774269104,0.0430966392159462,0.04296130686998367],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.13061262667179108,0.12516236305236816,0.12053890526294708,0.11631050705909729,0.11279470473527908,0.10953081399202347,0.10656296461820602,0.10364101082086563,0.10103829205036163,0.09870972484350204,0.09650666266679764,0.09459442645311356,0.092891164124012,0.09120050072669983,0.08959858119487762,0.08804791420698166,0.08664798736572266,0.08532179147005081,0.08398500084877014,0.0827135518193245,0.08142343163490295,0.08009058982133865,0.07877372950315475,0.07761263847351074,0.07642675191164017,0.0753306970000267,0.07426004111766815,0.07330168038606644,0.07234211266040802,0.07142717391252518,0.07054583728313446,0.06975042074918747,0.0689738467335701,0.06829775869846344,0.06765037029981613,0.0669374167919159,0.06631802022457123,0.06568215042352676,0.06504923105239868,0.06442447006702423,0.06377951055765152,0.06317942589521408,0.06260627508163452,0.06208951398730278,0.06155550852417946,0.06101858243346214,0.06050095707178116,0.06002844497561455,0.05960286036133766,0.05920616537332535,0.058803752064704895,0.05838976800441742,0.05801241472363472,0.05769316107034683,0.05734139680862427,0.05697024241089821,0.05665895715355873,0.05634475126862526,0.056082967668771744,0.05579826608300209,0.05558675900101662,0.05541905388236046,0.0551958829164505,0.05498620122671127,0.054735418409109116,0.05451998859643936,0.05432175099849701,0.054175976663827896,0.053974542766809464,0.05379832908511162,0.05362442508339882,0.05339048057794571,0.05317150428891182,0.05293408781290054,0.05272679030895233,0.05250509828329086,0.05227231606841087,0.05204075202345848,0.05183682218194008,0.05158257484436035,0.05137481912970543,0.05113541707396507,0.05089348927140236,0.050729379057884216,0.05051633343100548,0.05031329765915871,0.050112273544073105,0.04996122419834137,0.04977760463953018,0.04959092289209366,0.0494597889482975,0.04929638281464577,0.04916392266750336,0.04900829866528511,0.04885173961520195,0.04870717227458954,0.04857217147946358,0.04841966927051544,0.048317812383174896,0.04814646393060684,0.04804252088069916,0.04788712412118912,0.04774972423911095,0.04761195182800293,0.04745541885495186,0.04731191694736481,0.047161731868982315,0.04702764376997948,0.04688610881567001,0.04676870256662369,0.04663897678256035,0.04653625562787056,0.046387575566768646,0.046290937811136246,0.046180322766304016,0.046057842671871185,0.045953039079904556,0.04583773389458656,0.04569244757294655,0.04553169012069702,0.045405853539705276,0.04531372711062431,0.04518897458910942,0.04512018710374832,0.045016948133707047,0.04485413432121277,0.04478118568658829,0.0446646548807621,0.0445779412984848,0.04450739175081253,0.04442872107028961,0.044353049248456955,0.04427779093384743,0.04424717649817467,0.04420064762234688,0.044139109551906586,0.04401290789246559,0.04392579197883606,0.04381628707051277,0.04374571144580841,0.04365666210651398,0.0435812771320343,0.04348091408610344,0.043437011539936066,0.04333335906267166,0.043224334716796875,0.0431644581258297,0.04306839033961296,0.04298771172761917,0.042903218418359756,0.04279482364654541,0.04271623119711876,0.0426425077021122,0.04258493334054947,0.04249170795083046,0.04248356446623802,0.04243141785264015,0.04236796125769615,0.0422857441008091,0.04222261533141136,0.042151015251874924,0.042109183967113495,0.04208878427743912,0.04202638566493988,0.04198460280895233,0.04193054512143135,0.04183764010667801,0.04181041941046715,0.041745081543922424,0.041685160249471664,0.04161021485924721,0.04158573970198631,0.04152802750468254,0.04151442274451256,0.04149023815989494,0.041419535875320435,0.04138763248920441,0.04134824499487877,0.041348639875650406,0.04132511094212532,0.04130681976675987,0.04128072038292885,0.04124433547258377,0.04120716080069542,0.041202399879693985,0.04116223379969597,0.041161421686410904,0.041187725961208344,0.04115843400359154,0.04115086793899536,0.04114258289337158,0.04113147780299187,0.041087739169597626,0.04110616818070412,0.04110780730843544,0.041121914982795715,0.04112071171402931,0.04111839085817337,0.04108443111181259,0.041035689413547516],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e6033566-13e3-4a15-801c-d50544076052');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-3" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-3">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-1" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-1">Model 2 - GRU</h3>
<section id="model-architecture-4" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-4">Model Architecture</h4>
<div class="cell" data-execution_count="30">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_1 (GRU)                 (None, 3)                 54        
                                                                 
 dense_4 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-2" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-2">Plot training and validation loss</h4>
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.039451856
0.0008718489
Train MSE = 0.03945 RMSE = 0.19862
Test MSE = 0.00087 RMSE = 0.02953</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="55a6818f-cfa9-4b54-930f-5b470f0544db" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("55a6818f-cfa9-4b54-930f-5b470f0544db")) {                    Plotly.newPlot(                        "55a6818f-cfa9-4b54-930f-5b470f0544db",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.09922490268945694,0.09121832996606827,0.08618838340044022,0.08230434358119965,0.07911840826272964,0.07647658884525299,0.07417236268520355,0.07213115692138672,0.07049521058797836,0.06894461065530777,0.06768592447042465,0.06637577712535858,0.06550368666648865,0.06468557566404343,0.06371549516916275,0.06315390765666962,0.06254544854164124,0.06200335547327995,0.06142284721136093,0.06093468517065048,0.06068744510412216,0.0600082091987133,0.059770435094833374,0.059122998267412186,0.05892007797956467,0.058552660048007965,0.05812004208564758,0.05775132030248642,0.057303763926029205,0.057164810597896576,0.05648099258542061,0.0562642440199852,0.05599658563733101,0.05556203052401543,0.055282823741436005,0.054894424974918365,0.05448583886027336,0.05418834090232849,0.05399283766746521,0.053816817700862885,0.05338957905769348,0.05315893143415451,0.0527648851275444,0.05239715427160263,0.05224693939089775,0.051850028336048126,0.05157395079731941,0.051511503756046295,0.05111462622880936,0.05088459327816963,0.05082279443740845,0.05031570792198181,0.05031580850481987,0.05006520077586174,0.04983146861195564,0.049459539353847504,0.049549076706171036,0.049113791435956955,0.04879720136523247,0.04892232269048691,0.04860232397913933,0.04827092960476875,0.04819529131054878,0.047992683947086334,0.04779765009880066,0.04759550094604492,0.04735564440488815,0.0473032183945179,0.04727482050657272,0.046978700906038284,0.046719688922166824,0.046491336077451706,0.04652581363916397,0.046346940100193024,0.046297021210193634,0.04606480523943901,0.04600595682859421,0.0457037128508091,0.04567878693342209,0.04538390785455704,0.04525356739759445,0.045444466173648834,0.04515830799937248,0.04512374848127365,0.04499595984816551,0.04478393867611885,0.044777583330869675,0.0446530357003212,0.04451664164662361,0.04449830204248428,0.04413224011659622,0.04405675083398819,0.04403921589255333,0.04408548027276993,0.043971773236989975,0.04381609708070755,0.04360557720065117,0.04349740967154503,0.04354231432080269,0.043504707515239716,0.04324321448802948,0.04330941289663315,0.042990945279598236,0.04313390329480171,0.04282715171575546,0.04293886944651604,0.04274705797433853,0.04289867728948593,0.0426262691617012,0.04270077869296074,0.04255889728665352,0.042362432926893234,0.04230208694934845,0.04247631877660751,0.04217364639043808,0.04215994104743004,0.042355384677648544,0.041964415460824966,0.0419294498860836,0.04184134304523468,0.04196053743362427,0.04184935241937637,0.04187489673495293,0.041628967970609665,0.041762273758649826,0.041567474603652954,0.041430044919252396,0.0414879247546196,0.041510067880153656,0.04146725684404373,0.041362352669239044,0.0411493182182312,0.04138784110546112,0.041272666305303574,0.040997885167598724,0.040998250246047974,0.041241638362407684,0.04119349271059036,0.04083918407559395,0.04102051258087158,0.04084466025233269,0.040731899440288544,0.04066887125372887,0.040876537561416626,0.04079534485936165,0.040586475282907486,0.04059641808271408,0.040789276361465454,0.04057646915316582,0.04050968214869499,0.040439676493406296,0.04042923450469971,0.04058904945850372,0.04042542725801468,0.04034309834241867,0.04024291783571243,0.04020066186785698,0.04015976935625076,0.04043058305978775,0.04038270190358162,0.04006784409284592,0.040032900869846344,0.04036705195903778,0.0399918332695961,0.040042389184236526,0.040039487183094025,0.039998311549425125,0.03991647809743881,0.04001079872250557,0.040136829018592834,0.03977929428219795,0.03972591459751129,0.03979289531707764,0.03989375755190849,0.03966832160949707,0.039726775139570236,0.03985912352800369,0.03963036090135574,0.039861924946308136,0.03972310200333595,0.03977398946881294,0.03953620046377182,0.039493128657341,0.03971925377845764,0.039484262466430664,0.03940780460834503,0.03959266096353531,0.03936604782938957,0.03950654715299606,0.0392904132604599,0.039638057351112366,0.03929673880338669,0.039485834538936615,0.03944390267133713,0.039763856679201126,0.03972887620329857,0.03930177539587021,0.039245568215847015,0.03929907828569412,0.039138879626989365],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.10068649798631668,0.09482729434967041,0.09041441231966019,0.08679629117250443,0.08387844264507294,0.08122071623802185,0.07900219410657883,0.07697582989931107,0.07531097531318665,0.07368379086256027,0.07234609872102737,0.07109937071800232,0.0700092688202858,0.06910820305347443,0.06828251481056213,0.06755872815847397,0.06690686196088791,0.06630624085664749,0.06572901457548141,0.06520434468984604,0.06472530961036682,0.06421183794736862,0.06376492232084274,0.06330974400043488,0.06287708133459091,0.062457259744405746,0.062045808881521225,0.06166374310851097,0.06127823516726494,0.06092604622244835,0.06054181978106499,0.060184892266988754,0.05982842668890953,0.05947547033429146,0.05913281440734863,0.05881601199507713,0.05846457555890083,0.05811029300093651,0.057813551276922226,0.05750615894794464,0.057203058153390884,0.05690566450357437,0.05660521984100342,0.05631260573863983,0.056027043610811234,0.055746279656887054,0.05545924976468086,0.05518072843551636,0.05488787591457367,0.054622720927000046,0.05437934026122093,0.05412645265460014,0.05389665067195892,0.053682055324316025,0.05346184968948364,0.05322840064764023,0.05301322788000107,0.052793122828006744,0.05258352681994438,0.0523749478161335,0.05216677114367485,0.05194595083594322,0.05176534503698349,0.05158046633005142,0.051384612917900085,0.051208678632974625,0.05102134123444557,0.05087058246135712,0.05072531849145889,0.05055827274918556,0.050383806228637695,0.050238002091646194,0.05008191242814064,0.04992268234491348,0.049764107912778854,0.04963156208395958,0.04948365315794945,0.04934094846248627,0.04919084534049034,0.0490650050342083,0.048914313316345215,0.04880267381668091,0.04868040978908539,0.0485478974878788,0.04844660684466362,0.04831801354885101,0.048213887959718704,0.04808560386300087,0.04795645549893379,0.0478537417948246,0.04775061458349228,0.04764774814248085,0.04755761846899986,0.04745600372552872,0.047354117035865784,0.047236524522304535,0.04713807255029678,0.04702926054596901,0.046937309205532074,0.046837612986564636,0.04672585427761078,0.046650610864162445,0.04654360190033913,0.04645471274852753,0.04638620838522911,0.04630228504538536,0.046228837221860886,0.046153660863637924,0.046069011092185974,0.045996010303497314,0.04591727629303932,0.04581637680530548,0.04572589322924614,0.045666906982660294,0.04561726748943329,0.04555460438132286,0.04546717554330826,0.04540726915001869,0.04534302279353142,0.04525698348879814,0.045206934213638306,0.045142725110054016,0.045092999935150146,0.04502405971288681,0.04497068375349045,0.044890034943819046,0.04485851526260376,0.04481682926416397,0.04476755112409592,0.044708091765642166,0.044625941663980484,0.044551268219947815,0.04449133574962616,0.04445471987128258,0.04441426321864128,0.04436374455690384,0.04431770369410515,0.0442904494702816,0.04421679675579071,0.0441812165081501,0.04410405829548836,0.044028397649526596,0.04399385675787926,0.04396698623895645,0.043944891542196274,0.0438816212117672,0.04380986467003822,0.0437806136906147,0.04377327486872673,0.043698955327272415,0.043659985065460205,0.04364774003624916,0.04363376647233963,0.04358305409550667,0.04354269802570343,0.043525975197553635,0.043490249663591385,0.04341829940676689,0.043406009674072266,0.04337877035140991,0.04331625998020172,0.04327726736664772,0.04326462373137474,0.043190546333789825,0.04312880337238312,0.04312772676348686,0.043076153844594955,0.043064530938863754,0.04307496175169945,0.04304744675755501,0.043001044541597366,0.042961958795785904,0.04292360320687294,0.0428367555141449,0.0428365096449852,0.042787909507751465,0.04275823011994362,0.04275212809443474,0.04273330792784691,0.04271410405635834,0.04270479455590248,0.04265095666050911,0.04261774569749832,0.0426020585000515,0.04253441095352173,0.04246845468878746,0.04244963079690933,0.04239640012383461,0.04241247475147247,0.04241257533431053,0.04241160303354263,0.04234602302312851,0.04235437884926796,0.04230545461177826,0.04234414920210838,0.04235496371984482,0.0423177033662796,0.04228894039988518,0.04223035275936127,0.04217856749892235],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('55a6818f-cfa9-4b54-930f-5b470f0544db');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-4" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-4">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="33">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-1" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-1">Model 3 - LSTM</h3>
<section id="model-architecture-5" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-5">Model Architecture</h4>
<div class="cell" data-execution_count="34">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_1 (LSTM)               (None, 3)                 60        
                                                                 
 dense_5 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-3" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-3">Plot training and validation loss</h4>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03453453
0.0061190366
Train MSE = 0.03453 RMSE = 0.18583
Test MSE = 0.00612 RMSE = 0.07822</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="b1881180-d610-4a22-bd94-544c4bfdcf62" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b1881180-d610-4a22-bd94-544c4bfdcf62")) {                    Plotly.newPlot(                        "b1881180-d610-4a22-bd94-544c4bfdcf62",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.12825992703437805,0.11496677249670029,0.10700744390487671,0.10072167217731476,0.09540875256061554,0.09087328612804413,0.08676745742559433,0.08311372250318527,0.08004561811685562,0.07720853388309479,0.07483792304992676,0.07272480428218842,0.07090439647436142,0.0697033479809761,0.0681147426366806,0.0670829564332962,0.06609980016946793,0.06507761776447296,0.06432251632213593,0.06366364657878876,0.0630614310503006,0.062447261065244675,0.0620301179587841,0.061600737273693085,0.06104382127523422,0.060545723885297775,0.060387641191482544,0.059483736753463745,0.059100162237882614,0.05873889848589897,0.05819667503237724,0.05783568695187569,0.057445984333753586,0.05713670328259468,0.056735895574092865,0.056148599833250046,0.055872976779937744,0.05545772239565849,0.05512125417590141,0.05482661724090576,0.054503489285707474,0.054057586938142776,0.05365772172808647,0.05355352163314819,0.05312283709645271,0.05257565528154373,0.05240827053785324,0.05215413123369217,0.0516323521733284,0.05159863829612732,0.051338523626327515,0.051040805876255035,0.05060674622654915,0.05072365328669548,0.05010601133108139,0.04984317347407341,0.049408577382564545,0.04940167814493179,0.049135446548461914,0.048775285482406616,0.04853510484099388,0.04831823334097862,0.04826701432466507,0.047939516603946686,0.048051439225673676,0.04747548699378967,0.047330815345048904,0.04702513664960861,0.04685899615287781,0.04668557643890381,0.04653843119740486,0.046217180788517,0.046329282224178314,0.045805566012859344,0.0459040105342865,0.04561403766274452,0.045310329645872116,0.045169003307819366,0.04527276009321213,0.04510752856731415,0.044648729264736176,0.04481363669037819,0.044340115040540695,0.044266246259212494,0.044336069375276566,0.04415470361709595,0.0438125841319561,0.043742574751377106,0.043815504759550095,0.04357496649026871,0.04350857809185982,0.043320927768945694,0.04332001507282257,0.04311755299568176,0.043058644980192184,0.042698271572589874,0.0426032729446888,0.042660318315029144,0.04242592304944992,0.04238560050725937,0.04213022440671921,0.042311303317546844,0.042049340903759,0.04199918732047081,0.042409565299749374,0.04193485528230667,0.041658222675323486,0.04162517189979553,0.04144947975873947,0.041390273720026016,0.041231878101825714,0.04119684174656868,0.041331946849823,0.04163927957415581,0.040929753333330154,0.04085683077573776,0.04101487249135971,0.040657125413417816,0.04067279025912285,0.040693752467632294,0.040815867483615875,0.04043500870466232,0.04062662646174431,0.040263380855321884,0.040473926812410355,0.04023294895887375,0.0402740016579628,0.04017204791307449,0.040016669780015945,0.04063040763139725,0.04002881795167923,0.039783772081136703,0.039767663925886154,0.03961098939180374,0.039743952453136444,0.03973415493965149,0.0396311990916729,0.03936639800667763,0.04011799767613411,0.03943775221705437,0.03918212279677391,0.03959966450929642,0.03925711289048195,0.039442598819732666,0.03949543833732605,0.03889307379722595,0.03883803263306618,0.03917085379362106,0.03886274993419647,0.03903757035732269,0.03864322230219841,0.038869328796863556,0.03913833573460579,0.03852107748389244,0.038461435586214066,0.03838729485869408,0.03837202861905098,0.03825003281235695,0.03851742297410965,0.03818262368440628,0.038529664278030396,0.03834296017885208,0.03867010772228241,0.03809593990445137,0.038142841309309006,0.03814546391367912,0.03811964392662048,0.038061849772930145,0.037775926291942596,0.03794702887535095,0.03793161362409592,0.037816353142261505,0.03762384131550789,0.0377097986638546,0.03775641322135925,0.03842731565237045,0.0376070961356163,0.03743467852473259,0.03730928152799606,0.03736026957631111,0.03722869232296944,0.037596285343170166,0.03740329295396805,0.03741608187556267,0.03714941069483757,0.03731166571378708,0.03702862560749054,0.03718884289264679,0.037180665880441666,0.03698066622018814,0.037378642708063126,0.0367705300450325,0.036777760833501816,0.03677854686975479,0.03677356243133545,0.03673689439892769,0.03674152493476868,0.036939918994903564,0.03663479909300804,0.037112295627593994],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.1256188452243805,0.1165393590927124,0.10977675765752792,0.1039387658238411,0.09919460117816925,0.09493028372526169,0.09105642139911652,0.08780359476804733,0.08483129739761353,0.08224484324455261,0.07998358458280563,0.07820233702659607,0.07646243274211884,0.07513804733753204,0.07404391467571259,0.0730004534125328,0.07208387553691864,0.071245476603508,0.07051075249910355,0.0698091983795166,0.06916177272796631,0.06857521086931229,0.06804636120796204,0.06755024939775467,0.0670696571469307,0.06658376008272171,0.06613657623529434,0.06566758453845978,0.06520212441682816,0.06475066393613815,0.06429677456617355,0.06384751200675964,0.06340810656547546,0.0629836767911911,0.06257332861423492,0.062153879553079605,0.06174005568027496,0.06133284419775009,0.06093432754278183,0.06054683029651642,0.06017102301120758,0.059810638427734375,0.05944368988275528,0.05909473076462746,0.058752600103616714,0.05840964615345001,0.05807047709822655,0.05773615837097168,0.05739957094192505,0.05707728862762451,0.056773506104946136,0.05646946281194687,0.05617166683077812,0.055903445929288864,0.055617526173591614,0.05533573403954506,0.0550534762442112,0.05477380380034447,0.05449945107102394,0.05422858148813248,0.05396154895424843,0.05370035395026207,0.053445231169462204,0.05319143831729889,0.05297401174902916,0.05274483934044838,0.052512336522340775,0.052270397543907166,0.05204719305038452,0.05182014778256416,0.05160379782319069,0.051379311829805374,0.05118587240576744,0.05097900331020355,0.05079115927219391,0.05059243366122246,0.05038609355688095,0.050194334238767624,0.05001655966043472,0.04984118044376373,0.049659159034490585,0.049495890736579895,0.04932007938623428,0.049103785306215286,0.048955921083688736,0.048775311559438705,0.04859315976500511,0.048415955156087875,0.048263195902109146,0.048101309686899185,0.04794278368353844,0.04777313768863678,0.04761694744229317,0.04746667295694351,0.04732880741357803,0.047173403203487396,0.04703294858336449,0.04691379889845848,0.04676598682999611,0.04662178456783295,0.04642808437347412,0.046289026737213135,0.046131595969200134,0.04601316154003143,0.04594961553812027,0.045818328857421875,0.04569189250469208,0.04559417814016342,0.045463696122169495,0.04529029503464699,0.045101772993803024,0.04493172839283943,0.044847309589385986,0.04480188339948654,0.04468073695898056,0.04457050561904907,0.04443442448973656,0.044322703033685684,0.04413306713104248,0.04405932128429413,0.04395900294184685,0.043844275176525116,0.04372706636786461,0.043618980795145035,0.04350801184773445,0.04336606338620186,0.04327072948217392,0.04317711666226387,0.04308314621448517,0.04306308180093765,0.04300680384039879,0.04288777336478233,0.042757462710142136,0.04258916899561882,0.04247795045375824,0.0423598550260067,0.04223841056227684,0.042067915201187134,0.042089857161045074,0.04194759950041771,0.04183780029416084,0.04179856926202774,0.04163248836994171,0.04156213626265526,0.04146289452910423,0.041306350380182266,0.04118349775671959,0.0410965234041214,0.04099521413445473,0.04090365767478943,0.04074573144316673,0.040635887533426285,0.040566232055425644,0.040475089102983475,0.04033304378390312,0.04017722234129906,0.040093082934617996,0.03992201015353203,0.03977367654442787,0.03964593634009361,0.03955093026161194,0.03954713046550751,0.0395081602036953,0.03947464004158974,0.03941546753048897,0.039383016526699066,0.03926219046115875,0.039132144302129745,0.039037883281707764,0.03906497731804848,0.038878586143255234,0.03868695721030235,0.03870201110839844,0.03869021311402321,0.038668833673000336,0.03871484100818634,0.0385863222181797,0.03839586302638054,0.0382692813873291,0.03809439763426781,0.0379338413476944,0.037883829325437546,0.0378110446035862,0.037723686546087265,0.0377468541264534,0.037536367774009705,0.037417829036712646,0.037370651960372925,0.03725889325141907,0.03724579140543938,0.03736212104558945,0.03728562220931053,0.03714955225586891,0.03691462427377701,0.036858879029750824,0.036696117371320724,0.036566685885190964,0.036597564816474915,0.036512646824121475,0.03648237884044647],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b1881180-d610-4a22-bd94-544c4bfdcf62');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-5" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-5">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="37">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-38-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-1" class="level3">
<h3 class="anchored" data-anchor-id="discussion-1">Discussion</h3>
<p>For predicting CO2 emissions from Hydro Power, the training RMSE are: <br> 1) RNN - 0.17576<br> 2) GRU - 0.19256<br> 3) LSTM - 0.18912<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.07061<br> 2) GRU - 0.02567<br> 3) LSTM - 0.07663<br></p>
<p>Thus, the RNN minimized RMSE for training predictions, but the GRU ANN produced the lowest test RMSE of the group. Test RMSE is significantly lower than training RMSE, so further analysis could investigate possible data leakage. Regularization again improved the model performance, by 0.04 points in the RMSE.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,2)(0,1,1) forecast shared the same seasonality, but exhibited an upwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RNSE from the ARIMA model was 0.07292737, significantly smaller than the ANN RMSE. With more model tuning the ANN could likely outperform the ARIMA model.</p>
</section>
</section>
<section id="natural-gas" class="level2">
<h2 class="anchored" data-anchor-id="natural-gas">Natural Gas</h2>
<section id="split-data-into-training-and-testing-data-2" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-2">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="c457798e-0c93-46b7-8446-91e8603e8f10" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c457798e-0c93-46b7-8446-91e8603e8f10")) {                    Plotly.newPlot(                        "c457798e-0c93-46b7-8446-91e8603e8f10",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.26110875606536865,0.23300564289093018,0.2174530029296875,0.19012415409088135,0.17273688316345215,0.1386784315109253,0.1428607702255249,0.14706039428710938,0.13678324222564697,0.16844725608825684,0.20006167888641357,0.23917269706726074,0.8974436521530151,0.24761199951171875,0.2237480878829956,0.21638107299804688,0.1682368516921997,0.15302729606628418,0.12130570411682129,0.1354612112045288,0.13442301750183105,0.13907194137573242,0.16899287700653076,0.1888883113861084,0.2300206422805786,0.8874245882034302,0.2483431100845337,0.20696818828582764,0.20145142078399658,0.14828944206237793,0.09943485260009766,0.08245742321014404,0.09474408626556396,0.10622560977935791,0.10615909099578857,0.1399857997894287,0.15745925903320312,0.22168338298797607,0.8634310960769653,0.25390398502349854,0.2066500186920166,0.17250490188598633,0.1345539093017578,0.11964130401611328,0.0990825891494751,0.10645198822021484,0.09473192691802979,0.09132802486419678,0.15325582027435303,0.19566023349761963,0.24600815773010254,0.8689192533493042,0.2681998014450073,0.1892094612121582,0.17159688472747803,0.12133538722991943,0.10836577415466309,0.09870994091033936,0.09704875946044922,0.10506308078765869,0.11753582954406738,0.13524258136749268,0.16612458229064941,0.22974491119384766,0.8630361557006836,0.26423048973083496,0.23432612419128418,0.20320141315460205,0.13997185230255127,0.10870659351348877,0.08037769794464111,0.0986095666885376,0.08797454833984375,0.07644987106323242,0.11973810195922852,0.16020596027374268,0.2238178253173828,0.8641737699508667,0.2702372074127197,0.24371659755706787,0.1984647512435913,0.15091538429260254,0.1190258264541626,0.09403562545776367,0.09856545925140381,0.10101056098937988,0.09795093536376953,0.14277148246765137,0.17912650108337402,0.22486233711242676,0.8736141920089722,0.24640703201293945,0.23521602153778076,0.22235167026519775,0.1394127607345581,0.10354924201965332,0.08145773410797119,0.09068512916564941,0.08754110336303711,0.09078419208526611,0.13517546653747559,0.1769932508468628,0.23192286491394043,0.8676444292068481,0.25176429748535156,0.19988739490509033,0.1997666358947754,0.13008511066436768,0.11744940280914307,0.09316182136535645,0.09412121772766113,0.09363985061645508,0.08258473873138428,0.13448667526245117,0.15317308902740479,0.22435224056243896,0.8605738878250122,0.26709890365600586,0.21373248100280762,0.19121289253234863,0.13078463077545166,0.054064393043518066,0.04823434352874756,0.056112051010131836,0.057677507400512695,0.054252028465270996,0.09330499172210693,0.14329314231872559,0.17520880699157715,0.8402361869812012,0.2455369234085083,0.19341206550598145,0.17788124084472656,0.13366854190826416,0.0774153470993042,0.03602325916290283,0.03502190113067627,0.044736385345458984,0.028131842613220215,0.044988393783569336,0.09007823467254639,0.16043519973754883,0.8219493627548218,0.261627197265625,0.21033108234405518,0.19288551807403564,0.15272891521453857,0.10339927673339844,0.0644296407699585,0.05898082256317139,0.05901312828063965,0.04120945930480957,0.06534194946289062,0.1124035120010376,0.17520582675933838,0.8406360149383545,0.23108041286468506,0.23801982402801514,0.1743708848953247,0.1238318681716919,0.05694448947906494,0.0390019416809082,0.04965317249298096,0.049567341804504395,0.029526352882385254,0.05658674240112305,0.09633779525756836,0.2026979923248291,0.8298665285110474,0.23735284805297852,0.19942903518676758,0.17490220069885254,0.1034308671951294,0.061556100845336914,0.02783358097076416,0.026544570922851562,0.016166210174560547,0.0,0.02219092845916748,0.08047175407409668,0.16544973850250244,0.8112574815750122,0.23417901992797852,0.20533788204193115,0.1786363124847412,0.12237787246704102,0.06661081314086914,0.045046448707580566,0.04345357418060303,0.05171835422515869,0.030414819717407227,0.07503259181976318,0.11783218383789062,0.18687140941619873,0.8287758827209473,0.2419959306716919,0.22175896167755127,0.1964435577392578,0.12684857845306396,0.09317409992218018,0.06226348876953125,0.06383633613586426,0.07466185092926025,0.04399847984313965,0.0766448974609375,0.12416946887969971,0.18901968002319336,0.8412625789642334,0.22323858737945557,0.2218707799911499,0.213303804397583,0.1550809144973755,0.11041676998138428,0.07795071601867676,0.08393967151641846,0.08251261711120605,0.07343733310699463,0.10770595073699951,0.15124571323394775,0.2415252923965454,0.8591548204421997,0.2391970157623291,0.19649481773376465,0.19080400466918945,0.1577136516571045,0.1180046796798706,0.09730279445648193,0.09543061256408691,0.101828932762146,0.09340715408325195,0.11889147758483887,0.14740192890167236,0.21326887607574463,0.8589605093002319,0.2606867551803589,0.20815813541412354,0.19829225540161133,0.14932870864868164,0.1104590892791748,0.08080935478210449,0.10226094722747803,0.10005021095275879,0.0880119800567627,0.12714993953704834,0.1746135950088501,0.2223438024520874,0.8648611307144165,0.25410139560699463,0.22691690921783447,0.2130221128463745,0.17668545246124268,0.12886130809783936,0.09898638725280762,0.11249518394470215,0.10069608688354492,0.09584414958953857,0.11774587631225586,0.1726781129837036,0.23876845836639404,0.8743447065353394,0.25783538818359375,0.2430797815322876,0.24015021324157715,0.17108416557312012,0.09836471080780029,0.10118162631988525,0.11788463592529297,0.12260663509368896,0.09872591495513916,0.13953101634979248,0.18630290031433105,0.2377638816833496,0.8814641237258911,0.28643548488616943,0.25993454456329346,0.22606706619262695,0.16427361965179443,0.12025177478790283,0.12277257442474365,0.12447738647460938,0.13059473037719727,0.11456620693206787,0.13542592525482178,0.1768958568572998,0.23228180408477783,0.887884259223938,0.2714637517929077,0.24689102172851562,0.23521125316619873,0.18842339515686035,0.15389084815979004,0.12421345710754395,0.14941251277923584,0.16179120540618896,0.12484347820281982,0.1377394199371338,0.2028205394744873,0.2605710029602051,0.8999956846237183,0.29089152812957764,0.26235926151275635,0.24700069427490234,0.19400954246520996,0.15898525714874268,0.13862264156341553,0.13941621780395508,0.14521706104278564,0.12717890739440918,0.147810697555542,0.20458412170410156,0.25319647789001465,0.9050635099411011,0.28400325775146484,0.25230252742767334,0.23680782318115234,0.19142425060272217,0.1593937873840332,0.13929462432861328,0.16338670253753662,0.1572340726852417,0.13963520526885986,0.1503673791885376,0.20488524436950684,0.2631570100784302,0.9067169427871704,0.2738621234893799,0.2360440492630005,0.2404623031616211,0.1790781021118164,0.15055131912231445,0.14996576309204102,0.17309224605560303,0.17519652843475342,0.15076172351837158,0.14282643795013428,0.17947697639465332,0.2404402494430542,0.9014021158218384,0.28582727909088135,0.23562288284301758,0.2443230152130127,0.19409561157226562,0.14837372303009033,0.13864362239837646,0.16639339923858643,0.1724987030029297,0.13778138160705566,0.1558070182800293,0.1737152338027954,0.24589574337005615,0.9027410745620728,0.28317177295684814,0.26059842109680176,0.22737669944763184,0.18929994106292725,0.1744692325592041,0.1537487506866455,0.1633772850036621,0.1866093873977661,0.14400207996368408,0.15224754810333252,0.20455646514892578,0.29167211055755615,0.9141846895217896,0.30009591579437256,0.2578192949295044,0.2496509552001953,0.1870948076248169,0.13778138160705566,0.12298250198364258,0.1516655683517456,0.1643214225769043,0.13225698471069336,0.16053533554077148,0.16941869258880615,0.2330406904220581,0.9015079736709595,0.27843451499938965,0.2487955093383789,0.25059545040130615,0.1979585886001587,0.15347754955291748,0.14985525608062744,0.17671287059783936,0.17292547225952148,0.1408240795135498,0.15926098823547363,0.20284545421600342,0.26554346084594727,0.9108484983444214,0.30295491218566895,0.2809504270553589,0.2439645528793335,0.17744362354278564,0.13662540912628174,0.10774481296539307,0.15232062339782715,0.16131210327148438,0.11968600749969482,0.14363932609558105,0.17865753173828125,0.2521551847457886,0.9023712873458862,0.29978346824645996,0.28166186809539795,0.23037183284759521,0.1771303415298462,0.1471855640411377,0.13116061687469482,0.15005958080291748,0.1482086181640625,0.13005638122558594,0.14401912689208984,0.1830536127090454,0.25987088680267334,0.9036895036697388,0.2879985570907593,0.2498561143875122,0.24486827850341797,0.1742478609085083,0.1385563611984253,0.1408170461654663,0.1682431697845459,0.16962182521820068,0.11917150020599365,0.11988711357116699,0.16385924816131592,0.26036667823791504,0.8992801904678345,0.24068880081176758,0.2379385232925415,0.23539984226226807,0.16817092895507812,0.14067184925079346,0.1450263261795044,0.18130385875701904,0.18004107475280762,0.12799417972564697,0.1616593599319458,0.18206787109375,0.23491311073303223,0.8961900472640991,0.2786327600479126,0.28912651538848877,0.23544931411743164,0.18913066387176514,0.14676928520202637,0.1457444429397583,0.16460788249969482,0.20269536972045898,0.15208470821380615,0.15859556198120117,0.19274723529815674,0.26992321014404297,0.9139808416366577,0.30715179443359375,0.28197169303894043,0.25490403175354004,0.19125044345855713,0.14951324462890625,0.15468251705169678,0.1728975772857666,0.1684190034866333,0.1277083158493042,0.15990853309631348,0.19823575019836426,0.2700439691543579,0.916113018989563,0.30649757385253906,0.26152992248535156,0.24087142944335938,0.17775368690490723,0.1359119415283203,0.1404709815979004,0.16399002075195312,0.17715775966644287,0.14901971817016602,0.164941668510437,0.18314599990844727,0.2802478075027466,0.9112786054611206,0.3139129877090454,0.2783534526824951,0.23615539073944092,0.16836881637573242,0.15528476238250732,0.16112208366394043,0.1903247833251953,0.1985776424407959,0.15895605087280273,0.1636359691619873,0.21249020099639893,0.30392181873321533,0.9245861768722534,0.321567177772522,0.274796724319458,0.2473599910736084,0.1898273229598999,0.16379225254058838,0.16224384307861328,0.2001347541809082,0.20027220249176025,0.16186511516571045,0.17673110961914062,0.22060108184814453,0.28484904766082764,0.9289323091506958,0.3085308074951172,0.2807518243789673,0.23428118228912354,0.2097480297088623,0.19777750968933105,0.19700908660888672,0.22640013694763184,0.21774089336395264,0.1873534917831421,0.20182573795318604,0.23966670036315918,0.2810159921646118],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9414950609207153,0.32173216342926025,0.28904008865356445,0.2836726903915405,0.21253061294555664,0.17915380001068115,0.17773854732513428,0.2064523696899414,0.20653200149536133,0.18160676956176758,0.1972672939300537,0.25936949253082275,0.32578396797180176,0.9490333795547485,0.35352814197540283,0.308935284614563,0.2889045476913452,0.2126784324645996,0.18954765796661377,0.17909932136535645,0.2005302906036377,0.20836007595062256,0.18942523002624512,0.2053847312927246,0.2654808759689331,0.30214977264404297,0.9548643827438354,0.34644007682800293,0.32860660552978516,0.2937227487564087,0.22053039073944092,0.19817066192626953,0.20473062992095947,0.22898471355438232,0.22686076164245605,0.20491838455200195,0.21751129627227783,0.2530984878540039,0.29334867000579834,0.9629336595535278,0.34439587593078613,0.30055809020996094,0.2664501667022705,0.23125410079956055,0.21441149711608887,0.21953284740447998,0.244928240776062,0.24773550033569336,0.2117687463760376,0.20840108394622803,0.24143052101135254,0.3226447105407715,0.9650362730026245,0.327018141746521,0.2643314599990845,0.285733699798584,0.2091120481491089,0.20297908782958984,0.20577585697174072,0.23862123489379883,0.23207604885101318,0.20721757411956787,0.22328245639801025,0.26606285572052,0.3431142568588257,0.9614056348800659,0.3650442361831665,0.30513012409210205,0.3139166831970215,0.26388728618621826,0.2250295877456665,0.22632598876953125,0.26392555236816406,0.25934910774230957,0.23897433280944824,0.25564897060394287,0.3053668737411499,0.33391332626342773,0.9900797605514526,0.3726156949996948,0.33671414852142334,0.3276035785675049,0.24704575538635254,0.23653864860534668,0.2347266674041748,0.2697913646697998,0.2744119167327881,0.2462303638458252,0.25891315937042236,0.3130815029144287,0.3504520654678345,1.0000001192092896,0.3635917901992798,0.34014439582824707,0.3065187931060791,0.2528560161590576,0.22812330722808838,0.23585331439971924,0.2779350280761719,0.27017807960510254,0.23865079879760742,0.25979340076446533,0.2751270532608032,0.35131824016571045,0.9940599203109741,0.36482858657836914,0.3438863754272461,0.2975490093231201,0.25419437885284424,0.23369789123535156,0.2504638433456421,0.272000789642334,0.27433621883392334,0.23656833171844482,0.25247764587402344,0.3018532991409302,0.33434104919433594,0.9949885606765747,0.38561975955963135,0.33999478816986084,0.31212449073791504,0.2658109664916992,0.2501506805419922,0.2600346803665161,0.2909811735153198,0.2882871627807617,0.2563042640686035,0.265688419342041,0.3116997480392456,0.3688582181930542],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Natural Gas since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c457798e-0c93-46b7-8446-91e8603e8f10');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-2" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-2">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="40">
<div class="cell-output cell-output-display">

<div>                            <div id="9d02ff29-bb9a-434a-9ba3-766f5231ce0c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9d02ff29-bb9a-434a-9ba3-766f5231ce0c")) {                    Plotly.newPlot(                        "9d02ff29-bb9a-434a-9ba3-766f5231ce0c",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.23300564289093018,0.2174530029296875,0.19012415409088135,0.17273688316345215,0.1386784315109253,0.1428607702255249,0.14706039428710938,0.13678324222564697,0.16844725608825684],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.20006167888641357],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.23917269706726074,0.8974436521530151,0.24761199951171875,0.2237480878829956,0.21638107299804688,0.1682368516921997,0.15302729606628418,0.12130570411682129,0.1354612112045288],"type":"scatter"},{"x":[19],"y":[0.13442301750183105],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.13907194137573242,0.16899287700653076,0.1888883113861084,0.2300206422805786,0.8874245882034302,0.2483431100845337,0.20696818828582764,0.20145142078399658,0.14828944206237793],"type":"scatter"},{"x":[29],"y":[0.09943485260009766],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.08245742321014404,0.09474408626556396,0.10622560977935791,0.10615909099578857,0.1399857997894287,0.15745925903320312,0.22168338298797607,0.8634310960769653,0.25390398502349854],"type":"scatter"},{"x":[39],"y":[0.2066500186920166],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.17250490188598633,0.1345539093017578,0.11964130401611328,0.0990825891494751,0.10645198822021484,0.09473192691802979,0.09132802486419678,0.15325582027435303,0.19566023349761963],"type":"scatter"},{"x":[49],"y":[0.24600815773010254],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8689192533493042,0.2681998014450073,0.1892094612121582,0.17159688472747803,0.12133538722991943,0.10836577415466309,0.09870994091033936,0.09704875946044922,0.10506308078765869],"type":"scatter"},{"x":[59],"y":[0.11753582954406738],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.13524258136749268,0.16612458229064941,0.22974491119384766,0.8630361557006836,0.26423048973083496,0.23432612419128418,0.20320141315460205,0.13997185230255127,0.10870659351348877],"type":"scatter"},{"x":[69],"y":[0.08037769794464111],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.0986095666885376,0.08797454833984375,0.07644987106323242,0.11973810195922852,0.16020596027374268,0.2238178253173828,0.8641737699508667,0.2702372074127197,0.24371659755706787],"type":"scatter"},{"x":[79],"y":[0.1984647512435913],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.15091538429260254,0.1190258264541626,0.09403562545776367,0.09856545925140381,0.10101056098937988,0.09795093536376953,0.14277148246765137,0.17912650108337402,0.22486233711242676],"type":"scatter"},{"x":[89],"y":[0.8736141920089722],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.24640703201293945,0.23521602153778076,0.22235167026519775,0.1394127607345581,0.10354924201965332,0.08145773410797119,0.09068512916564941,0.08754110336303711,0.09078419208526611],"type":"scatter"},{"x":[99],"y":[0.13517546653747559],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.1769932508468628,0.23192286491394043,0.8676444292068481,0.25176429748535156,0.19988739490509033,0.1997666358947754,0.13008511066436768,0.11744940280914307,0.09316182136535645],"type":"scatter"},{"x":[109],"y":[0.09412121772766113],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.09363985061645508,0.08258473873138428,0.13448667526245117,0.15317308902740479,0.22435224056243896,0.8605738878250122,0.26709890365600586,0.21373248100280762,0.19121289253234863],"type":"scatter"},{"x":[119],"y":[0.13078463077545166],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.054064393043518066,0.04823434352874756,0.056112051010131836,0.057677507400512695,0.054252028465270996,0.09330499172210693,0.14329314231872559,0.17520880699157715,0.8402361869812012],"type":"scatter"},{"x":[129],"y":[0.2455369234085083],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.19341206550598145,0.17788124084472656,0.13366854190826416,0.0774153470993042,0.03602325916290283,0.03502190113067627,0.044736385345458984,0.028131842613220215,0.044988393783569336],"type":"scatter"},{"x":[139],"y":[0.09007823467254639],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.16043519973754883,0.8219493627548218,0.261627197265625,0.21033108234405518,0.19288551807403564,0.15272891521453857,0.10339927673339844,0.0644296407699585,0.05898082256317139],"type":"scatter"},{"x":[149],"y":[0.05901312828063965],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.04120945930480957,0.06534194946289062,0.1124035120010376,0.17520582675933838,0.8406360149383545,0.23108041286468506,0.23801982402801514,0.1743708848953247,0.1238318681716919],"type":"scatter"},{"x":[159],"y":[0.05694448947906494],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.0390019416809082,0.04965317249298096,0.049567341804504395,0.029526352882385254,0.05658674240112305,0.09633779525756836,0.2026979923248291,0.8298665285110474,0.23735284805297852],"type":"scatter"},{"x":[169],"y":[0.19942903518676758],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.17490220069885254,0.1034308671951294,0.061556100845336914,0.02783358097076416,0.026544570922851562,0.016166210174560547,0.0,0.02219092845916748,0.08047175407409668],"type":"scatter"},{"x":[179],"y":[0.16544973850250244],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.8112574815750122,0.23417901992797852,0.20533788204193115,0.1786363124847412,0.12237787246704102,0.06661081314086914,0.045046448707580566,0.04345357418060303,0.05171835422515869],"type":"scatter"},{"x":[189],"y":[0.030414819717407227],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.07503259181976318,0.11783218383789062,0.18687140941619873,0.8287758827209473,0.2419959306716919,0.22175896167755127,0.1964435577392578,0.12684857845306396,0.09317409992218018],"type":"scatter"},{"x":[199],"y":[0.06226348876953125],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.06383633613586426,0.07466185092926025,0.04399847984313965,0.0766448974609375,0.12416946887969971,0.18901968002319336,0.8412625789642334,0.22323858737945557,0.2218707799911499],"type":"scatter"},{"x":[209],"y":[0.213303804397583],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.1550809144973755,0.11041676998138428,0.07795071601867676,0.08393967151641846,0.08251261711120605,0.07343733310699463,0.10770595073699951,0.15124571323394775,0.2415252923965454],"type":"scatter"},{"x":[219],"y":[0.8591548204421997],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.2391970157623291,0.19649481773376465,0.19080400466918945,0.1577136516571045,0.1180046796798706,0.09730279445648193,0.09543061256408691,0.101828932762146,0.09340715408325195],"type":"scatter"},{"x":[229],"y":[0.11889147758483887],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.14740192890167236,0.21326887607574463,0.8589605093002319,0.2606867551803589,0.20815813541412354,0.19829225540161133,0.14932870864868164,0.1104590892791748,0.08080935478210449],"type":"scatter"},{"x":[239],"y":[0.10226094722747803],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.10005021095275879,0.0880119800567627,0.12714993953704834,0.1746135950088501,0.2223438024520874,0.8648611307144165,0.25410139560699463,0.22691690921783447,0.2130221128463745],"type":"scatter"},{"x":[249],"y":[0.17668545246124268],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.12886130809783936,0.09898638725280762,0.11249518394470215,0.10069608688354492,0.09584414958953857,0.11774587631225586,0.1726781129837036,0.23876845836639404,0.8743447065353394],"type":"scatter"},{"x":[259],"y":[0.25783538818359375],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.2430797815322876,0.24015021324157715,0.17108416557312012,0.09836471080780029,0.10118162631988525,0.11788463592529297,0.12260663509368896,0.09872591495513916,0.13953101634979248],"type":"scatter"},{"x":[269],"y":[0.18630290031433105],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.2377638816833496,0.8814641237258911,0.28643548488616943,0.25993454456329346,0.22606706619262695,0.16427361965179443,0.12025177478790283,0.12277257442474365,0.12447738647460938],"type":"scatter"},{"x":[279],"y":[0.13059473037719727],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.11456620693206787,0.13542592525482178,0.1768958568572998,0.23228180408477783,0.887884259223938,0.2714637517929077,0.24689102172851562,0.23521125316619873,0.18842339515686035],"type":"scatter"},{"x":[289],"y":[0.15389084815979004],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.12421345710754395,0.14941251277923584,0.16179120540618896,0.12484347820281982,0.1377394199371338,0.2028205394744873,0.2605710029602051,0.8999956846237183,0.29089152812957764],"type":"scatter"},{"x":[299],"y":[0.26235926151275635],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.24700069427490234,0.19400954246520996,0.15898525714874268,0.13862264156341553,0.13941621780395508,0.14521706104278564,0.12717890739440918,0.147810697555542,0.20458412170410156],"type":"scatter"},{"x":[309],"y":[0.25319647789001465],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9050635099411011,0.28400325775146484,0.25230252742767334,0.23680782318115234,0.19142425060272217,0.1593937873840332,0.13929462432861328,0.16338670253753662,0.1572340726852417],"type":"scatter"},{"x":[319],"y":[0.13963520526885986],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.1503673791885376,0.20488524436950684,0.2631570100784302,0.9067169427871704,0.2738621234893799,0.2360440492630005,0.2404623031616211,0.1790781021118164,0.15055131912231445],"type":"scatter"},{"x":[329],"y":[0.14996576309204102],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.17309224605560303,0.17519652843475342,0.15076172351837158,0.14282643795013428,0.17947697639465332,0.2404402494430542,0.9014021158218384,0.28582727909088135,0.23562288284301758],"type":"scatter"},{"x":[339],"y":[0.2443230152130127],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.19409561157226562,0.14837372303009033,0.13864362239837646,0.16639339923858643,0.1724987030029297,0.13778138160705566,0.1558070182800293,0.1737152338027954,0.24589574337005615],"type":"scatter"},{"x":[349],"y":[0.9027410745620728],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.28317177295684814,0.26059842109680176,0.22737669944763184,0.18929994106292725,0.1744692325592041,0.1537487506866455,0.1633772850036621,0.1866093873977661,0.14400207996368408],"type":"scatter"},{"x":[359],"y":[0.15224754810333252],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.20455646514892578,0.29167211055755615,0.9141846895217896,0.30009591579437256,0.2578192949295044,0.2496509552001953,0.1870948076248169,0.13778138160705566,0.12298250198364258],"type":"scatter"},{"x":[369],"y":[0.1516655683517456],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.1643214225769043,0.13225698471069336,0.16053533554077148,0.16941869258880615,0.2330406904220581,0.9015079736709595,0.27843451499938965,0.2487955093383789,0.25059545040130615],"type":"scatter"},{"x":[379],"y":[0.1979585886001587],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.15347754955291748,0.14985525608062744,0.17671287059783936,0.17292547225952148,0.1408240795135498,0.15926098823547363,0.20284545421600342,0.26554346084594727,0.9108484983444214],"type":"scatter"},{"x":[389],"y":[0.30295491218566895],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.2809504270553589,0.2439645528793335,0.17744362354278564,0.13662540912628174,0.10774481296539307,0.15232062339782715,0.16131210327148438,0.11968600749969482,0.14363932609558105],"type":"scatter"},{"x":[399],"y":[0.17865753173828125],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.2521551847457886,0.9023712873458862,0.29978346824645996,0.28166186809539795,0.23037183284759521,0.1771303415298462,0.1471855640411377,0.13116061687469482,0.15005958080291748],"type":"scatter"},{"x":[409],"y":[0.1482086181640625],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.13005638122558594,0.14401912689208984,0.1830536127090454,0.25987088680267334,0.9036895036697388,0.2879985570907593,0.2498561143875122,0.24486827850341797,0.1742478609085083],"type":"scatter"},{"x":[419],"y":[0.1385563611984253],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.1408170461654663,0.1682431697845459,0.16962182521820068,0.11917150020599365,0.11988711357116699,0.16385924816131592,0.26036667823791504,0.8992801904678345,0.24068880081176758],"type":"scatter"},{"x":[429],"y":[0.2379385232925415],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.23539984226226807,0.16817092895507812,0.14067184925079346,0.1450263261795044,0.18130385875701904,0.18004107475280762,0.12799417972564697,0.1616593599319458,0.18206787109375],"type":"scatter"},{"x":[439],"y":[0.23491311073303223],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.8961900472640991,0.2786327600479126,0.28912651538848877,0.23544931411743164,0.18913066387176514,0.14676928520202637,0.1457444429397583,0.16460788249969482,0.20269536972045898],"type":"scatter"},{"x":[449],"y":[0.15208470821380615],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.15859556198120117,0.19274723529815674,0.26992321014404297,0.9139808416366577,0.30715179443359375,0.28197169303894043,0.25490403175354004,0.19125044345855713,0.14951324462890625],"type":"scatter"},{"x":[459],"y":[0.15468251705169678],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.1728975772857666,0.1684190034866333,0.1277083158493042,0.15990853309631348,0.19823575019836426,0.2700439691543579,0.916113018989563,0.30649757385253906,0.26152992248535156],"type":"scatter"},{"x":[469],"y":[0.24087142944335938],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.17775368690490723,0.1359119415283203,0.1404709815979004,0.16399002075195312,0.17715775966644287,0.14901971817016602,0.164941668510437,0.18314599990844727,0.2802478075027466],"type":"scatter"},{"x":[479],"y":[0.9112786054611206],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3139129877090454,0.2783534526824951,0.23615539073944092,0.16836881637573242,0.15528476238250732,0.16112208366394043,0.1903247833251953,0.1985776424407959,0.15895605087280273],"type":"scatter"},{"x":[489],"y":[0.1636359691619873],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.21249020099639893,0.30392181873321533,0.9245861768722534,0.321567177772522,0.274796724319458,0.2473599910736084,0.1898273229598999,0.16379225254058838,0.16224384307861328],"type":"scatter"},{"x":[499],"y":[0.2001347541809082],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.20027220249176025,0.16186511516571045,0.17673110961914062,0.22060108184814453,0.28484904766082764,0.9289323091506958,0.3085308074951172,0.2807518243789673,0.23428118228912354],"type":"scatter"},{"x":[509],"y":[0.2097480297088623],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Natural Gas since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9d02ff29-bb9a-434a-9ba3-766f5231ce0c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-2" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-2">Model 1 = RNN</h3>
<section id="model-architecture-6" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-6">Model architecture</h4>
<div class="cell" data-execution_count="42">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_2 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_6 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-2" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-2">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="44">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.041223448
0.0054442543
Train MSE = 0.04122 RMSE = 0.20304
Test MSE = 0.00544 RMSE = 0.07379</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="7a38f677-062b-45d2-ae8c-cee6a417287d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7a38f677-062b-45d2-ae8c-cee6a417287d")) {                    Plotly.newPlot(                        "7a38f677-062b-45d2-ae8c-cee6a417287d",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.1359070986509323,0.11437966674566269,0.1102590411901474,0.10742708295583725,0.10517169535160065,0.10309012234210968,0.10118149220943451,0.09938167780637741,0.09766846895217896,0.09596987068653107,0.09428510814905167,0.09265962243080139,0.09112834185361862,0.08963042497634888,0.08822470158338547,0.0868321880698204,0.08544288575649261,0.08408889919519424,0.08273021131753922,0.08145114779472351,0.08019177615642548,0.07898181676864624,0.07776786386966705,0.07661235332489014,0.0754488930106163,0.07431483268737793,0.0732671245932579,0.0722116008400917,0.07116615772247314,0.07020975649356842,0.06923894584178925,0.06831548362970352,0.06736891716718674,0.0664932131767273,0.06560419499874115,0.06477081775665283,0.06398417055606842,0.0632256418466568,0.06250903755426407,0.06179752200841904,0.0611187219619751,0.060470301657915115,0.059825681149959564,0.05929600074887276,0.05869026109576225,0.05812203139066696,0.05761639028787613,0.057055890560150146,0.05657719448208809,0.05604977160692215,0.05556600168347359,0.055152855813503265,0.05468377470970154,0.054261911660432816,0.05385928228497505,0.053487151861190796,0.05309609696269035,0.05274586006999016,0.05247224494814873,0.05212864279747009,0.051853202283382416,0.051627762615680695,0.051302194595336914,0.05101107433438301,0.05085764080286026,0.05054081231355667,0.050274044275283813,0.0500238761305809,0.04980439692735672,0.04958702251315117,0.049392856657505035,0.04911550134420395,0.04891852289438248,0.048861563205718994,0.04851149767637253,0.04835077002644539,0.048189662396907806,0.04799935221672058,0.04779955372214317,0.04762480407953262,0.04744304344058037,0.047247014939785004,0.04705199599266052,0.04688578099012375,0.046778712421655655,0.04659852012991905,0.046450722962617874,0.04623483866453171,0.04619976133108139,0.04593004658818245,0.04577884450554848,0.04570694640278816,0.04550764709711075,0.04542034864425659,0.04523834213614464,0.04510190337896347,0.04500487446784973,0.04481716826558113,0.04476289451122284,0.04456307366490364,0.04445156827569008,0.04433653503656387,0.04422583058476448,0.04411684349179268,0.04402666538953781,0.04384637624025345,0.04374399408698082,0.04362662136554718,0.043483756482601166,0.0433732345700264,0.04330981522798538,0.043167322874069214,0.04307744652032852,0.04294522851705551,0.042849648743867874,0.042783696204423904,0.04267817363142967,0.04255861043930054,0.042574409395456314,0.04241025075316429,0.04233419522643089,0.04227711632847786,0.04211070388555527,0.042036112397909164,0.042068321257829666,0.04188232123851776,0.041783176362514496,0.04176842421293259,0.04171377047896385,0.04161834716796875,0.041507821530103683,0.0414881594479084,0.041368067264556885,0.04130052775144577,0.041272617876529694,0.041220299899578094,0.041168466210365295,0.04110054299235344,0.04107200354337692,0.04097189009189606,0.040878407657146454,0.04085596650838852,0.040843576192855835,0.04071863740682602,0.04071005806326866,0.04069488123059273,0.040593259036540985,0.040600549429655075,0.040581218898296356,0.04048832505941391,0.04063812643289566,0.04043830186128616,0.040449779480695724,0.040413279086351395,0.040349941700696945,0.0402723029255867,0.04029716178774834,0.04026764631271362,0.040189068764448166,0.0401800200343132,0.04015859588980675,0.0401800200343132,0.04011794552206993,0.040130384266376495,0.040073953568935394,0.040067318826913834,0.040037572383880615,0.04018465802073479,0.04003925248980522,0.04009903594851494,0.04001672938466072,0.03999977186322212,0.04004742205142975,0.039975933730602264,0.03994907811284065,0.03995727002620697,0.03990309312939644,0.03997374698519707,0.03994745761156082,0.039911963045597076,0.039942458271980286,0.03994177654385567,0.039900220930576324,0.039890486747026443,0.03985745832324028,0.03986646980047226,0.03987540677189827,0.03992483392357826,0.039901260286569595,0.03996982052922249,0.03986348956823349,0.03984498605132103,0.03986423835158348,0.039948660880327225,0.03993119299411774,0.03991004079580307,0.03995224088430405,0.03987157717347145,0.03988204151391983,0.039907943457365036],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.14291559159755707,0.13440905511379242,0.13029804825782776,0.12739409506320953,0.12482597678899765,0.1225476935505867,0.12048542499542236,0.1184934601187706,0.1165776476264,0.11463932693004608,0.11274413764476776,0.11093132197856903,0.10913407057523727,0.1074485331773758,0.10576125979423523,0.10411491245031357,0.10246714949607849,0.1008458361029625,0.0992060974240303,0.09766197204589844,0.09620639681816101,0.09469900280237198,0.09328346699476242,0.0918552353978157,0.09042897820472717,0.08904436230659485,0.0877520889043808,0.08642987161874771,0.08516719937324524,0.08399763703346252,0.0827905461192131,0.081586092710495,0.08044326305389404,0.07929716259241104,0.0781906321644783,0.07710228860378265,0.07609300315380096,0.07513236254453659,0.07419279217720032,0.07329045981168747,0.07239007204771042,0.07156162708997726,0.07071048021316528,0.06996804475784302,0.06920861452817917,0.0684736892580986,0.0677637979388237,0.06703167408704758,0.06634334474802017,0.06564128398895264,0.06495841592550278,0.06435353308916092,0.06373968720436096,0.06312722712755203,0.06258147209882736,0.062018219381570816,0.0614747516810894,0.06095927953720093,0.06052284315228462,0.060128938406705856,0.059756312519311905,0.0594027005136013,0.059059154242277145,0.05868065357208252,0.05839160829782486,0.0580560676753521,0.05774100124835968,0.057421132922172546,0.05708102881908417,0.05677914619445801,0.05649590119719505,0.05620567873120308,0.05592119321227074,0.05574476346373558,0.055487945675849915,0.05525195226073265,0.05502958595752716,0.05480515584349632,0.054582394659519196,0.05437438189983368,0.05416243150830269,0.05395219102501869,0.05374409258365631,0.05352894216775894,0.05335528030991554,0.05318253114819527,0.053009070456027985,0.05282888188958168,0.05267425999045372,0.052494488656520844,0.05232222005724907,0.052170995622873306,0.05201256647706032,0.05186714231967926,0.05170697346329689,0.05154706537723541,0.051403213292360306,0.051243945956230164,0.05110371485352516,0.050953999161720276,0.05082397162914276,0.05069516971707344,0.050569213926792145,0.05044825002551079,0.0503392331302166,0.05021614208817482,0.05010077729821205,0.04998335987329483,0.04987073317170143,0.04974602162837982,0.04962014779448509,0.04950585216283798,0.04939022287726402,0.04929397255182266,0.04919097200036049,0.04907334968447685,0.048971567302942276,0.04887790605425835,0.04881688207387924,0.048715315759181976,0.04862520843744278,0.0485399030148983,0.04844174534082413,0.048356153070926666,0.04826555401086807,0.04818709194660187,0.04810755327343941,0.04804013669490814,0.04796602576971054,0.04789470136165619,0.04781109467148781,0.04774853214621544,0.04768102988600731,0.04762113466858864,0.04756457731127739,0.04750772938132286,0.04744739830493927,0.04737811163067818,0.04733238369226456,0.04728411138057709,0.0472356341779232,0.04718252643942833,0.04712395370006561,0.04707302153110504,0.04702717065811157,0.04698926582932472,0.04694483056664467,0.046902548521757126,0.04686018079519272,0.04681834951043129,0.04686876758933067,0.046842917799949646,0.04681183397769928,0.04677489772439003,0.04674719274044037,0.046717092394828796,0.046681955456733704,0.04665482044219971,0.046623729169368744,0.046595655381679535,0.0465654581785202,0.046551212668418884,0.04652657359838486,0.046500321477651596,0.046484362334012985,0.046453651040792465,0.046427737921476364,0.046498022973537445,0.04647400230169296,0.046465013176202774,0.046441592276096344,0.046425141394138336,0.04642627388238907,0.04639691486954689,0.04637026786804199,0.046356167644262314,0.04633805528283119,0.046346258372068405,0.04633664712309837,0.046317413449287415,0.046302758157253265,0.046292662620544434,0.046284545212984085,0.04627314954996109,0.04625512287020683,0.04624340683221817,0.04623277485370636,0.04624539241194725,0.046241167932748795,0.04626969248056412,0.04626178368926048,0.046261049807071686,0.046255405992269516,0.04626401513814926,0.04626743867993355,0.046266019344329834,0.046275340020656586,0.04627117142081261,0.04626884311437607,0.04627000167965889],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7a38f677-062b-45d2-ae8c-cee6a417287d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-6" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-6">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="45">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 33ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-2" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-2">Model 2 - GRU</h3>
<section id="model-architecture-7" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-7">Model Architecture</h4>
<div class="cell" data-execution_count="46">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_2 (GRU)                 (None, 3)                 54        
                                                                 
 dense_7 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-4" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-4">Plot training and validation loss</h4>
<div class="cell" data-execution_count="48">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.036575884
0.006833242
Train MSE = 0.03658 RMSE = 0.19125
Test MSE = 0.00683 RMSE = 0.08266</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="d89a1772-13d0-405f-be8c-c1bac5a47b86" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d89a1772-13d0-405f-be8c-c1bac5a47b86")) {                    Plotly.newPlot(                        "d89a1772-13d0-405f-be8c-c1bac5a47b86",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.08411546051502228,0.07820490002632141,0.07455529272556305,0.07180797308683395,0.06964706629514694,0.06797392666339874,0.06654201447963715,0.06546783447265625,0.06476976722478867,0.06385940313339233,0.06317223608493805,0.06284137070178986,0.061896003782749176,0.0617305152118206,0.06085250899195671,0.0604698546230793,0.06008085608482361,0.05941929668188095,0.058995116502046585,0.05841187387704849,0.057977546006441116,0.057462770491838455,0.05695158243179321,0.05658957362174988,0.05597514659166336,0.055826835334300995,0.05539694428443909,0.05487245321273804,0.05440555885434151,0.05378890037536621,0.05358830839395523,0.05330270528793335,0.052918631583452225,0.05244036763906479,0.051869284361600876,0.05169988423585892,0.051175422966480255,0.05104324221611023,0.05048295855522156,0.050323765724897385,0.049984075129032135,0.04932703450322151,0.049070555716753006,0.048841774463653564,0.048663947731256485,0.04840826988220215,0.0480828732252121,0.04752233624458313,0.04751173034310341,0.04704804718494415,0.04669521376490593,0.04671858623623848,0.046113431453704834,0.04657314717769623,0.04564936086535454,0.04540587216615677,0.04518283158540726,0.04518761485815048,0.04480375349521637,0.04464670643210411,0.04418794438242912,0.04419702664017677,0.04373316839337349,0.04381313920021057,0.04368845373392105,0.043465755879879,0.04318731278181076,0.042995717376470566,0.04263968765735626,0.04279673844575882,0.04221119359135628,0.04273975268006325,0.04216185212135315,0.04188774153590202,0.04223188757896423,0.04157501459121704,0.04152286797761917,0.04147820919752121,0.04107886925339699,0.04099661856889725,0.04100153595209122,0.040603362023830414,0.0404452420771122,0.040344059467315674,0.04056071490049362,0.04016982764005661,0.040020912885665894,0.03988400846719742,0.03996489569544792,0.03983164206147194,0.03961407393217087,0.03956463560461998,0.03950519114732742,0.039415501058101654,0.03947274759411812,0.03916764631867409,0.03899220749735832,0.03892028331756592,0.039411965757608414,0.03886041417717934,0.03861444443464279,0.03852551430463791,0.03862002119421959,0.03861602395772934,0.03846217691898346,0.03824707865715027,0.038257475942373276,0.03844387084245682,0.038033582270145416,0.03827623277902603,0.038211531937122345,0.03788842633366585,0.03784918040037155,0.037755679339170456,0.03772798553109169,0.038114022463560104,0.03778679296374321,0.037717029452323914,0.03745514526963234,0.037717945873737335,0.03760463371872902,0.037442464381456375,0.037287794053554535,0.03726834058761597,0.038017578423023224,0.03737359121441841,0.03711353614926338,0.03715075924992561,0.0373159758746624,0.03724140673875809,0.037150461226701736,0.03704721853137016,0.03717619553208351,0.03697773069143295,0.03707500547170639,0.03679395467042923,0.036993347108364105,0.03702215105295181,0.03671882301568985,0.03694148361682892,0.03666297346353531,0.03685387223958969,0.03680364042520523,0.03652505576610565,0.036726213991642,0.03655044361948967,0.03671431541442871,0.036813873797655106,0.036386873573064804,0.036723025143146515,0.03642330691218376,0.03637535497546196,0.03666192293167114,0.03659645840525627,0.03627847135066986,0.03625183179974556,0.036348335444927216,0.03620860353112221,0.036337487399578094,0.03622521832585335,0.03624064475297928,0.036134470254182816,0.03613574057817459,0.0362527072429657,0.03649601340293884,0.03609582409262657,0.03628203645348549,0.03604511171579361,0.03613340109586716,0.03598608821630478,0.03626140207052231,0.03603898361325264,0.035938069224357605,0.036182526499032974,0.03612222522497177,0.035949576646089554,0.035870082676410675,0.03585805743932724,0.0362214520573616,0.03610299155116081,0.0366128608584404,0.03596832975745201,0.03600171580910683,0.03574144095182419,0.03580460324883461,0.03572457283735275,0.035655561834573746,0.03588806092739105,0.03571097552776337,0.03588884696364403,0.03585179150104523,0.03564075753092766,0.03594629839062691,0.03561818599700928,0.03591673821210861,0.035599641501903534,0.035877928137779236,0.03556259721517563,0.035506442189216614,0.03578195720911026],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.09270352870225906,0.08745427429676056,0.08374647796154022,0.0804489329457283,0.07798594236373901,0.0759921669960022,0.07440156489610672,0.07297075539827347,0.07192857563495636,0.07102243602275848,0.0702512338757515,0.06945867091417313,0.06879108399152756,0.06816970556974411,0.06752917170524597,0.06683509051799774,0.06635724753141403,0.0658116489648819,0.06533321738243103,0.06481843441724777,0.06445645540952682,0.06393328309059143,0.06338492035865784,0.06295878440141678,0.06258445233106613,0.06225934252142906,0.06175645440816879,0.061282601207494736,0.06072539463639259,0.06028909608721733,0.059889379888772964,0.05947629362344742,0.05909079313278198,0.05866413190960884,0.05830478295683861,0.057954154908657074,0.05752095952630043,0.057240720838308334,0.05695647373795509,0.05658399686217308,0.05633902549743652,0.05592131242156029,0.055670320987701416,0.055206891149282455,0.055048611015081406,0.05472501739859581,0.054419636726379395,0.05401543155312538,0.053731631487607956,0.053572878241539,0.05322292074561119,0.052964504808187485,0.05257711559534073,0.05250703915953636,0.052178725600242615,0.05181960016489029,0.05156801640987396,0.051363036036491394,0.051159586757421494,0.05088839679956436,0.05062747374176979,0.05050494894385338,0.05033139884471893,0.050193607807159424,0.05009201914072037,0.049785271286964417,0.0494643896818161,0.049310434609651566,0.04912691190838814,0.04897480830550194,0.04877221956849098,0.04873780906200409,0.04852965101599693,0.048368509858846664,0.048304483294487,0.0480862520635128,0.04788443073630333,0.04761027917265892,0.04746988043189049,0.04719652235507965,0.04707099497318268,0.04689314588904381,0.0468369759619236,0.04671453312039375,0.04656311124563217,0.04639321193099022,0.04613536223769188,0.045956991612911224,0.04586995020508766,0.045944925397634506,0.045850276947021484,0.04584367200732231,0.04575775936245918,0.0456438809633255,0.045607827603816986,0.045329492539167404,0.04511531814932823,0.04500246047973633,0.04510626196861267,0.04503506049513817,0.04499193653464317,0.04490344226360321,0.04483288899064064,0.0447506457567215,0.04471695050597191,0.04454583302140236,0.044638440012931824,0.044584572315216064,0.044296327978372574,0.04435678943991661,0.04450606554746628,0.044378723949193954,0.04441818967461586,0.04435314983129501,0.04416893422603607,0.04412394389510155,0.04398650303483009,0.04387584701180458,0.04366519674658775,0.04365851357579231,0.043490901589393616,0.043343767523765564,0.04326983541250229,0.04320578649640083,0.04357407987117767,0.043504562228918076,0.043537382036447525,0.04355761408805847,0.043523941189050674,0.04341050609946251,0.04347262158989906,0.04344367980957031,0.04317888244986534,0.04329520836472511,0.043242525309324265,0.04314492642879486,0.04319696128368378,0.043248191475868225,0.04300795868039131,0.04320191591978073,0.04298001527786255,0.04285621643066406,0.04266650974750519,0.042843155562877655,0.042782414704561234,0.04279708489775658,0.04283915460109711,0.042745932936668396,0.0428025983273983,0.042817723006010056,0.0426761694252491,0.04257207363843918,0.04264206066727638,0.04269159957766533,0.04275210201740265,0.042747218161821365,0.042831242084503174,0.04259396344423294,0.042681749910116196,0.04251929372549057,0.04244481027126312,0.04220196604728699,0.0420173741877079,0.042266782373189926,0.04232300445437431,0.042493198066949844,0.042213231325149536,0.04208911582827568,0.04192453250288963,0.04186230152845383,0.04200943931937218,0.04208287596702576,0.04205324873328209,0.0420653410255909,0.042124394327402115,0.04211399331688881,0.042223308235406876,0.042036671191453934,0.04204563423991203,0.042027514427900314,0.04227638989686966,0.042265456169843674,0.04215225949883461,0.042200636118650436,0.042141545563936234,0.041896458715200424,0.04204827919602394,0.041789229959249496,0.04193250089883804,0.0419643372297287,0.041961319744586945,0.04190396890044212,0.04194144904613495,0.04182443767786026,0.04182131588459015,0.041930701583623886,0.041823286563158035,0.04198106750845909,0.041782915592193604,0.04184937849640846],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d89a1772-13d0-405f-be8c-c1bac5a47b86');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-7" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-7">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="49">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-50-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-2" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-2">Model 3 - LSTM</h3>
<section id="model-architecture-8" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-8">Model Architecture</h4>
<div class="cell" data-execution_count="50">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_2 (LSTM)               (None, 3)                 60        
                                                                 
 dense_8 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-5" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-5">Plot training and validation loss</h4>
<div class="cell" data-execution_count="52">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 19ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03401606
0.044011094
Train MSE = 0.03402 RMSE = 0.18443
Test MSE = 0.04401 RMSE = 0.20979</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="74e9a9e6-ea46-4d13-8876-c7be91b392c7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("74e9a9e6-ea46-4d13-8876-c7be91b392c7")) {                    Plotly.newPlot(                        "74e9a9e6-ea46-4d13-8876-c7be91b392c7",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.16862621903419495,0.15137459337711334,0.14007602632045746,0.13090141117572784,0.12305494397878647,0.11607315391302109,0.10973427444696426,0.10384116321802139,0.09846190363168716,0.09361694008111954,0.08899106085300446,0.08468755334615707,0.08080410212278366,0.07722683250904083,0.07386551052331924,0.07088430970907211,0.06812729686498642,0.0657661110162735,0.06361106783151627,0.06146447733044624,0.05968187004327774,0.05807897448539734,0.05665891617536545,0.05550272390246391,0.054408878087997437,0.05366511270403862,0.0528780035674572,0.05239339545369148,0.05164770036935806,0.051159270107746124,0.05073007196187973,0.05069563910365105,0.04993060976266861,0.049664974212646484,0.049237269908189774,0.04897636920213699,0.04875527694821358,0.048409610986709595,0.047899819910526276,0.04801688715815544,0.04746904969215393,0.047180891036987305,0.04666396602988243,0.046575628221035004,0.04621557891368866,0.045992109924554825,0.0457134023308754,0.04548152908682823,0.04559922218322754,0.045019831508398056,0.044568948447704315,0.04454364627599716,0.044093500822782516,0.04419610649347305,0.043649572879076004,0.04341689869761467,0.04339819401502609,0.04299033433198929,0.04297257214784622,0.0430404357612133,0.042385540902614594,0.04225575923919678,0.04205254465341568,0.04182322323322296,0.0418521910905838,0.04163219407200813,0.04145704209804535,0.04107747599482536,0.041135888546705246,0.04093190282583237,0.04077041894197464,0.040485985577106476,0.04050116613507271,0.04043145105242729,0.03994422405958176,0.040012042969465256,0.039752837270498276,0.03975522518157959,0.03977920487523079,0.03936474770307541,0.03956511989235878,0.03930426016449928,0.03923311084508896,0.038957469165325165,0.03901544213294983,0.03890982270240784,0.03861274942755699,0.03876856714487076,0.03858131915330887,0.03843976929783821,0.038178421556949615,0.038194961845874786,0.0382423996925354,0.03827055171132088,0.03792085498571396,0.03798387199640274,0.03791724517941475,0.03815702721476555,0.037599001079797745,0.03744161128997803,0.03759074583649635,0.037534862756729126,0.03742120414972305,0.03746571019291878,0.03712131455540657,0.03708723187446594,0.037229519337415695,0.0372295156121254,0.037103574723005295,0.037373077124357224,0.03678087145090103,0.03734716773033142,0.03684372454881668,0.03658406063914299,0.036576829850673676,0.0367572084069252,0.03642468899488449,0.03652225807309151,0.03721360117197037,0.03628930822014809,0.036431849002838135,0.03617212176322937,0.036244455724954605,0.03606639429926872,0.036026936024427414,0.036694835871458054,0.03600175306200981,0.03587934002280235,0.03590831905603409,0.03599607199430466,0.03603362292051315,0.036040760576725006,0.03585284575819969,0.035972245037555695,0.03579496592283249,0.03563736006617546,0.03568226844072342,0.03564661741256714,0.03563550114631653,0.03553604334592819,0.03536364808678627,0.035635463893413544,0.03540536016225815,0.03517986834049225,0.03540169447660446,0.035187505185604095,0.03526151925325394,0.03501197323203087,0.03523452952504158,0.03495713323354721,0.03500344231724739,0.03561263531446457,0.03485601767897606,0.03480047732591629,0.03525549918413162,0.03497614711523056,0.03467972204089165,0.03481227904558182,0.034789133816957474,0.03474551439285278,0.034653257578611374,0.034700047224760056,0.03481870889663696,0.03482514247298241,0.034664321690797806,0.03467404097318649,0.034677065908908844,0.03473978117108345,0.034765489399433136,0.03451067581772804,0.03455386310815811,0.03439653664827347,0.03460506349802017,0.03442376106977463,0.034809861332178116,0.03436925634741783,0.03419845178723335,0.034206610172986984,0.034522250294685364,0.03450556471943855,0.034104399383068085,0.03419686108827591,0.03446996212005615,0.03428921848535538,0.03410240262746811,0.03426866978406906,0.0340515673160553,0.03443610295653343,0.03389899432659149,0.034254807978868484,0.0342550091445446,0.03398872911930084,0.03378130868077278,0.03409451246261597,0.03377241641283035,0.034183721989393234,0.03390951454639435,0.0337856151163578,0.03383588045835495,0.034130752086639404],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.20028506219387054,0.1848766803741455,0.17276763916015625,0.1623234897851944,0.15326020121574402,0.14497198164463043,0.1371890902519226,0.13006697595119476,0.12335249781608582,0.11733133345842361,0.11143699288368225,0.10596401989459991,0.10116315633058548,0.09633999317884445,0.09199278056621552,0.08804744482040405,0.08417855203151703,0.08100634068250656,0.07791212201118469,0.07499027997255325,0.07235895842313766,0.06990422308444977,0.06767348200082779,0.06562899053096771,0.06398485600948334,0.06262070685625076,0.06151162460446358,0.06047869846224785,0.05949603021144867,0.05866291746497154,0.05789316073060036,0.05752835422754288,0.05697506666183472,0.05651181936264038,0.055921439081430435,0.05547810718417168,0.055236414074897766,0.05487578734755516,0.05446973070502281,0.0543094240128994,0.05403539165854454,0.05363055318593979,0.05326719582080841,0.053078629076480865,0.05285314470529556,0.052666403353214264,0.05239271745085716,0.05209888517856598,0.051973868161439896,0.05162999778985977,0.05130815878510475,0.0510922335088253,0.050780393183231354,0.05067463964223862,0.05033634603023529,0.05018352344632149,0.05012873560190201,0.04970930516719818,0.04955882206559181,0.0494963675737381,0.0492255724966526,0.049066200852394104,0.04885900020599365,0.048692476004362106,0.04868611320853233,0.04853947088122368,0.04841933399438858,0.04808622598648071,0.047685977071523666,0.04745151847600937,0.04753251001238823,0.04735637083649635,0.04710300266742706,0.04692304506897926,0.04676513746380806,0.04666851833462715,0.04675941541790962,0.04665181413292885,0.04651897773146629,0.04634515196084976,0.04627811908721924,0.04620729759335518,0.04613852873444557,0.04594993591308594,0.04583490267395973,0.04572656378149986,0.04552770033478737,0.045456886291503906,0.04563504457473755,0.0454697385430336,0.04520857706665993,0.045001592487096786,0.044951196759939194,0.04495982453227043,0.04484936594963074,0.044950421899557114,0.04474330693483353,0.044946666806936264,0.044682953506708145,0.044633571058511734,0.04467153921723366,0.044697217643260956,0.044649165123701096,0.04461599141359329,0.04429539665579796,0.04433092102408409,0.044364649802446365,0.044179435819387436,0.04420849680900574,0.04439710080623627,0.04419943690299988,0.04426536336541176,0.04425733536481857,0.044006817042827606,0.04378237947821617,0.04366578534245491,0.04358383268117905,0.04346900060772896,0.04392237961292267,0.04379367083311081,0.04400939121842384,0.04368286952376366,0.04356144368648529,0.04377855360507965,0.043975185602903366,0.044179048389196396,0.04411478713154793,0.04411178454756737,0.044025007635354996,0.0440351702272892,0.04393778741359711,0.044235680252313614,0.044002924114465714,0.04417058080434799,0.04392823204398155,0.043849509209394455,0.043818745762109756,0.04330771788954735,0.043016161769628525,0.04341232404112816,0.043677762150764465,0.043487921357154846,0.04353642091155052,0.043185558170080185,0.043840162456035614,0.04302904009819031,0.043569713830947876,0.04304394870996475,0.04245240241289139,0.043195027858018875,0.04337649792432785,0.04325424134731293,0.0433148555457592,0.042719874531030655,0.04240374267101288,0.042806562036275864,0.04247516021132469,0.04294460266828537,0.04268071800470352,0.042213041335344315,0.042696140706539154,0.04352935403585434,0.042918384075164795,0.0431223027408123,0.042459938675165176,0.04264465346932411,0.042643528431653976,0.04265465959906578,0.04271642863750458,0.04280923306941986,0.042384542524814606,0.04241317883133888,0.042035337537527084,0.04293437674641609,0.04335479438304901,0.04314110055565834,0.04308435693383217,0.04254043847322464,0.04193629324436188,0.042107101529836655,0.04235322028398514,0.04291495680809021,0.043195780366659164,0.0429501049220562,0.042283788323402405,0.04240935668349266,0.04226936027407646,0.042115893214941025,0.04211758077144623,0.04195781424641609,0.04177922010421753,0.0427226722240448,0.04230381175875664,0.04260357841849327,0.042214781045913696,0.04249538481235504,0.041780736297369,0.04215799644589424,0.04203326255083084,0.042686525732278824],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('74e9a9e6-ea46-4d13-8876-c7be91b392c7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-8" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-8">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="53">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 20ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-54-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-2" class="level3">
<h3 class="anchored" data-anchor-id="discussion-2">Discussion</h3>
<p>For predicting CO2 emissions from Natural Gas, the training RMSE are: <br> 1) RNN - 0.19666<br> 2) GRU - 0.19114<br> 3) LSTM - 0.18312<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.05314<br> 2) GRU - 0.07994<br> 3) LSTM - 0.21063<br></p>
<p>Thus, the GRU model minimized RMSE for training predictions, while the RNN minimized RMSE for test predictions. Similarly to Hydro modeling, there is a pretty big difference between train and test RMSE for RNN and GRU models here. This <em>could</em> indicate data leakage and should be investigated via further analysis. The LSTM, on the other hand, appears to be overfitted as the test RMSE is higher than the train RMSE. Regularization again improved the model performance slightly, by 0.02 points in the RMSE.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,1)(0,1,2) forecast shared the same seasonality, but exhibited an upwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RNSE from the ARIMA model was 0.04678813, only slightly smaller than the ANN RMSE. The RNN had an RMSE of 0.05314, so with more model tuning could surely outperform the ARIMA model.</p>
</section>
</section>
<section id="petroleum" class="level2">
<h2 class="anchored" data-anchor-id="petroleum">Petroleum</h2>
<section id="split-data-into-training-and-testing-data-3" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-3">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="12914d77-f806-46f5-a51a-5e41e831b88d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("12914d77-f806-46f5-a51a-5e41e831b88d")) {                    Plotly.newPlot(                        "12914d77-f806-46f5-a51a-5e41e831b88d",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.20130087435245514,0.15172530710697174,0.1740044206380844,0.16338278353214264,0.1903034895658493,0.2024533599615097,0.19882117211818695,0.2095658928155899,0.1730675846338272,0.21618817746639252,0.17673657834529877,0.18464945256710052,0.8202983736991882,0.18318791687488556,0.1547688990831375,0.19502879679203033,0.1569654792547226,0.14051033556461334,0.15994741022586823,0.15715287625789642,0.1625894159078598,0.18188802897930145,0.1417074054479599,0.16074906289577484,0.17961134016513824,0.7977923154830933,0.17789040505886078,0.15388493239879608,0.15172530710697174,0.1628948599100113,0.14506886899471283,0.15407459437847137,0.20213954150676727,0.1833006590604782,0.17406286299228668,0.20541523396968842,0.1740044206380844,0.1845373660326004,0.8058810830116272,0.19706551730632782,0.15677793323993683,0.1833006590604782,0.16713295876979828,0.17586778104305267,0.1602560430765152,0.1376277059316635,0.21904440224170685,0.17817802727222443,0.159638449549675,0.13065634667873383,0.16647161543369293,0.8031589388847351,0.1948673576116562,0.15147005021572113,0.1991390436887741,0.16056428849697113,0.18046750128269196,0.16099520027637482,0.26313459873199463,0.20082791149616241,0.21524550020694733,0.20354856550693512,0.20109079778194427,0.1764473170042038,0.8267553448677063,0.20024864375591278,0.15229876339435577,0.19008411467075348,0.10949908196926117,0.20224417746067047,0.17171479761600494,0.17189167439937592,0.20701174437999725,0.18245400488376617,0.19096054136753082,0.20716573297977448,0.1884879618883133,0.8152609467506409,0.1647198349237442,0.14322884380817413,0.1736534982919693,0.12611214816570282,0.1416410654783249,0.21138910949230194,0.16677244007587433,0.25141996145248413,0.15988565981388092,0.187381312251091,0.14676563441753387,0.17394594848155975,0.8055338263511658,0.17667876183986664,0.12709777057170868,0.14057700335979462,0.17748717963695526,0.17236267030239105,0.10068966448307037,0.1822277456521988,0.13471202552318573,0.180752232670784,0.15172530710697174,0.2100229114294052,0.18431295454502106,0.7959848046302795,0.21359993517398834,0.10912235081195831,0.20287112891674042,0.17696775496006012,0.1321762055158615,0.20339243113994598,0.14097653329372406,0.17487956583499908,0.21138910949230194,0.1579010933637619,0.20875133574008942,0.1820579320192337,0.8110336661338806,0.22432692348957062,0.1891496628522873,0.2226908951997757,0.178580179810524,0.18649251759052277,0.14428190886974335,0.20448361337184906,0.20469097793102264,0.144150510430336,0.12083809077739716,0.07736097276210785,0.15608911216259003,0.8072118163108826,0.07478533685207367,0.13231392204761505,0.09501494467258453,0.10239867866039276,0.13836820423603058,0.12849922478199005,0.23253889381885529,0.1937340348958969,0.17371200025081635,0.17667876183986664,0.19583474099636078,0.15646503865718842,0.7867285013198853,0.20474277436733246,0.15827436745166779,0.2072683423757553,0.16556702554225922,0.20783187448978424,0.11427284777164459,0.1569029539823532,0.19216062128543854,0.1637481302022934,0.21529521048069,0.14316289126873016,0.14487238228321075,0.8074353337287903,0.1466355174779892,0.14578811824321747,0.19150672852993011,0.15489493310451508,0.22418300807476044,0.17598383128643036,0.2185051590204239,0.24313636124134064,0.14624474942684174,0.21063102781772614,0.21519581973552704,0.19340930879116058,0.8237342238426208,0.21264760196208954,0.20757584273815155,0.22336585819721222,0.11271630227565765,0.2020348459482193,0.24890641868114471,0.13518895208835602,0.2009330540895462,0.23791547119617462,0.15318824350833893,0.16653181612491608,0.19956232607364655,0.8274838328361511,0.27633607387542725,0.17452986538410187,0.20161570608615875,0.2000904232263565,0.18346963822841644,0.21359993517398834,0.2413032501935959,0.25852155685424805,0.18188802897930145,0.2405392974615097,0.23341979086399078,0.236410453915596,0.8548150658607483,0.24715839326381683,0.22259433567523956,0.2562045454978943,0.22860755026340485,0.25505930185317993,0.15583817660808563,0.19674505293369293,0.2689971327781677,0.22547547519207,0.2129487246274948,0.24438069760799408,0.26665204763412476,0.8663154244422913,0.29232513904571533,0.19079641997814178,0.19743894040584564,0.19112451374530792,0.2663675546646118,0.21717672049999237,0.2322600930929184,0.2773118019104004,0.2183578759431839,0.2126978188753128,0.23355858027935028,0.19556637108325958,0.8620746731758118,0.2677463889122009,0.22860755026340485,0.2575131058692932,0.21209461987018585,0.22504539787769318,0.2341592162847519,0.25219500064849854,0.2700013518333435,0.2654305100440979,0.2567541003227234,0.27773988246917725,0.292802095413208,0.8871285319328308,0.21717672049999237,0.1784653514623642,0.24495632946491241,0.2774675488471985,0.22737832367420197,0.22375069558620453,0.2545912265777588,0.24495632946491241,0.259901762008667,0.2900009751319885,0.2521519660949707,0.26827168464660645,0.8792752623558044,0.29232513904571533,0.2388685792684555,0.2964053750038147,0.282631516456604,0.3069189190864563,0.32592374086380005,0.3105001449584961,0.30524885654449463,0.22002191841602325,0.305213987827301,0.26972055435180664,0.25852155685424805,0.9188817143440247,0.2570917010307312,0.25446343421936035,0.2946646809577942,0.2518077492713928,0.2777788043022156,0.3049694895744324,0.2855144143104553,0.29488295316696167,0.2806015610694885,0.24482358992099762,0.27808964252471924,0.26567530632019043,0.9076300263404846,0.29103654623031616,0.24833960831165314,0.241841122508049,0.2781673073768616,0.3069535493850708,0.30740392208099365,0.2696402668952942,0.26202017068862915,0.24842692911624908,0.28619247674942017,0.2528819441795349,0.24908055365085602,0.9039357304573059,0.27766215801239014,0.25981831550598145,0.26758456230163574,0.23517243564128876,0.29773902893066406,0.27664870023727417,0.29978007078170776,0.25365251302719116,0.27598387002944946,0.2602352499961853,0.280139684677124,0.2982059717178345,0.9069998860359192,0.2539088726043701,0.25305336713790894,0.3196021318435669,0.2751995325088501,0.252022922039032,0.2828983664512634,0.2923985719680786,0.27203768491744995,0.27496373653411865,0.3383294343948364,0.27156001329421997,0.31537705659866333,0.9176526665687561,0.24402575194835663,0.25429296493530273,0.2652263641357422,0.27136069536209106,0.27711695432662964,0.32141029834747314,0.2944098711013794,0.2629697918891907,0.25927531719207764,0.30612003803253174,0.29806244373321533,0.3264702558517456,0.9158216118812561,0.2661234140396118,0.2926921248435974,0.28536349534988403,0.3204585313796997,0.318146288394928,0.33731579780578613,0.32797521352767944,0.3709683418273926,0.3303268551826477,0.32320576906204224,0.29691082239151,0.36953508853912354,0.9544722437858582,0.32701563835144043,0.3373773694038391,0.3587895631790161,0.32379066944122314,0.3384826183319092,0.36073392629623413,0.33731579780578613,0.35112255811691284,0.33872759342193604,0.3446568250656128,0.3033568859100342,0.3282623887062073,0.9706849455833435,0.3304217457771301,0.2614818215370178,0.30447977781295776,0.2596096396446228,0.34396815299987793,0.3069189190864563,0.3017694354057312,0.3349038362503052,0.29502832889556885,0.2707219123840332,0.2595260739326477,0.28373539447784424,0.9304376244544983,0.2671389579772949,0.20915894210338593,0.33234333992004395,0.30240559577941895,0.3204585313796997,0.33857452869415283,0.3493380546569824,0.3092661499977112,0.32150858640670776,0.31382930278778076,0.33471739292144775,0.3577123284339905,0.9485271573066711,0.3524309992790222,0.3159467577934265,0.34086108207702637,0.3546257019042969,0.3313056230545044,0.337346613407135,0.3718298077583313,0.33462411165237427,0.340678870677948,0.31426769495010376,0.32931262254714966,0.30500441789627075,0.9690858721733093,0.29151594638824463,0.27781766653060913,0.3244389295578003,0.34183043241500854,0.305283784866333,0.3467710614204407,0.358619749546051,0.3201294541358948,0.3357413411140442,0.35428041219711304,0.34360814094543457,0.36634230613708496,0.9646288752555847,0.36327576637268066,0.2778565287590027,0.3470674157142639,0.3300420045852661,0.422146201133728,0.3709414005279541,0.3509475588798523,0.38632506132125854,0.3805217146873474,0.3585348129272461,0.3954026699066162,0.3950348496437073,1.0000001192092896,0.35568737983703613,0.3320293426513672,0.35986220836639404,0.3759881854057312,0.3983982801437378,0.3634147047996521,0.3921728730201721,0.3641359210014343,0.3452243208885193,0.320096492767334,0.36005932092666626,0.3716685175895691,0.9952238202095032,0.34375816583633423,0.27156001329421997,0.35739970207214355,0.30916309356689453,0.3417094945907593,0.36252427101135254,0.34444743394851685,0.364993155002594,0.3947893977165222,0.3546544909477234,0.368529736995697,0.4060072898864746,0.9865911602973938,0.31335633993148804,0.28377342224121094,0.37545889616012573,0.3045147657394409,0.371345579624176,0.3296300172805786,0.30377858877182007,0.3660125732421875,0.36079007387161255,0.3127809166908264,0.31904059648513794,0.38122206926345825,0.969957172870636,0.347215473651886,0.2895187735557556,0.33209216594696045,0.32854926586151123,0.32301050424575806,0.3126792311668396,0.3647722005844116,0.331463098526001,0.25085872411727905,0.3290584087371826,0.3049345016479492,0.347511351108551,0.9561248421669006,0.3071961998939514,0.28094738721847534,0.3044097423553467,0.33820676803588867,0.34807252883911133,0.35634511709213257,0.27179890871047974,0.29593509435653687,0.32366079092025757,0.2407192438840866,0.2522379755973816,0.2812544107437134,0.9352672696113586,0.20520852506160736,0.2347584217786789,0.3214758038520813,0.2876927852630615,0.2640800476074219,0.3049694895744324,0.296622097492218,0.32624536752700806,0.3175482749938965,0.2606514096260071,0.290297269821167,0.28679364919662476,0.9180871844291687,0.28156107664108276,0.20292331278324127,0.2719581127166748,0.2681505084037781,0.3152428865432739,0.2849102020263672,0.28611719608306885,0.342826247215271,0.264285147190094,0.30279362201690674,0.2821350693702698,0.16647161543369293,0.9089799523353577,0.3087158203125,0.22084985673427582,0.24680735170841217,0.2596096396446228,0.2962607741355896,0.2879170775413513,0.2683926820755005,0.3129503130912781,0.2806784510612488,0.2407192438840866,0.28312695026397705,0.28339332342147827],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9082584977149963,0.30940359830856323,0.19216062128543854,0.22704632580280304,0.19653113186359406,0.3053186535835266,0.30095428228378296,0.290297269821167,0.30830228328704834,0.3004923462867737,0.24698291718959808,0.2940453290939331,0.24121348559856415,0.9039124846458435,0.3375926613807678,0.21554358303546906,0.10942377150058746,0.25210899114608765,0.2928387522697449,0.27302998304367065,0.3223586082458496,0.2772728204727173,0.3134915828704834,0.28843969106674194,0.3053186535835266,0.20997215807437897,0.9057053923606873,0.31574583053588867,0.1330014020204544,0.2979546785354614,0.28996390104293823,0.30240559577941895,0.30940359830856323,0.3130180239677429,0.32062286138534546,0.2170286625623703,0.2634638547897339,0.2367304414510727,0.22523663938045502,0.9067336916923523,0.30095428228378296,0.2709217071533203,0.29018622636795044,0.22728349268436432,0.21972905099391937,0.183018758893013,0.25956785678863525,0.3367612361907959,0.21972905099391937,0.25012290477752686,0.3546832203865051,0.3020170331001282,0.9054310917854309,0.3271757960319519,0.14780418574810028,0.11293925344944,0.2265237718820572,0.27808964252471924,0.21459849178791046,0.3457905650138855,0.23691312968730927,0.2703218460083008,0.1040194183588028,0.3034623861312866,0.3047597408294678,0.8834611773490906,0.2723556160926819,0.11077587306499481,0.2343437522649765,0.2360442727804184,0.24508897960186005,0.27441275119781494,0.25981831550598145,0.3383907079696655,0.3067801594734192,0.3226521611213684,0.20624051988124847,0.2136499434709549,0.8907544016838074,0.23677612841129303,0.0,0.2370956689119339,0.17053259909152985,0.2578917145729065,0.30761152505874634,0.31741517782211304,0.27064192295074463,0.1996680349111557,0.17517061531543732,0.2690775990486145,0.2895558476448059,0.8717313408851624,0.19679848849773407,0.18369482457637787,0.19791828095912933,0.11559952795505524,0.16465918719768524,0.16037936508655548,0.2092607170343399,0.2909996509552002,0.2400437444448471,0.16050268709659576,0.23999865353107452,0.20019589364528656,0.8333074450492859,0.21349982917308807,0.045169904828071594,0.20198248326778412,0.13518895208835602,0.27641427516937256,0.2375970035791397,0.17023621499538422,0.27429449558258057,0.20910803973674774,0.1838635355234146,0.20536358654499054,0.27227622270584106,0.842016875743866,0.20767830312252045,0.10874505341053009,0.2015632539987564,0.1981310099363327,0.1460491567850113,0.1654461771249771,0.29214149713516235,0.23814274370670319,0.21063102781772614,0.13086412847042084,0.22879613935947418,0.1681516319513321],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Petroleum since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('12914d77-f806-46f5-a51a-5e41e831b88d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-3" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-3">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display">

<div>                            <div id="9516a208-269c-4797-a615-c6a435ac7fe4" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9516a208-269c-4797-a615-c6a435ac7fe4")) {                    Plotly.newPlot(                        "9516a208-269c-4797-a615-c6a435ac7fe4",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.15172530710697174,0.1740044206380844,0.16338278353214264,0.1903034895658493,0.2024533599615097,0.19882117211818695,0.2095658928155899,0.1730675846338272,0.21618817746639252],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.17673657834529877],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.18464945256710052,0.8202983736991882,0.18318791687488556,0.1547688990831375,0.19502879679203033,0.1569654792547226,0.14051033556461334,0.15994741022586823,0.15715287625789642],"type":"scatter"},{"x":[19],"y":[0.1625894159078598],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.18188802897930145,0.1417074054479599,0.16074906289577484,0.17961134016513824,0.7977923154830933,0.17789040505886078,0.15388493239879608,0.15172530710697174,0.1628948599100113],"type":"scatter"},{"x":[29],"y":[0.14506886899471283],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.15407459437847137,0.20213954150676727,0.1833006590604782,0.17406286299228668,0.20541523396968842,0.1740044206380844,0.1845373660326004,0.8058810830116272,0.19706551730632782],"type":"scatter"},{"x":[39],"y":[0.15677793323993683],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.1833006590604782,0.16713295876979828,0.17586778104305267,0.1602560430765152,0.1376277059316635,0.21904440224170685,0.17817802727222443,0.159638449549675,0.13065634667873383],"type":"scatter"},{"x":[49],"y":[0.16647161543369293],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8031589388847351,0.1948673576116562,0.15147005021572113,0.1991390436887741,0.16056428849697113,0.18046750128269196,0.16099520027637482,0.26313459873199463,0.20082791149616241],"type":"scatter"},{"x":[59],"y":[0.21524550020694733],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.20354856550693512,0.20109079778194427,0.1764473170042038,0.8267553448677063,0.20024864375591278,0.15229876339435577,0.19008411467075348,0.10949908196926117,0.20224417746067047],"type":"scatter"},{"x":[69],"y":[0.17171479761600494],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.17189167439937592,0.20701174437999725,0.18245400488376617,0.19096054136753082,0.20716573297977448,0.1884879618883133,0.8152609467506409,0.1647198349237442,0.14322884380817413],"type":"scatter"},{"x":[79],"y":[0.1736534982919693],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.12611214816570282,0.1416410654783249,0.21138910949230194,0.16677244007587433,0.25141996145248413,0.15988565981388092,0.187381312251091,0.14676563441753387,0.17394594848155975],"type":"scatter"},{"x":[89],"y":[0.8055338263511658],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.17667876183986664,0.12709777057170868,0.14057700335979462,0.17748717963695526,0.17236267030239105,0.10068966448307037,0.1822277456521988,0.13471202552318573,0.180752232670784],"type":"scatter"},{"x":[99],"y":[0.15172530710697174],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.2100229114294052,0.18431295454502106,0.7959848046302795,0.21359993517398834,0.10912235081195831,0.20287112891674042,0.17696775496006012,0.1321762055158615,0.20339243113994598],"type":"scatter"},{"x":[109],"y":[0.14097653329372406],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.17487956583499908,0.21138910949230194,0.1579010933637619,0.20875133574008942,0.1820579320192337,0.8110336661338806,0.22432692348957062,0.1891496628522873,0.2226908951997757],"type":"scatter"},{"x":[119],"y":[0.178580179810524],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.18649251759052277,0.14428190886974335,0.20448361337184906,0.20469097793102264,0.144150510430336,0.12083809077739716,0.07736097276210785,0.15608911216259003,0.8072118163108826],"type":"scatter"},{"x":[129],"y":[0.07478533685207367],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.13231392204761505,0.09501494467258453,0.10239867866039276,0.13836820423603058,0.12849922478199005,0.23253889381885529,0.1937340348958969,0.17371200025081635,0.17667876183986664],"type":"scatter"},{"x":[139],"y":[0.19583474099636078],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.15646503865718842,0.7867285013198853,0.20474277436733246,0.15827436745166779,0.2072683423757553,0.16556702554225922,0.20783187448978424,0.11427284777164459,0.1569029539823532],"type":"scatter"},{"x":[149],"y":[0.19216062128543854],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.1637481302022934,0.21529521048069,0.14316289126873016,0.14487238228321075,0.8074353337287903,0.1466355174779892,0.14578811824321747,0.19150672852993011,0.15489493310451508],"type":"scatter"},{"x":[159],"y":[0.22418300807476044],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.17598383128643036,0.2185051590204239,0.24313636124134064,0.14624474942684174,0.21063102781772614,0.21519581973552704,0.19340930879116058,0.8237342238426208,0.21264760196208954],"type":"scatter"},{"x":[169],"y":[0.20757584273815155],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.22336585819721222,0.11271630227565765,0.2020348459482193,0.24890641868114471,0.13518895208835602,0.2009330540895462,0.23791547119617462,0.15318824350833893,0.16653181612491608],"type":"scatter"},{"x":[179],"y":[0.19956232607364655],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.8274838328361511,0.27633607387542725,0.17452986538410187,0.20161570608615875,0.2000904232263565,0.18346963822841644,0.21359993517398834,0.2413032501935959,0.25852155685424805],"type":"scatter"},{"x":[189],"y":[0.18188802897930145],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.2405392974615097,0.23341979086399078,0.236410453915596,0.8548150658607483,0.24715839326381683,0.22259433567523956,0.2562045454978943,0.22860755026340485,0.25505930185317993],"type":"scatter"},{"x":[199],"y":[0.15583817660808563],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.19674505293369293,0.2689971327781677,0.22547547519207,0.2129487246274948,0.24438069760799408,0.26665204763412476,0.8663154244422913,0.29232513904571533,0.19079641997814178],"type":"scatter"},{"x":[209],"y":[0.19743894040584564],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.19112451374530792,0.2663675546646118,0.21717672049999237,0.2322600930929184,0.2773118019104004,0.2183578759431839,0.2126978188753128,0.23355858027935028,0.19556637108325958],"type":"scatter"},{"x":[219],"y":[0.8620746731758118],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.2677463889122009,0.22860755026340485,0.2575131058692932,0.21209461987018585,0.22504539787769318,0.2341592162847519,0.25219500064849854,0.2700013518333435,0.2654305100440979],"type":"scatter"},{"x":[229],"y":[0.2567541003227234],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.27773988246917725,0.292802095413208,0.8871285319328308,0.21717672049999237,0.1784653514623642,0.24495632946491241,0.2774675488471985,0.22737832367420197,0.22375069558620453],"type":"scatter"},{"x":[239],"y":[0.2545912265777588],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.24495632946491241,0.259901762008667,0.2900009751319885,0.2521519660949707,0.26827168464660645,0.8792752623558044,0.29232513904571533,0.2388685792684555,0.2964053750038147],"type":"scatter"},{"x":[249],"y":[0.282631516456604],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.3069189190864563,0.32592374086380005,0.3105001449584961,0.30524885654449463,0.22002191841602325,0.305213987827301,0.26972055435180664,0.25852155685424805,0.9188817143440247],"type":"scatter"},{"x":[259],"y":[0.2570917010307312],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.25446343421936035,0.2946646809577942,0.2518077492713928,0.2777788043022156,0.3049694895744324,0.2855144143104553,0.29488295316696167,0.2806015610694885,0.24482358992099762],"type":"scatter"},{"x":[269],"y":[0.27808964252471924],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.26567530632019043,0.9076300263404846,0.29103654623031616,0.24833960831165314,0.241841122508049,0.2781673073768616,0.3069535493850708,0.30740392208099365,0.2696402668952942],"type":"scatter"},{"x":[279],"y":[0.26202017068862915],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.24842692911624908,0.28619247674942017,0.2528819441795349,0.24908055365085602,0.9039357304573059,0.27766215801239014,0.25981831550598145,0.26758456230163574,0.23517243564128876],"type":"scatter"},{"x":[289],"y":[0.29773902893066406],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.27664870023727417,0.29978007078170776,0.25365251302719116,0.27598387002944946,0.2602352499961853,0.280139684677124,0.2982059717178345,0.9069998860359192,0.2539088726043701],"type":"scatter"},{"x":[299],"y":[0.25305336713790894],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.3196021318435669,0.2751995325088501,0.252022922039032,0.2828983664512634,0.2923985719680786,0.27203768491744995,0.27496373653411865,0.3383294343948364,0.27156001329421997],"type":"scatter"},{"x":[309],"y":[0.31537705659866333],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9176526665687561,0.24402575194835663,0.25429296493530273,0.2652263641357422,0.27136069536209106,0.27711695432662964,0.32141029834747314,0.2944098711013794,0.2629697918891907],"type":"scatter"},{"x":[319],"y":[0.25927531719207764],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.30612003803253174,0.29806244373321533,0.3264702558517456,0.9158216118812561,0.2661234140396118,0.2926921248435974,0.28536349534988403,0.3204585313796997,0.318146288394928],"type":"scatter"},{"x":[329],"y":[0.33731579780578613],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.32797521352767944,0.3709683418273926,0.3303268551826477,0.32320576906204224,0.29691082239151,0.36953508853912354,0.9544722437858582,0.32701563835144043,0.3373773694038391],"type":"scatter"},{"x":[339],"y":[0.3587895631790161],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.32379066944122314,0.3384826183319092,0.36073392629623413,0.33731579780578613,0.35112255811691284,0.33872759342193604,0.3446568250656128,0.3033568859100342,0.3282623887062073],"type":"scatter"},{"x":[349],"y":[0.9706849455833435],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.3304217457771301,0.2614818215370178,0.30447977781295776,0.2596096396446228,0.34396815299987793,0.3069189190864563,0.3017694354057312,0.3349038362503052,0.29502832889556885],"type":"scatter"},{"x":[359],"y":[0.2707219123840332],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.2595260739326477,0.28373539447784424,0.9304376244544983,0.2671389579772949,0.20915894210338593,0.33234333992004395,0.30240559577941895,0.3204585313796997,0.33857452869415283],"type":"scatter"},{"x":[369],"y":[0.3493380546569824],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.3092661499977112,0.32150858640670776,0.31382930278778076,0.33471739292144775,0.3577123284339905,0.9485271573066711,0.3524309992790222,0.3159467577934265,0.34086108207702637],"type":"scatter"},{"x":[379],"y":[0.3546257019042969],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.3313056230545044,0.337346613407135,0.3718298077583313,0.33462411165237427,0.340678870677948,0.31426769495010376,0.32931262254714966,0.30500441789627075,0.9690858721733093],"type":"scatter"},{"x":[389],"y":[0.29151594638824463],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.27781766653060913,0.3244389295578003,0.34183043241500854,0.305283784866333,0.3467710614204407,0.358619749546051,0.3201294541358948,0.3357413411140442,0.35428041219711304],"type":"scatter"},{"x":[399],"y":[0.34360814094543457],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.36634230613708496,0.9646288752555847,0.36327576637268066,0.2778565287590027,0.3470674157142639,0.3300420045852661,0.422146201133728,0.3709414005279541,0.3509475588798523],"type":"scatter"},{"x":[409],"y":[0.38632506132125854],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.3805217146873474,0.3585348129272461,0.3954026699066162,0.3950348496437073,1.0000001192092896,0.35568737983703613,0.3320293426513672,0.35986220836639404,0.3759881854057312],"type":"scatter"},{"x":[419],"y":[0.3983982801437378],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.3634147047996521,0.3921728730201721,0.3641359210014343,0.3452243208885193,0.320096492767334,0.36005932092666626,0.3716685175895691,0.9952238202095032,0.34375816583633423],"type":"scatter"},{"x":[429],"y":[0.27156001329421997],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.35739970207214355,0.30916309356689453,0.3417094945907593,0.36252427101135254,0.34444743394851685,0.364993155002594,0.3947893977165222,0.3546544909477234,0.368529736995697],"type":"scatter"},{"x":[439],"y":[0.4060072898864746],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9865911602973938,0.31335633993148804,0.28377342224121094,0.37545889616012573,0.3045147657394409,0.371345579624176,0.3296300172805786,0.30377858877182007,0.3660125732421875],"type":"scatter"},{"x":[449],"y":[0.36079007387161255],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.3127809166908264,0.31904059648513794,0.38122206926345825,0.969957172870636,0.347215473651886,0.2895187735557556,0.33209216594696045,0.32854926586151123,0.32301050424575806],"type":"scatter"},{"x":[459],"y":[0.3126792311668396],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.3647722005844116,0.331463098526001,0.25085872411727905,0.3290584087371826,0.3049345016479492,0.347511351108551,0.9561248421669006,0.3071961998939514,0.28094738721847534],"type":"scatter"},{"x":[469],"y":[0.3044097423553467],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.33820676803588867,0.34807252883911133,0.35634511709213257,0.27179890871047974,0.29593509435653687,0.32366079092025757,0.2407192438840866,0.2522379755973816,0.2812544107437134],"type":"scatter"},{"x":[479],"y":[0.9352672696113586],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.20520852506160736,0.2347584217786789,0.3214758038520813,0.2876927852630615,0.2640800476074219,0.3049694895744324,0.296622097492218,0.32624536752700806,0.3175482749938965],"type":"scatter"},{"x":[489],"y":[0.2606514096260071],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.290297269821167,0.28679364919662476,0.9180871844291687,0.28156107664108276,0.20292331278324127,0.2719581127166748,0.2681505084037781,0.3152428865432739,0.2849102020263672],"type":"scatter"},{"x":[499],"y":[0.28611719608306885],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.342826247215271,0.264285147190094,0.30279362201690674,0.2821350693702698,0.16647161543369293,0.9089799523353577,0.3087158203125,0.22084985673427582,0.24680735170841217],"type":"scatter"},{"x":[509],"y":[0.2596096396446228],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Petroleum since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9516a208-269c-4797-a615-c6a435ac7fe4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-3" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-3">Model 1 = RNN</h3>
<section id="model-architecture-9" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-9">Model architecture</h4>
<div class="cell" data-execution_count="58">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_3 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_9 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-3" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-3">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="60">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.035382252
0.008783025
Train MSE = 0.03538 RMSE = 0.18810
Test MSE = 0.00878 RMSE = 0.09372</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="6200e0fb-bdbf-41ea-9eda-6665ffc6e817" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6200e0fb-bdbf-41ea-9eda-6665ffc6e817")) {                    Plotly.newPlot(                        "6200e0fb-bdbf-41ea-9eda-6665ffc6e817",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.15915222465991974,0.15083500742912292,0.14499765634536743,0.13972246646881104,0.13500066101551056,0.1304665505886078,0.12624028325080872,0.12215632200241089,0.11842672526836395,0.11522400379180908,0.11226558685302734,0.10930877923965454,0.10645933449268341,0.10359152406454086,0.10090737044811249,0.09828118234872818,0.09571453928947449,0.09312675893306732,0.09066532552242279,0.08816878497600555,0.08580989390611649,0.08353495597839355,0.08134227246046066,0.07915687561035156,0.07708732783794403,0.07500585913658142,0.07307405769824982,0.07111740112304688,0.06921955198049545,0.06745275855064392,0.06571801751852036,0.06413070112466812,0.06268025934696198,0.0612797848880291,0.059968192130327225,0.058765389025211334,0.05766589567065239,0.05669817328453064,0.05578385666012764,0.054972581565380096,0.0542643740773201,0.053536735475063324,0.05300639942288399,0.05248187854886055,0.05209290236234665,0.051677606999874115,0.05154234170913696,0.051228880882263184,0.05083507299423218,0.05046560615301132,0.050239890813827515,0.049972083419561386,0.04985543712973595,0.04953072965145111,0.04922997206449509,0.04907338693737984,0.04885946959257126,0.04857794567942619,0.048400890082120895,0.048299793154001236,0.04810602217912674,0.04778404161334038,0.04761010408401489,0.04745836928486824,0.04725150018930435,0.04695609211921692,0.046969689428806305,0.04655441641807556,0.04641485959291458,0.04643760249018669,0.04611007496714592,0.04584122449159622,0.045795172452926636,0.04552942141890526,0.045299965888261795,0.04516764357686043,0.04498535394668579,0.04492763429880142,0.04470405727624893,0.04448432847857475,0.044341154396533966,0.044172268360853195,0.043944232165813446,0.043748002499341965,0.043586887419223785,0.04351823404431343,0.04344569891691208,0.04306996986269951,0.04310523346066475,0.04279865324497223,0.04271426796913147,0.04247841611504555,0.04255884885787964,0.042187534272670746,0.0420900397002697,0.04194662719964981,0.041721247136592865,0.04170863330364227,0.041439224034547806,0.04134976118803024,0.041145000606775284,0.04107547551393509,0.04098259657621384,0.04088792949914932,0.04066096991300583,0.04065289720892906,0.040401432663202286,0.040333010256290436,0.040113747119903564,0.03996340185403824,0.03984960541129112,0.03986026719212532,0.03966235741972923,0.03947511687874794,0.03935049846768379,0.0393206961452961,0.039224229753017426,0.039267927408218384,0.03898337855935097,0.038780577480793,0.03882951661944389,0.03866792470216751,0.038512781262397766,0.03841355815529823,0.03824592009186745,0.03825615718960762,0.038145970553159714,0.03799543157219887,0.03794819861650467,0.03782474994659424,0.037777017802000046,0.037611257284879684,0.0375630185008049,0.03742579370737076,0.03742809221148491,0.03750176355242729,0.037295110523700714,0.037047453224658966,0.03703207150101662,0.03693510964512825,0.03687248006463051,0.036742910742759705,0.03668517619371414,0.03657982870936394,0.036577560007572174,0.036444276571273804,0.03652036190032959,0.036260657012462616,0.03617957979440689,0.036162011325359344,0.03622530773282051,0.03608953207731247,0.036029115319252014,0.03592778369784355,0.03584637865424156,0.035818543285131454,0.035804737359285355,0.03576201945543289,0.0355338454246521,0.03550044074654579,0.035643987357616425,0.035453200340270996,0.03530948981642723,0.0352601632475853,0.03522597253322601,0.035246752202510834,0.03537580370903015,0.03512698411941528,0.03505709022283554,0.03499884903430939,0.03496409207582474,0.034968871623277664,0.03484303504228592,0.03493434935808182,0.034832946956157684,0.03475121781229973,0.03475676849484444,0.03476636856794357,0.03460954129695892,0.034650642424821854,0.03458273783326149,0.03451930359005928,0.03450661897659302,0.03458245098590851,0.03446729853749275,0.03444725647568703,0.034430474042892456,0.03433072566986084,0.03452454134821892,0.034341320395469666,0.03424546867609024,0.03435273841023445,0.03428269177675247,0.03420846536755562,0.03411225229501724,0.034119658172130585,0.03407172113656998,0.03414127975702286,0.03416087105870247,0.034265436232089996],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.22199226915836334,0.21368631720542908,0.20638388395309448,0.19975033402442932,0.1933317333459854,0.1874333918094635,0.18174691498279572,0.17621570825576782,0.17134584486484528,0.16696444153785706,0.1625743955373764,0.1581544280052185,0.15378844738006592,0.14956584572792053,0.14554031193256378,0.1417175531387329,0.1382051706314087,0.1347404569387436,0.13134175539016724,0.1277795135974884,0.12434723228216171,0.12122040241956711,0.11815357953310013,0.11514625698328018,0.11218773573637009,0.10934477299451828,0.10637517273426056,0.10341151058673859,0.10039159655570984,0.09747448563575745,0.09455924481153488,0.09181561321020126,0.08915192633867264,0.08648007363080978,0.08396442234516144,0.08157186955213547,0.07924928516149521,0.07730908691883087,0.07520081847906113,0.07337307184934616,0.07160332053899765,0.06990563124418259,0.06832589954137802,0.06707588583230972,0.06605176627635956,0.0650714859366417,0.06435362994670868,0.0638020932674408,0.06314127892255783,0.06246302276849747,0.06182977184653282,0.061160411685705185,0.06080889329314232,0.060312915593385696,0.059792377054691315,0.059345439076423645,0.05898253619670868,0.05854446068406105,0.05824197456240654,0.0580301433801651,0.05783781781792641,0.057634543627500534,0.05724504962563515,0.056992676109075546,0.05683797970414162,0.05655844509601593,0.05642738193273544,0.05613185465335846,0.055997129529714584,0.05581611767411232,0.05568242445588112,0.05553494393825531,0.055277977138757706,0.055114589631557465,0.05494906008243561,0.05465104430913925,0.05436490848660469,0.05419480800628662,0.05400820076465607,0.05382619798183441,0.053726017475128174,0.05360185727477074,0.053331900388002396,0.053195770829916,0.052961256355047226,0.05285685136914253,0.05270864814519882,0.05258030816912651,0.0523950420320034,0.052263081073760986,0.05208912864327431,0.051854610443115234,0.05185228958725929,0.05163876712322235,0.05150723084807396,0.05130340903997421,0.05106532201170921,0.050974808633327484,0.050855256617069244,0.0506887286901474,0.05051760375499725,0.05035308375954628,0.050233568996191025,0.050167832523584366,0.050049472600221634,0.04989343509078026,0.04977152496576309,0.04963057115674019,0.04939386993646622,0.049204420298337936,0.049039069563150406,0.04903154447674751,0.048937276005744934,0.04889301210641861,0.048774536699056625,0.0486484169960022,0.048525091260671616,0.04850388690829277,0.04840872436761856,0.048240434378385544,0.04812871292233467,0.048010993748903275,0.047913018614053726,0.047787297517061234,0.04766674339771271,0.047437552362680435,0.047213684767484665,0.047174058854579926,0.047118403017520905,0.04702666774392128,0.04689434915781021,0.04678455367684364,0.04680034890770912,0.04675089940428734,0.046671055257320404,0.04672785848379135,0.046652261167764664,0.04653460904955864,0.04636850580573082,0.04622446373105049,0.04606122896075249,0.04594501480460167,0.04581048712134361,0.04577310383319855,0.04552252218127251,0.04534434527158737,0.045353010296821594,0.04520704969763756,0.045177266001701355,0.04518387094140053,0.04519170895218849,0.04515364393591881,0.04498982056975365,0.04492384195327759,0.044767919927835464,0.044753000140190125,0.044709790498018265,0.04473404586315155,0.04456619918346405,0.0444609671831131,0.04447725787758827,0.04446910321712494,0.0443471297621727,0.04416573420166969,0.04412102699279785,0.044148191809654236,0.04414514824748039,0.044082581996917725,0.04397141560912132,0.0438554547727108,0.04378831759095192,0.04367394000291824,0.04362836852669716,0.043481890112161636,0.04348748177289963,0.0433989018201828,0.04338286072015762,0.04331009089946747,0.04326505959033966,0.04332050681114197,0.04334643855690956,0.043324317783117294,0.043218132108449936,0.04323098063468933,0.04321500286459923,0.04324211925268173,0.043188177049160004,0.04317226633429527,0.04314045235514641,0.04310394823551178,0.04308171197772026,0.04315856471657753,0.04299265891313553,0.042940404266119,0.04290599003434181,0.042899247258901596,0.04282565414905548,0.04268169775605202,0.04269496351480484,0.04260106384754181],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6200e0fb-bdbf-41ea-9eda-6665ffc6e817');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-9" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-9">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="61">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-3" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-3">Model 2 - GRU</h3>
<section id="model-architecture-10" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-10">Model Architecture</h4>
<div class="cell" data-execution_count="62">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_10"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_3 (GRU)                 (None, 3)                 54        
                                                                 
 dense_10 (Dense)            (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-6" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-6">Plot training and validation loss</h4>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.035191447
0.017926276
Train MSE = 0.03519 RMSE = 0.18759
Test MSE = 0.01793 RMSE = 0.13389</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="ab7717a4-4bd4-4600-ae49-e034af5de569" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ab7717a4-4bd4-4600-ae49-e034af5de569")) {                    Plotly.newPlot(                        "ab7717a4-4bd4-4600-ae49-e034af5de569",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.13018572330474854,0.11931592226028442,0.11187572777271271,0.10570664703845978,0.10020291805267334,0.09522350132465363,0.09057910740375519,0.0863913744688034,0.08249811828136444,0.07883404195308685,0.07544030249118805,0.07231409847736359,0.06950560212135315,0.06697368621826172,0.06457893550395966,0.06242778152227402,0.06061702221632004,0.059204064309597015,0.05778837203979492,0.056670188903808594,0.05574268847703934,0.05503731966018677,0.05429109185934067,0.05375697463750839,0.053249530494213104,0.05265691131353378,0.05241516977548599,0.05190945789217949,0.05149046331644058,0.05130050331354141,0.05070141702890396,0.05048814415931702,0.05012763291597366,0.04983023926615715,0.049387380480766296,0.04910428822040558,0.04859660938382149,0.04841415211558342,0.048241790384054184,0.04766644164919853,0.04737090319395065,0.0471726693212986,0.046770744025707245,0.04668804258108139,0.04618116095662117,0.04615546762943268,0.045876339077949524,0.0455491878092289,0.04518592357635498,0.04487355425953865,0.044644545763731,0.04433298110961914,0.044142965227365494,0.04417840391397476,0.043605830520391464,0.04360124468803406,0.04308765381574631,0.04299461096525192,0.0429113432765007,0.042449794709682465,0.04226577281951904,0.04221290722489357,0.04208078235387802,0.041674744337797165,0.041628398001194,0.041259925812482834,0.04120320826768875,0.041006702929735184,0.0407782644033432,0.04054470360279083,0.04051705077290535,0.040154196321964264,0.040059030055999756,0.039933353662490845,0.03986939787864685,0.03951388597488403,0.03975024074316025,0.03925443813204765,0.03915531560778618,0.03891284763813019,0.03895057365298271,0.03879127278923988,0.03849456459283829,0.038357462733983994,0.03836963698267937,0.03808661177754402,0.038021914660930634,0.03791135922074318,0.037787064909935,0.03762732818722725,0.03767780959606171,0.03745288401842117,0.03731275349855423,0.03723966330289841,0.03707240894436836,0.03688330575823784,0.03685640171170235,0.03681772202253342,0.036636918783187866,0.036520712077617645,0.036810196936130524,0.03651084750890732,0.036481812596321106,0.036549162119627,0.036156509071588516,0.03625280782580376,0.036046601831912994,0.03591960668563843,0.0358133427798748,0.03601885586977005,0.035820722579956055,0.03566819429397583,0.035666950047016144,0.035624437034130096,0.035733386874198914,0.03542625159025192,0.035381417721509933,0.03543030098080635,0.03520583733916283,0.0354192852973938,0.035257525742053986,0.03506183624267578,0.03507491201162338,0.035341061651706696,0.03490198403596878,0.035245757550001144,0.034847088158130646,0.03479885309934616,0.03478104993700981,0.03475993871688843,0.03518353030085564,0.03467663750052452,0.03478885442018509,0.03489153832197189,0.0347408726811409,0.03460413217544556,0.03454800695180893,0.03472208231687546,0.034557513892650604,0.03468073531985283,0.03446359559893608,0.034843653440475464,0.03462618589401245,0.0348103791475296,0.03442952409386635,0.03432343527674675,0.03451200947165489,0.03437986224889755,0.03460962325334549,0.03437037020921707,0.03425249084830284,0.034343279898166656,0.034185778349637985,0.03429402783513069,0.034244686365127563,0.03422651067376137,0.03426063805818558,0.034388862550258636,0.034198809415102005,0.03428985923528671,0.03426218777894974,0.03423581272363663,0.03424182906746864,0.034113846719264984,0.034214086830616,0.0340379923582077,0.03423083573579788,0.03414324298501015,0.03402728959918022,0.033936478197574615,0.03404083847999573,0.034073542803525925,0.034016095101833344,0.0340144969522953,0.033955469727516174,0.034134022891521454,0.03404071182012558,0.034008629620075226,0.03391224890947342,0.03388448432087898,0.03408398479223251,0.0339878648519516,0.03383323550224304,0.03392186760902405,0.03400060907006264,0.03390578180551529,0.03386036306619644,0.03399667516350746,0.03376690298318863,0.03400015830993652,0.03387537971138954,0.033717140555381775,0.03410138934850693,0.033959388732910156,0.03414129838347435,0.033670783042907715,0.03371812403202057,0.033870257437229156,0.03381814807653427,0.033923350274562836],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.17848879098892212,0.16683846712112427,0.1573238968849182,0.1490333527326584,0.141323983669281,0.13410699367523193,0.12755358219146729,0.12133922427892685,0.11544270813465118,0.10975854843854904,0.10445494204759598,0.0994306355714798,0.09489256888628006,0.09053686261177063,0.08631453663110733,0.08245397359132767,0.07923030853271484,0.07642139494419098,0.07356352359056473,0.07142270356416702,0.06931215524673462,0.0676337406039238,0.0660175234079361,0.06488006561994553,0.06417360156774521,0.06318812072277069,0.062416043132543564,0.06182170286774635,0.06091110408306122,0.0606485977768898,0.060125682502985,0.05983800068497658,0.05942950025200844,0.05901713669300079,0.058782681822776794,0.05821859464049339,0.05769526958465576,0.05713258683681488,0.05684298649430275,0.05666511133313179,0.0561104454100132,0.05560671165585518,0.05533341318368912,0.055131662636995316,0.054810620844364166,0.05474908649921417,0.05464290454983711,0.05424901470541954,0.05388243496417999,0.0536685585975647,0.053439974784851074,0.05320894718170166,0.05310480296611786,0.05284721776843071,0.05239991843700409,0.052165959030389786,0.05183735117316246,0.051638152450323105,0.051737286150455475,0.051489997655153275,0.05131976678967476,0.05132901296019554,0.051003992557525635,0.05055077373981476,0.050334785133600235,0.04997950792312622,0.04982255771756172,0.049678899347782135,0.049612727016210556,0.04945112764835358,0.04918206110596657,0.048868075013160706,0.04853885993361473,0.048408783972263336,0.04827233776450157,0.04815590754151344,0.048242975026369095,0.04814634099602699,0.04810323938727379,0.04773367941379547,0.04748307168483734,0.047313276678323746,0.04717600718140602,0.04714116081595421,0.046997904777526855,0.046863868832588196,0.04699675738811493,0.046760786324739456,0.046428319066762924,0.04636023938655853,0.04634346812963486,0.04608185589313507,0.04580860212445259,0.04594641923904419,0.04573618248105049,0.045635852962732315,0.04544714838266373,0.04562252759933472,0.045377083122730255,0.045513901859521866,0.045553602278232574,0.04548732936382294,0.045491717755794525,0.04537469148635864,0.04531662166118622,0.04510316252708435,0.045047689229249954,0.044759973883628845,0.04476064071059227,0.04458918049931526,0.04468684270977974,0.04455585777759552,0.04425586014986038,0.04415431246161461,0.044300321489572525,0.04412735626101494,0.04392465949058533,0.04404317960143089,0.04406274855136871,0.043907806277275085,0.04391578212380409,0.04405954107642174,0.04383526369929314,0.04379448667168617,0.043682441115379333,0.04381955787539482,0.04381035268306732,0.04385289549827576,0.043772920966148376,0.04371316730976105,0.043806854635477066,0.043829817324876785,0.043572161346673965,0.04355049505829811,0.043498195707798004,0.04342931881546974,0.043428000062704086,0.04334765300154686,0.04337707534432411,0.043466754257678986,0.043186288326978683,0.04341259226202965,0.04331900179386139,0.04348149523139,0.0434192456305027,0.04331080615520477,0.04336751997470856,0.04332653805613518,0.0432995930314064,0.043342091143131256,0.04343467950820923,0.043342046439647675,0.043195512145757675,0.043023426085710526,0.043004803359508514,0.04328747093677521,0.04350055754184723,0.043224696069955826,0.04305887594819069,0.043178360909223557,0.04303533211350441,0.04305952414870262,0.0432807132601738,0.04303375259041786,0.04300270229578018,0.04306981712579727,0.04306488111615181,0.043144021183252335,0.0431387834250927,0.043067291378974915,0.04282224550843239,0.043124016374349594,0.043260302394628525,0.043182168155908585,0.043032530695199966,0.042793795466423035,0.042858924716711044,0.04275086522102356,0.04265914484858513,0.04275353252887726,0.04303616285324097,0.04299583658576012,0.042772553861141205,0.04269460216164589,0.042804937809705734,0.0429140105843544,0.04308241233229637,0.04283243790268898,0.0426584854722023,0.042653780430555344,0.04268450662493706,0.04259544610977173,0.04258773848414421,0.04259299486875534,0.04273872449994087,0.042627789080142975,0.042639970779418945,0.04266602173447609,0.0424586720764637,0.04269269481301308],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ab7717a4-4bd4-4600-ae49-e034af5de569');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-10" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-10">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="65">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-66-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-3" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-3">Model 3 - LSTM</h3>
<section id="model-architecture-11" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-11">Model Architecture</h4>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_11"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_3 (LSTM)               (None, 3)                 60        
                                                                 
 dense_11 (Dense)            (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-7" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-7">Plot training and validation loss</h4>
<div class="cell" data-execution_count="68">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.034488864
0.016665712
Train MSE = 0.03449 RMSE = 0.18571
Test MSE = 0.01667 RMSE = 0.12910</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="b7844f6f-65fa-452c-9de8-01697ccaa3c3" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b7844f6f-65fa-452c-9de8-01697ccaa3c3")) {                    Plotly.newPlot(                        "b7844f6f-65fa-452c-9de8-01697ccaa3c3",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.2793532609939575,0.24116861820220947,0.2156674861907959,0.19500356912612915,0.17723992466926575,0.1614031344652176,0.14721034467220306,0.13442924618721008,0.1228647381067276,0.11276237666606903,0.10357698053121567,0.09525463730096817,0.08794832229614258,0.0817611813545227,0.07656669616699219,0.07223339378833771,0.06857059895992279,0.06587781012058258,0.0637093335390091,0.06241258233785629,0.06083930283784866,0.05986017733812332,0.05911077931523323,0.05836711451411247,0.058181118220090866,0.05721733719110489,0.0569237656891346,0.05662687495350838,0.05574478954076767,0.05546615272760391,0.054767198860645294,0.05433760955929756,0.05383977293968201,0.05362243577837944,0.0528956763446331,0.05262060835957527,0.051843345165252686,0.052152108401060104,0.05095000937581062,0.05063416436314583,0.050423212349414825,0.050238870084285736,0.04943053796887398,0.049064312130212784,0.04886629059910774,0.04830256476998329,0.048243049532175064,0.047923751175403595,0.04720410704612732,0.04689909890294075,0.04687534645199776,0.046401869505643845,0.04600777477025986,0.04567199945449829,0.045541416853666306,0.04508128762245178,0.04488678649067879,0.04485330730676651,0.04421696811914444,0.044308535754680634,0.043709646910429,0.043459076434373856,0.04345465824007988,0.04306050390005112,0.04276716709136963,0.042572032660245895,0.042642105370759964,0.041957877576351166,0.04203111678361893,0.04167971387505531,0.04134020954370499,0.04108071327209473,0.04126512631773949,0.04105469956994057,0.040594249963760376,0.04054287075996399,0.04056428372859955,0.04007288068532944,0.040035180747509,0.03978828340768814,0.03966955095529556,0.039509546011686325,0.0393855907022953,0.039454519748687744,0.038954172283411026,0.03889859467744827,0.038729287683963776,0.03863827511668205,0.03836536779999733,0.03818118944764137,0.038313139230012894,0.038138363510370255,0.03801818564534187,0.03783388063311577,0.03770899027585983,0.03753958269953728,0.0373004712164402,0.03719143941998482,0.03741338104009628,0.037011973559856415,0.037096038460731506,0.03678963705897331,0.03678556904196739,0.03663129359483719,0.03661682456731796,0.03652065247297287,0.03631148859858513,0.036447931081056595,0.03639587014913559,0.03663216903805733,0.03599133342504501,0.03591298684477806,0.03614507243037224,0.03617381304502487,0.03587580844759941,0.035748016089200974,0.03584795445203781,0.035752080380916595,0.03567477688193321,0.03551853448152542,0.03549036383628845,0.035559363663196564,0.03527344390749931,0.035243768244981766,0.03533167764544487,0.035319309681653976,0.035757165402173996,0.03503972664475441,0.035153552889823914,0.03503528609871864,0.034989479929208755,0.03517724946141243,0.034867655485868454,0.035099923610687256,0.03477676212787628,0.03478037565946579,0.03494172543287277,0.03507334738969803,0.034840404987335205,0.0350007638335228,0.03471781685948372,0.03485856577754021,0.03474491462111473,0.034922003746032715,0.03466269373893738,0.03452644124627113,0.034674979746341705,0.03483347222208977,0.03481270372867584,0.03457768261432648,0.034551989287137985,0.034456007182598114,0.03472696244716644,0.034772682934999466,0.03438856080174446,0.03437914699316025,0.03435053303837776,0.03438004106283188,0.03465034440159798,0.03451117128133774,0.03428167849779129,0.034287285059690475,0.03422287851572037,0.03428178280591965,0.034222688525915146,0.03417813405394554,0.03421303629875183,0.03410071134567261,0.03414478152990341,0.03408077731728554,0.03442098945379257,0.033965446054935455,0.03436790779232979,0.034147895872592926,0.03418119624257088,0.03408050909638405,0.03408521041274071,0.034129027277231216,0.03414870798587799,0.03398041054606438,0.034053392708301544,0.03400467336177826,0.033897824585437775,0.03408675268292427,0.03394324332475662,0.03394659236073494,0.03419387713074684,0.03384825959801674,0.034031085669994354,0.03390183299779892,0.034064725041389465,0.033829402178525925,0.03382357209920883,0.03391464054584503,0.03370305150747299,0.03367341309785843,0.0338563546538353,0.03364016115665436,0.03363674879074097,0.03384597226977348],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.40734565258026123,0.36729371547698975,0.3338233232498169,0.305548757314682,0.2795344591140747,0.25625401735305786,0.23444843292236328,0.21427230536937714,0.19571846723556519,0.17914387583732605,0.16328644752502441,0.14856772124767303,0.1353873610496521,0.12354939430952072,0.11312267929315567,0.10407572239637375,0.09633389115333557,0.08949293196201324,0.08457564562559128,0.08056598156690598,0.07656954228878021,0.07383858412504196,0.07175778597593307,0.06964010000228882,0.06882104277610779,0.06772435456514359,0.06713109463453293,0.0661880299448967,0.06499561667442322,0.06381707638502121,0.06303862482309341,0.06243933364748955,0.06204167380928993,0.061676982790231705,0.06088953837752342,0.060762595385313034,0.06018674373626709,0.06003614887595177,0.059330616146326065,0.058827970176935196,0.05900393798947334,0.05815330892801285,0.057742081582546234,0.057272862643003464,0.05679403245449066,0.05633825063705444,0.055803630501031876,0.0552903451025486,0.05532527342438698,0.05471077933907509,0.05465627834200859,0.05402961000800133,0.053803443908691406,0.054002102464437485,0.05404277145862579,0.05368661880493164,0.05312950909137726,0.05272951349616051,0.05247939005494118,0.05196237936615944,0.05183425173163414,0.051587823778390884,0.051482632756233215,0.051127839833498,0.05060410872101784,0.050665561109781265,0.05021962150931358,0.04997894912958145,0.049867186695337296,0.04966949298977852,0.049495819956064224,0.04893916845321655,0.04868962988257408,0.04863082244992256,0.048750244081020355,0.048482056707143784,0.04860765114426613,0.04840768501162529,0.0479433573782444,0.04763539135456085,0.04756670817732811,0.04696804657578468,0.04691208526492119,0.0469476580619812,0.046925138682127,0.04691070690751076,0.04652773216366768,0.04628923162817955,0.04589507356286049,0.04598091542720795,0.04610728845000267,0.04589710012078285,0.045548226684331894,0.045316532254219055,0.04553619772195816,0.045419733971357346,0.044991955161094666,0.04474782198667526,0.04488471522927284,0.04446797072887421,0.04470488801598549,0.044561561197042465,0.04409120976924896,0.04457750543951988,0.04448824003338814,0.04449920728802681,0.04458138719201088,0.04399117827415466,0.044176384806632996,0.044373348355293274,0.04410961642861366,0.04412493854761124,0.04398768022656441,0.04408187046647072,0.04387202858924866,0.04357530176639557,0.04342718422412872,0.043284833431243896,0.04288211092352867,0.04283052310347557,0.04314934462308884,0.04335082322359085,0.043425314128398895,0.0434391014277935,0.043263718485832214,0.042869385331869125,0.04324854165315628,0.04320799186825752,0.04307070001959801,0.04280141741037369,0.04263372719287872,0.04235187917947769,0.042336706072092056,0.04245584458112717,0.042656347155570984,0.042581476271152496,0.042452894151210785,0.0424371212720871,0.04272514209151268,0.04260328784584999,0.04232421889901161,0.04232137277722359,0.04215659201145172,0.0423041395843029,0.04259827733039856,0.042344268411397934,0.04231631010770798,0.04222613200545311,0.04233283922076225,0.042417626827955246,0.04217921197414398,0.04207296669483185,0.04190177470445633,0.04224279895424843,0.042184002697467804,0.042285121977329254,0.042181313037872314,0.04191829264163971,0.04205097258090973,0.042078424245119095,0.04212791100144386,0.041977446526288986,0.04189576953649521,0.04165170341730118,0.04159761220216751,0.04167400673031807,0.04167246073484421,0.04141441732645035,0.0413769856095314,0.04132912680506706,0.041735053062438965,0.0416967049241066,0.04179449379444122,0.04156670719385147,0.041541583836078644,0.041578419506549835,0.04147970303893089,0.041350360959768295,0.041668251156806946,0.0417085625231266,0.0417393334209919,0.041724707931280136,0.0416424423456192,0.041786011308431625,0.0415639765560627,0.0412304550409317,0.04134358838200569,0.04128697142004967,0.041580554097890854,0.041582826524972916,0.04156419262290001,0.041578520089387894,0.04158170893788338,0.04137231409549713,0.04150234907865524,0.041514940559864044,0.041182275861501694,0.04143039882183075,0.04118156433105469,0.04112372174859047],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b7844f6f-65fa-452c-9de8-01697ccaa3c3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-11" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-11">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="69">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-70-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-3" class="level3">
<h3 class="anchored" data-anchor-id="discussion-3">Discussion</h3>
<p>For predicting CO2 emissions from petroleum, the training RMSE are: <br> 1) RNN - 0.18713<br> 2) GRU - 0.18709<br> 3) LSTM - 0.18830<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.09508<br> 2) GRU - 0.14254<br> 3) LSTM - 0.13025<br></p>
<p>Thus, the GRU model minimized RMSE for training predictions, while the RNN model minimized RMSE for test predictions. However, the RNN model may suffer from data leakage so the GRU model is likely the best model for predicting natural gas CO2 emissions going forward. Regularization improved the model performance.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The SARIMA(0,1,1)(1,1,1) forecast shared the same seasonality, but exhibited a slight downwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RMSE from the ARIMA model was 0.04678813, only slightly smaller than the ANN RMSE. The RNN had an RMSE of 0.09508, so with more model tuning could likely outperform the ARIMA model.</p>
</section>
</section>
</section>
<section id="comparison-of-deep-learning-to-traditional-ts-models" class="level1">
<h1>Comparison of Deep Learning to Traditional TS Models</h1>
<p>In this analysis, I used 3 types of Artificial Neural Networks (ANN) to predict CO2 emissions across 4 different fuel sources: coal, hydrogen gas, natural gas, and petroleum. The goal here was to better understand which fuel sources contribute the most to climate change as well as understand trends for how their usage/consumption is changing over time. I performed a similar analysis in the ARMA/ARIMA/SARIMA Models section. Above, I compared the RMSE results and forecast results of each ANN to the ARMA/ARIMA/SARIMA results but to recap: the traditional time series models underwent significant hyperparameter tuning and model tuning in order to achieve optimal results and minimize RMSE. The ANNs implemented above were simple neural networks with minimal layers, to explore how neural networks can be used in time series analysis. Model tuning was performed, but the NNs could be further robustly tuned to experiment wtih different numbers of recurrent_hidden_units, epochs, activation functions, layers, learning rates, etc. At baseline, the neural networks were able to achieve training RMSEs of around 0.18 across all models and test RMSEs between 0.03 and 0.09. This rivals traditional models after extensive optimization, indicating that the neural networks are far superior models for time series analysis. Recurrent Neural Networks, Gated Recurrent Unit networks, and Long-Short Term Memory networks are all specifically designed to handle sequential data (such as time series) and can handle complex relationships in data better than traditional methods. They are probably better suited for handling multivariate data that a VAR model would use, while traditional time series models do perform well on univariate data like we have here. Additionally, traditional time series models are easy to interpret - whereas neural networks are more convoluted and opaque in their processes and are thus difficult to interpret beyond model fit metrics.</p>
<p>However, both model types performed well in the task of predicting CO2 emissions by source. In forecasting, the ARMA/ARIMA/SARIMA models were able to capture both trend and seasonality for 5 years, while the neural networks performed spectacularly for 4 years and then faltered for year 5 predictions. NN forecasting also didn’t do a great job forecasting overall trend (increases or decreases in CO2 emissions), even though they captured month to month spikes in emissions quite well.</p>
<p>Overall, both types of models can be useful depending on the data, and experimenting with both in order to achieve the optimal forecasting model is a good practice when dealing with any time series data.</p>
<p>Source code for the above analysis: <a href="https://github.com/eliserust/TimeSeries/blob/main/nn.qmd">Github</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>